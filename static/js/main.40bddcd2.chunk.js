(this.webpackJsonpeco=this.webpackJsonpeco||[]).push([[0],{27:function(e,t,n){},28:function(e,t,n){},35:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t);var r=n(8),a=n.n(r),i=n(20),o=n.n(i),s=(n(27),n(28),n(21)),c=n.n(s),l=(n(30),n(2)),u=n(3),h=n(17),d=n(12),f=n(10),p=n(9),g=n(7),m=n(18),v=n(4),y=n(5);function b(e,t){return function(n){return n[e]===t}}function j(e){return"string"===typeof e||e instanceof String}var w=n(1),k=function(){function e(t,n,r){Object(l.a)(this,e),this.idFor=t,this.nameFor=n,this.lookup=r,this._data={}}return Object(u.a)(e,[{key:"set",value:function(e,t){this._data[this.idFor(e)]=t}},{key:"get",value:function(e){return this._data[this.idFor(e)]}},{key:"report",get:function(){var e=this,t=Object.entries(this._data).map((function(t){var n=Object(w.a)(t,2),r=n[0],a=n[1];return[e.nameFor(e.lookup(Number(r))),a]}));return Object.fromEntries(t)}}]),e}(),O=function(){function e(){Object(l.a)(this,e),this.items=[]}return Object(u.a)(e,[{key:"it",get:function(){return this.items}},{key:"first",get:function(){return this.items[0]}},{key:"last",get:function(){return this.items[this.count-1]}},{key:"count",get:function(){return this.items.length}},{key:"add",value:function(e){this.items.push(e)}},{key:"remove",value:function(e){this.items=this.items.filter((function(t){return t!==e}))}},{key:"each",value:function(e){this.items.forEach(e)}},{key:"clear",value:function(){this.items=[]}},{key:"map",value:function(e){return this.items.map(e)}},{key:"sample",get:function(){throw new Error("Method not implemented.")}}]),e}();function x(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function E(e,t){for(var n=[],r=0;r<e;r++)n.push(t());return n}function M(e){return e[x(0,e.length-1)]}function P(e,t){return E(e,(function(){return M(t)}))}var S,C=function(){function e(t,n){Object(l.a)(this,e),this.n=t,this.max=n,this.ngrams={},this.beginnings=[]}return Object(u.a)(e,[{key:"feed",value:function(e){if(e.length<this.n)return!1;var t=e.substring(0,this.n);this.beginnings.push(t);for(var n=0;n<e.length-this.n;n++){var r=e.substring(n,n+this.n),a=e.charAt(n+this.n);this.ngrams.hasOwnProperty(r)||(this.ngrams[r]=[]),this.ngrams[r].push(a)}}},{key:"generate",value:function(){for(var e=M(this.beginnings),t=e,n=0;n<this.max&&this.ngrams.hasOwnProperty(e);n++){e=(t+=M(this.ngrams[e])).substring(t.length-this.n,t.length)}return t.trim()}}]),e}();function I(e,t,n){var r=Array.apply(null,new Array(t));return r=r.map(e),n?[].concat.apply([],r):r}var A,N,F=function(){function e(){Object(l.a)(this,e),this.count=0}return Object(u.a)(e,[{key:"next",get:function(){return this.count++}}]),e}(),D=function(){function e(){Object(l.a)(this,e),this.nameRoots=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],this.nameCount=new F}return Object(u.a)(e,[{key:"next",get:function(){var e=this.nameCount.next;return this.nameRoots[e%this.nameRoots.length]+function(e,t){return I((function(){return e}),t)}(["'"],e).join("")}}]),e}(),B=function(){function e(){Object(l.a)(this,e),this.baseItems=[],this.generatedItems=[]}return Object(u.a)(e,[{key:"next",get:function(){for(var e=this.generate(),t=0;(this.baseItems.includes(e)||this.generatedItems.includes(e))&&t++<100;)e=this.generate();return this.generatedItems.push(e),e}}]),e}(),R=(S=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return Object(l.a)(this,n),(r=t.call(this)).items=e,r.generator=void 0,r.generator=new C(a,i),r.items.forEach(r.feed),r}return Object(u.a)(n,[{key:"feed",value:function(e){this.baseItems.push(e),this.generator.feed(e)}},{key:"generate",value:function(){return this.generator.generate()}}]),n}(B),Object(v.a)(S.prototype,"feed",[y.a],Object.getOwnPropertyDescriptor(S.prototype,"feed"),S.prototype),["name"]),G=function(){function e(t,n){Object(l.a)(this,e),this.stocks=t,this.stockId=n}return Object(u.a)(e,[{key:"add",value:function(e){return this.stocks.add(e,this.name)}},{key:"remove",value:function(e){return this.stocks.remove(e,this.name)}},{key:"list",get:function(){return this.stocks.list()}},{key:"count",get:function(){return this.stocks.count(this.name)}},{key:"name",get:function(){return this.item.name}},{key:"item",get:function(){return this.stocks.lookupById(this.stockId)}}]),e}(),L=(A=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Object(l.a)(this,e),this.name=t,this.elements=n,this.ids=new F,this.storage={}}return Object(u.a)(e,[{key:"list",value:function(){return this.elements}},{key:"_store",get:function(){return this.storage}},{key:"clear",value:function(){this.elements=[],this.storage={}}},{key:"create",value:function(e){var t=null,n={};if(j(e))t=e,n.name=t;else{var r=e;t=r.name,n=Object(m.a)(r,R)}if(j(t)&&this.has(t))return this.manage(t);if(!j(t))throw new Error("Name must be a string");var a=this.ids.next,i=Object(g.a)({id:a,name:t},n);return this.list().push(i),this.manage(t)}},{key:"add",value:function(e,t){this.setAmount(t,this.count(t)+e)}},{key:"remove",value:function(e,t){this.setAmount(t,this.count(t)-e)}},{key:"zero",value:function(e){this.setAmount(e,0)}},{key:"count",value:function(e){var t=this.lookup(e);return this.storage[t.id]||0}},{key:"has",value:function(e){return!!this.elements.find(b("name",e))}},{key:"lookupById",value:function(e){var t=this.elements.find(b("id",e));if(t)return t;throw new Error("No such ".concat(this.name," with id ").concat(e))}},{key:"lookup",value:function(e){var t=this.elements.find(b("name",e));return t||this.create(e).item}},{key:"report",get:function(){var e=this;return this.list().flatMap((function(t){var n=Number(t.id),r=e.storage[n]||0;return Object(g.a)(Object(g.a)({},t),{},{amount:r})}))}},{key:"manage",value:function(e){return new G(this,this.lookup(e).id)}},{key:"manageAll",value:function(){var e=this;return{add:this.add,remove:this.remove,count:this.count,list:function(){return e.elements}}}},{key:"manager",get:function(){return this.manageAll()}},{key:"setAmount",value:function(e,t){var n=this.lookup(e);this.storage[n.id]=t}}]),e}(),Object(v.a)(A.prototype,"list",[y.a],Object.getOwnPropertyDescriptor(A.prototype,"list"),A.prototype),Object(v.a)(A.prototype,"create",[y.a],Object.getOwnPropertyDescriptor(A.prototype,"create"),A.prototype),Object(v.a)(A.prototype,"add",[y.a],Object.getOwnPropertyDescriptor(A.prototype,"add"),A.prototype),Object(v.a)(A.prototype,"remove",[y.a],Object.getOwnPropertyDescriptor(A.prototype,"remove"),A.prototype),Object(v.a)(A.prototype,"zero",[y.a],Object.getOwnPropertyDescriptor(A.prototype,"zero"),A.prototype),Object(v.a)(A.prototype,"count",[y.a],Object.getOwnPropertyDescriptor(A.prototype,"count"),A.prototype),Object(v.a)(A.prototype,"lookupById",[y.a],Object.getOwnPropertyDescriptor(A.prototype,"lookupById"),A.prototype),A),_=(N=function(){function e(t,n){Object(l.a)(this,e),this.name=t,this.popCtor=n,this.populations={},this.species={}}return Object(u.a)(e,[{key:"clear",value:function(){this.populations={}}},{key:"lookup",value:function(e){if(this.has(e))return this.populations[e];throw new Error("No such ".concat(this.name," '").concat(e,"'"))}},{key:"lookupById",value:function(e){var t=Object.values(this.species).find((function(t){return t.id===e}));if(t)return t;throw new Error("No such ".concat(this.name," '").concat(e,"'"))}},{key:"has",value:function(e){return this.populations.hasOwnProperty(e)}},{key:"count",value:function(e){return this.lookup(e).count}},{key:"list",value:function(){return Object.values(this.species)}},{key:"listByName",value:function(e){return this.lookup(e).list()}},{key:"create",value:function(e,t){if(this.has(e))return this.lookup(e);var n=Object(g.a)(Object(g.a)({},t),{},{name:e,id:this.list().length+1}),r=new this.popCtor(e,n);return this.populations[e]=r,this.species[e]=n,r}},{key:"populationList",get:function(){return Object.values(this.populations)}},{key:"report",get:function(){return this.populationList.flatMap((function(e){var t=e;return t.count>0?{name:t.name,amount:t.count}:[]}))}},{key:"add",value:function(e,t){this.lookup(t).add(e)}},{key:"remove",value:function(e,t){this.lookup(t).remove(e)}},{key:"manageAll",value:function(){return{add:this.add,remove:this.remove,count:this.count,list:this.list}}},{key:"manager",get:function(){return this.manageAll()}}]),e}(),Object(v.a)(N.prototype,"lookup",[y.a],Object.getOwnPropertyDescriptor(N.prototype,"lookup"),N.prototype),Object(v.a)(N.prototype,"lookupById",[y.a],Object.getOwnPropertyDescriptor(N.prototype,"lookupById"),N.prototype),Object(v.a)(N.prototype,"count",[y.a],Object.getOwnPropertyDescriptor(N.prototype,"count"),N.prototype),Object(v.a)(N.prototype,"list",[y.a],Object.getOwnPropertyDescriptor(N.prototype,"list"),N.prototype),Object(v.a)(N.prototype,"create",[y.a],Object.getOwnPropertyDescriptor(N.prototype,"create"),N.prototype),Object(v.a)(N.prototype,"add",[y.a],Object.getOwnPropertyDescriptor(N.prototype,"add"),N.prototype),Object(v.a)(N.prototype,"remove",[y.a],Object.getOwnPropertyDescriptor(N.prototype,"remove"),N.prototype),N),H=function(){function e(t,n){Object(l.a)(this,e),this.model=t,this.getStocks=n,this.changes=void 0;var r=this.getStocks(t);this.changes=new L("".concat(r.name," (delta)"),r.list())}return Object(u.a)(e,[{key:"storage",get:function(){return this.changes._store}}]),e}(),T=function(){function e(t){Object(l.a)(this,e),this.name=t,this.ticks=0,this.tracking=[],this.dynamics=new O}return Object(u.a)(e,[{key:"evolve",value:function(e){this.dynamics.add(e)}},{key:"step",value:function(){return this.flux(this.ticks++)}},{key:"report",get:function(){var e=this;return Object.fromEntries(this.tracking.map((function(t){return[t,e[t].report]})))}},{key:"flow",value:function(e){var t=this[e],n=new H(this,(function(t){return t[e]})),r=n.changes.manager,a=r.add,i=r.remove,o=t.list,s=t.count;return{lookupById:t.lookupById,_delta:n,add:a,remove:i,list:o,count:s}}},{key:"flows",value:function(){var e=this,t={};return this.tracking.forEach((function(n){return t[n]=e.flow(n)})),t}},{key:"flowsReport",value:function(e){var t={};return Object.entries(e).forEach((function(e){var n=Object(w.a)(e,2),r=n[0],a=n[1],i=a._delta;t[r]=Object.fromEntries(Object.entries(i.storage).map((function(e){var t=Object(w.a)(e,2),n=t[0],r=t[1];return[a.lookupById(Number(n)).name,r]})))})),t}},{key:"flux",value:function(e){var t=this,n=this.flows();return this.dynamics.each((function(t){return t(n,e)})),Object.entries(n).forEach((function(e){var n=Object(w.a)(e,2),r=n[0],a=n[1]._delta;t.apply(a,r)})),{changed:this.flowsReport(n)}}},{key:"apply",value:function(e,t){var n=this[t].manager,r=n.list(),a=e.storage,i={};return r.forEach((function(e){if(a[e.id]){var t=a[e.id];n.add(t,e.name),i[e.name]=t}})),{changed:i}}}]),e}(),W=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(l.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).ids=new F,e}return Object(u.a)(n,[{key:"list",value:function(){return this.items}},{key:"names",get:function(){return this.items.map((function(e){return e.name}))}},{key:"create",value:function(e){var t=this.ids.next,n=Object(g.a)({id:t},e);return this.items.push(n),n}},{key:"lookup",value:function(e){return this.items.find((function(t){return t.name===e}))}}]),n}(O);function V(e){var t=x(0,100);return t>95?e[3]:t<5?e[0]:M([e[1],e[2]])}var q,z,U=new F,Q=function(e,t){return{id:U.next,name:e,kind:t,age:0,guile:V(["transparent","convincing","beguiling","insidious"]),health:V(["dying","unwell","flourishing","triumphant"]),spirit:V(["languorous","vigorous","impetuous","ferocious"]),cunning:V(["foolish","sly","crafty","manipulative"]),agility:V(["clumsy","nimble","spry","balletic"]),strength:V(["weak","robust","mighty","indomitable"])}},J=new F,K=function(e){var t=V(["impoverished","well-off","luxuriant","decadent"]),n=V(["unpretentious","savvy","urbane","sleek"]),r=V(["inconsequential","marginal","influential","sovereign"]),a=V(["clueless","well-informed","wise","prescient"]),i=V(["lost","primitive","archaic","advanced"]);return{id:J.next,name:e,wealth:t,sophistication:n,power:r,knowledge:a,tech:i}},Z=new F,X={id:-1,name:"Human Being",size:"medium"},Y=function(e,t){var n=new L("".concat(e,"'s Things")),r=new L("".concat(e,"'s Traits"));return{id:Z.next,kind:t,name:e,age:0,body:Q(e,X),mind:{insight:V(["dense","intuitive","incisive","brilliant"]),depth:V(["superficial","substantial","profound","inscrutable"]),education:V(["unlettered","literate","tutored","well-read"]),disposition:V(["dismal","hopeful","propitious","roseate"]),valor:V(["timid","bold","courageous","fearless"]),personality:V(["bland","magnetic","charismatic","captivating"])},soul:{wit:V(["slow","clever","biting","savage"]),empathy:V(["sadistic","generous","benevolent","selfless"]),integrity:V(["uncertain","sound","solid","incorruptible"]),beauty:V(["ugly","fair","radiant","resplendent"]),charm:V(["repulsive","inoffensive","affable","likeable"]),resolve:V(["vacillating","steadfast","intrepid","relentless"])},currency:0,things:n.manageAll(),traits:r.manageAll(),meters:{},memory:new W}},$=["name"],ee=function(){function e(){Object(l.a)(this,e)}return Object(u.a)(e,null,[{key:"first",value:function(e){return e.values().next().value}}]),e}(),te=new F,ne=(q=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;Object(l.a)(this,e),this.name=t,this.species=n,this.individuals=r,this.id=te.next,this.ids=new F}return Object(u.a)(e,[{key:"list",value:function(){var e=[];return this.individuals.forEach((function(t){return e.push(t)})),e}},{key:"count",get:function(){return this.individuals.size}},{key:"first",get:function(){return ee.first(this.individuals)}},{key:"lookup",value:function(e){var t=null;if(this.individuals.forEach((function(n){n.name===e&&(t=n)})),t)return t;throw new Error("Could not find individual with name '".concat(e,"' in the population of ").concat(this.name))}},{key:"lookupById",value:function(e){var t=null;if(this.individuals.forEach((function(n){n.id===e&&(t=n)})),t)return t;throw new Error("Could not find individual with id ".concat(e," in the population of ").concat(this.name))}},{key:"birth",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"".concat(this.name," ").concat(this.count),t=this.create(e);return t}},{key:"death",value:function(e){if(e){var t=this.destroy(e);if(t)return t}else{var n=this.first;if(n)return this.destroy(n.name),n}throw new Error("Population already empty!")}},{key:"add",value:function(e){for(var t=[],n=0;n<e;n++)t.push(this.birth());return t}},{key:"remove",value:function(e){for(var t=[],n=0;n<Math.min(this.count,e);n++)t.push(this.death(this.first.name));return t}},{key:"build",value:function(e){var t=null,n={};if(j(e))t=e,n.name=t;else{var r=e;t=r.name,n=Object(m.a)(r,$)}var a=this.ids.next;return Object(g.a)({id:a,name:t},n)}},{key:"create",value:function(e){var t=this.build(e);return this.individuals.add(t),t}},{key:"destroy",value:function(e){var t=this.lookup(e);return this.individuals.delete(t),t}},{key:"report",get:function(){return Object.fromEntries(this.list().map((function(e){return[e.id,e.name]})))}}]),e}(),Object(v.a)(q.prototype,"lookupById",[y.a],Object.getOwnPropertyDescriptor(q.prototype,"lookupById"),q.prototype),Object(v.a)(q.prototype,"death",[y.a],Object.getOwnPropertyDescriptor(q.prototype,"death"),q.prototype),Object(v.a)(q.prototype,"create",[y.a],Object.getOwnPropertyDescriptor(q.prototype,"create"),q.prototype),Object(v.a)(q.prototype,"destroy",[y.a],Object.getOwnPropertyDescriptor(q.prototype,"destroy"),q.prototype),q),re=(z=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(l.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).moieties=new O,e.obscured=!1,e.recipes=new W,e.jobs=new k((function(e){return e.id}),(function(e){return e.name}),e.lookupById),e.inventories=new k((function(e){return e.id}),(function(e){return e.name}),e.lookupById),e}return Object(u.a)(n,[{key:"report",get:function(){var e=this,t=this.list().map((function(t){return[t.id,(e.jobs.get(t)||{name:"?"}).name]}));return Object.fromEntries(t)}},{key:"create",value:function(e){var t=Object(h.a)(Object(d.a)(n.prototype),"build",this).call(this,e),r=t.name,a=t.age,i=Y(r,K("".concat(r,"'s Gens")));return i.age=a,this.individuals.add(i),i}},{key:"work",value:function(e){var t=this,n=e.resources,r=this.jobs.report;Object.entries(r).forEach((function(e){var r=Object(w.a)(e,2),a=(r[0],r[1]);t.produce(a,n)}))}},{key:"produce",value:function(e,t){this.mayProduce(e,t)&&(e.consumes&&Object.entries(e.consumes).forEach((function(e){var n=Object(w.a)(e,2),r=n[0],a=n[1];t.remove(a,r)})),Object.entries(e.produces).forEach((function(e){var n=Object(w.a)(e,2),r=n[0],a=n[1];t.add(a,r)})))}},{key:"mayProduce",value:function(e,t){var n=!0;return e.consumes&&Object.entries(e.consumes).forEach((function(e){var r=Object(w.a)(e,2),a=r[0],i=r[1];t.count(a)<i&&(n=!1)})),n}}]),n}(ne),Object(v.a)(z.prototype,"create",[y.a],Object.getOwnPropertyDescriptor(z.prototype,"create"),z.prototype),z),ae=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(l.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).tracking=["animals","resources"],e.people=new _("people",re),e.resources=new L("resources"),e.machines=new L("machines"),e.animals=new _("wildlife",ne),e.metrics={},e.notes={},e.actions=new W,e.policies=new W,e.currentPolicy=void 0,e}return Object(u.a)(n,[{key:"tiles",get:function(){return[]}},{key:"reset",value:function(){this.resources.clear(),this.machines.clear(),this.animals.clear(),this.people.clear(),this.dynamics.clear()}},{key:"send",value:function(e,t){var n=this.actions.lookup(e);if(!n)throw new Error("No such action ".concat(e));n.act(t)}},{key:"choose",value:function(e){var t=this.policies.lookup(e);if(!t)throw new Error("No such policy ".concat(e));this.currentPolicy=t}},{key:"step",value:function(){return this.currentPolicy&&this.currentPolicy.manage(),Object(h.a)(Object(d.a)(n.prototype),"step",this).call(this)}}]),n}(T),ie=n(22);var oe=n(0);function se(e){return function(t){var n=t.name,r=t.amount,a=e&&e[n];return Object(oe.jsxs)("li",{title:n,className:"Item",children:[Object(oe.jsx)("span",{className:"Title","data-testid":"Name",children:n}),Object(oe.jsx)("span",{"data-testid":"Count",children:r}),Object(oe.jsx)("span",{"data-testid":"Delta",children:a})]},n)}}function ce(e){var t=e.children,n=e.title;return Object(oe.jsx)("div",{className:"Tile",title:n,children:t})}function le(e){return Object(oe.jsx)(ce,{title:e.name,children:Object(oe.jsx)("ul",{"aria-label":"People",children:e.obscured?e.list().map((function(e){return Object(oe.jsx)("li",{children:e.name},e.id)})):e.list().map((t=e.report,function(e){var n=e.id,r=e.name,a=e.things,i=e.traits,o=e.meters,s=a.list().map((function(e){return e.name}));return Object(oe.jsxs)("li",{title:r,className:"Item",children:[Object(oe.jsx)("div",{className:"Title","data-testid":"Name",children:r}),Object.entries(o).map((function(e){var t=Object(w.a)(e,2),n=t[0],r=(0,t[1])(),a=r.value,i=r.max;return Object(oe.jsxs)("div",{className:"Meter","data-testid":n,children:[Object(oe.jsxs)("label",{htmlFor:n,style:{paddingRight:10},children:[n,":"]}),Object(oe.jsxs)("meter",{id:n,style:{width:130,height:14},min:"0",max:i,low:.33*i,high:.66*i,optimum:.8*i,value:a,children:["at ",a,"/",i]})]})})),t[n]&&"?"!==t[n]&&Object(oe.jsx)("span",{"data-testid":"Status",children:t[n]}),s.length>0&&Object(oe.jsx)("div",{className:"Subitems","data-testid":"Inventory",children:Object(oe.jsx)("ul",{children:s.sort((function(e,t){return e>t?1:-1})).map((function(e){return Object(oe.jsxs)("li",{style:Object(g.a)({},0===a.count(e)?{display:"none"}:{}),children:[e," ",Object(oe.jsx)("span",{"data-testid":e,className:"Count",children:a.count(e)})]},e)}))})}),i.list().length>0&&Object(oe.jsx)("div",{className:"Traits","data-testid":"Trait Ranks",children:Object(oe.jsx)("ul",{children:i.list().map((function(e){return Object(oe.jsxs)("li",{style:Object(g.a)({},0===i.count(e.name)?{display:"none"}:{}),children:[e.name," ",Object(oe.jsx)("span",{"data-testid":e.name,children:i.count(e.name)})]},e.id)}))})})]},n)}))})},e.id);var t}n(35);var ue=function(){return Object(oe.jsx)(oe.Fragment,{})},he=function(e){var t=e.tiles,n=e.tileColors,a=e.tileInspect,i=Object(r.useState)([-1,-1]),o=Object(w.a)(i,2),s=o[0],c=o[1],l=s[0]>0&&s[1]>0?a(s[0],s[1]):Object(oe.jsx)(oe.Fragment,{children:"--"});return Object(oe.jsxs)("div",{style:{flexDirection:"column"},children:[Object(oe.jsx)(ie.a,{}),Object(oe.jsx)(ue,{}),Object(oe.jsx)("table",{style:{fontFamily:'"Source Code Pro", "Fira Code", "Inconsolata", Menlo, Monaco, "Courier New", monospace',cursor:"pointer"},children:Object(oe.jsx)("tbody",{children:t.map((function(e,t){return Object(oe.jsx)("tr",{children:e.map((function(e,r){return Object(oe.jsx)("td",{style:{color:n[e],backgroundColor:s[0]===r&&s[1]===t?"gray":"black"},onMouseEnter:function(){return c([r,t])},onMouseLeave:function(){return c([-1,-1])},"data-tip":s[0]===r&&s[1]===t?l:"",children:e},"cell-".concat(r,"-").concat(t,"}"))}))},"row-".concat(t))}))})})]})};function de(e){var t=e.modelName,n=e.items,r=e.communities,a=e.machines,i=e.animals,o=e.lastChanges,s=e.metrics,c=e.notes,l=e.board,u=r.map(le);return Object(oe.jsxs)("div",{className:"Model",children:[Object(oe.jsx)("h4",{"aria-label":"Model Title",style:{display:"none"},children:t}),l.tiles.length>0&&Object(oe.jsx)(he,Object(g.a)({},l)),n.length>0&&Object(oe.jsx)(ce,{title:"Items",children:Object(oe.jsx)("ul",{"aria-label":"Resources",children:n.map(se(o.resources))})}),i.length>0&&Object(oe.jsx)(ce,{title:"Animals",children:Object(oe.jsx)("ul",{"aria-label":"Animals",children:i.map(se(o.animals))})}),r.length>0&&Object(oe.jsx)("div",{title:"Individuals",style:{display:"flex"},children:u}),a.length>0&&Object(oe.jsx)(ce,{title:"Machines",children:Object(oe.jsx)("ul",{children:a.map((function(e){var t=e.name;return Object(oe.jsx)("li",{children:t},t)}))})}),Object.keys(s).length>0&&Object(oe.jsx)(ce,{title:"Metrics",children:Object(oe.jsx)("ul",{children:Object.entries(s).map((function(e){var t=Object(w.a)(e,2),n=t[0],r=t[1];return Object(oe.jsxs)("li",{title:n,children:[n,Object(oe.jsx)("span",{"data-testid":"Count",children:r})]},n)}))})}),Object(oe.jsx)("table",{children:Object(oe.jsx)("tbody",{children:Object.keys(c).length>0&&Object(oe.jsx)(ce,{title:"Notes",children:Object.entries(c).map((function(e){var t=Object(w.a)(e,2),n=t[0],r=t[1];return Object(oe.jsxs)("tr",{children:[Object(oe.jsx)("td",{title:n,style:{textAlign:"right"},children:Object(oe.jsx)("b",{children:n})},n),Object(oe.jsx)("td",{style:{width:"4px"}}),Object(oe.jsx)("td",{style:{minWidth:"180px",textAlign:"left"},children:Object(oe.jsx)("span",{"data-testid":"Description",children:r})})]})}))})})})]})}var fe=ae,pe=function(e,t){var n=e.actions,r=e.resources,a=e.people,i=e.machines,o=e.animals,s=e.metrics,c=e.notes,l=e.tiles,u=e.tileColors;return{modelName:e.name,items:r.report,communities:a.populationList,machines:i.list(),animals:o.report,actions:n.list(),metrics:Object.fromEntries(Object.entries(s).map((function(e){var t=Object(w.a)(e,2);return[t[0],(0,t[1])()]}))),notes:Object.fromEntries(Object.entries(c).map((function(e){var t=Object(w.a)(e,2);return[t[0],(0,t[1])()]}))),lastChanges:t,board:{tiles:l||[],tileColors:u||{},tileInspect:e.tileInspect||function(){return"--"}}}};function ge(e){var t=e.model,n=e.send,r=e.choose,a=e.step,i=e.lastChanges;return Object(oe.jsxs)(oe.Fragment,{children:[Object(oe.jsx)("div",{"aria-label":"View",children:Object(oe.jsx)(de,Object(g.a)({},pe(t,i)))}),Object(oe.jsxs)("div",{"aria-label":"Controls",children:[Object(oe.jsx)("span",{title:"Run",style:{display:"none"},children:Object(oe.jsx)("button",{onClick:function(){return a(!0)},children:"Step"})}),Object(oe.jsx)("span",{title:"Actions",children:t.actions.list().map((function(e){var t=e.name;return Object(oe.jsx)("button",{title:t,onClick:function(){return n(t)},children:t},t)}))}),t.policies.count>0&&Object(oe.jsx)("div",{className:"Policy",title:"Policies",children:t.policies.list().map((function(e){var n,a=e.name;return Object(oe.jsxs)("label",{children:[Object(oe.jsx)("input",{type:"radio",checked:(null===(n=t.currentPolicy)||void 0===n?void 0:n.name)===a,title:a,onChange:function(){return r(a)}},a),a]},a)}))})]})]})}function me(e){var t=Object(r.useState)(e),n=Object(w.a)(t,2),a=n[0],i=n[1],o=Object(r.useState)({}),s=Object(w.a)(o,2),c=s[0],l=s[1],u=Object(r.useState)(2),h=Object(w.a)(u,2),d=h[0],f=h[1],p=Object(r.useState)(!1),g=Object(w.a)(p,2),m=g[0],v=g[1],y=Object(r.useState)(!1),b=Object(w.a)(y,2),j=b[0],k=b[1],O=Object(r.useState)(!1),x=Object(w.a)(O,2),E=x[0],M=x[1],P=Object(r.useState)(""),S=Object(w.a)(P,2),C=S[0],I=S[1],A=Object(r.useState)(""),N=Object(w.a)(A,2),F=N[0],D=N[1];Object(r.useEffect)((function(){j&&(C&&ve(a)&&a.send(C,{}),k(!1))}),[C,a,j]),Object(r.useEffect)((function(){E&&(F&&ve(a)&&a.choose(F,{}),M(!1))}),[F,a,E]);return Object(r.useEffect)((function(){if(m&&ve(a)){var e=a.step().changed;v(!1),l(e)}}),[m,a]),function(e,t){var n=Object(r.useRef)();Object(r.useEffect)((function(){n.current=e}),[e]),Object(r.useEffect)((function(){function e(){n.current()}if(null!==t){var r=setInterval(e,t);return function(){return clearInterval(r)}}}),[t])}((function(){return v(!0)}),d),{model:a,step:function(){v(!0)},lastChanges:c,send:function(e,t){return function(e,t){I(e),k(!0)}(e)},choose:function(e,t){return function(e,t){D(e),M(!0)}(e)},setDelay:f,setModel:i}}var ve=function(e){return e instanceof fe},ye=function(e){var t=e.assembly;return Object(oe.jsx)(oe.Fragment,{children:t.models.items.map((function(e){var t=me(e),n=t.step,r=t.send,a=t.choose,i=t.lastChanges,o=t.model;return Object(oe.jsxs)(oe.Fragment,{children:[Object(oe.jsx)("h4",{children:e.name}),Object(oe.jsx)(ge,{step:n,send:r,model:o,choose:a,lastChanges:i},o.name)]})}))})};function be(e){var t=e.initialModel,n=e.models,r=me(t),a=r.step,i=r.send,o=r.choose,s=r.lastChanges,l=r.model,u=r.setModel;return Object(oe.jsxs)(oe.Fragment,{children:[Object(oe.jsx)(c.a,{options:n.map((function(e){return e.name})),onChange:function(e){var t=e.value,r=n.find((function(e){return e.name===t}));r&&u(r)},value:l.name,placeholder:"Select a model"}),ve(l)?Object(oe.jsx)(ge,{step:a,send:i,model:l,choose:o,lastChanges:s}):Object(oe.jsx)(ye,{assembly:l})]})}var je=function(e,t,n,r){t.things.remove(n,r),e.things.add(n,r)},we=new fe("Avernus"),ke=we.resources,Oe=we.animals,xe=we.people.create("Townspeople"),Ee=xe.recipes,Me=xe.jobs;Oe.create("Fish");var Pe=xe.create("Goldstrom"),Se=xe.create("Octavius"),Ce=xe.create("Smeltmore"),Ie=xe.create("Harold");ke.create("Gold Ore"),ke.create("Gold Deposit"),ke.create("Gold Bar"),ke.create("Gold Coin"),ke.add(1e8,"Gold Deposit");var Ae=Ee.create({name:"Mining Gold",produces:{"Gold Ore":1},consumes:{"Gold Deposit":10}}),Ne=Ee.create({name:"Smelt Gold",produces:{"Gold Bar":1},consumes:{"Gold Ore":10}}),Fe=Ee.create({name:"Minting Gold Coins",produces:{"Gold Coin":10},consumes:{"Gold Bar":1}});Me.set(Pe,Ae),Me.set(Se,Fe),Me.set(Ce,Ne),we.evolve((function(e,t){var n=e.resources,r=e.animals;(xe.work({resources:n}),t%10===0)&&[Pe,Se,Ce].forEach((function(e){e.things.add(1,"Gold Coin"),n.remove(1,"Gold Coin")}));t%10===0&&(Ie.things.add(1,"Fish"),r.remove(1,"Fish")),[Pe,Se,Ce].forEach((function(e){Ie.things.count("Fish")>3&&e.things.count("Gold Coin")>5&&(je(Ie,e,5,"Gold Coin"),je(e,Ie,1,"Fish"))}))}));var De,Be=function(){function e(){Object(l.a)(this,e),this.basicCreatures={Fragment:{hp:1,evasion:95},Light:{hp:24,evasion:1},Fog:{hp:26,evasion:1,reflect:10},Aura:{hp:28,evasion:1,speed:1},Shadow:{hp:38,evasion:1,speed:2},Wisp:{hp:40,strength:1,speed:1,evasion:1},Filament:{hp:43,evasion:1,speed:1,counter:1},Voice:{hp:53,evasion:1,speed:1,counter:1,absorb:1,defense:1},Nothing:{hp:63,regen:1,speed:1,defense:1,reflect:1}},this.challengingCreatures={Fiendling:{hp:12,"holy damage":1},Gremlin:{hp:22,speed:1,counter:1},Goblin:{hp:30},Kobold:{hp:40,strength:1},Orc:{hp:48,strength:1,speed:1}},this.uncommonCreatures={Rat:{hp:14,strength:1,speed:3,evasion:1},Bat:{hp:18,strength:2,speed:2,evasion:1},Snake:{hp:15,strength:3,speed:2,evasion:2},Blob:{hp:24,strength:2,speed:1,evasion:1},Bear:{hp:30,strength:3,speed:2,evasion:1},Ghost:{hp:70,"magic damage":1,evasion:1,counter:1,speed:1,absorb:1,defense:1},Rogue:{hp:74,strength:2,speed:1,"bonus damage":2,evasion:2,counter:2},Troll:{hp:83,strength:2,speed:2,regen:1,counter:1},Giant:{hp:95,strength:2,speed:2,defense:1,absorb:1}},this.bosses={Priest:{hp:57,heal:4,"holy damage":6,defense:6,"holy defense":3,evasion:2},Vampire:{hp:84,strength:2,speed:3,"magic damage":1,absorb:2,evasion:2},Drake:{hp:100,strength:3,speed:2,regen:2,"magic damage":2,evasion:2},Lich:{hp:140,strength:4,speed:6,defense:6,"magic damage":6,evasion:6}},this.extraplanar={Demon:{hp:166,strength:3,speed:6,counter:6,evasion:6},Angel:{hp:199,evasion:2,absorb:2,regen:2,counter:9,defense:9,"magic defense":2,"holy damage":9},Archdemon:{hp:366,absorb:6,strength:6,speed:6,defense:6,evasion:6,"magic damage":6,"holy damage":16},Dracolith:{hp:247,strength:7,"magic damage":7,speed:7,defense:7,evasion:7,counter:7},Archangel:{hp:299,absorb:9,strength:9,speed:9,defense:9,evasion:9,"magic defense":9,"holy defense":9,"holy damage":99},"Brutal Light":{hp:123,speed:2,strength:6,"bonus damage":5,evasion:4},"Floating Sigil":{hp:234,speed:10,defense:10,counter:10},"Astral Filament":{hp:1234,strength:15,absorb:10,evasion:5,counter:1,regen:1},"Essence Sphere":{hp:12345,"magic damage":12,"holy damage":12,"bonus damage":12}},this.dragons={"Green Dragon":{hp:900,strength:5,speed:8,defense:4,"magic damage":16,evasion:24},"Red Dragon":{hp:1100,strength:7,speed:9,defense:14,"magic damage":26,evasion:34},"Blue Dragon":{hp:2100,strength:9,speed:11,defense:24,"magic damage":36,evasion:44},"Golden Dragon":{hp:2400,strength:11,speed:15,defense:34,"magic damage":66,evasion:55},"Black Dragon":{hp:2900,strength:11,speed:15,defense:34,"magic damage":66,evasion:55},"Primordial Dragon":{hp:3919,strength:30,speed:30,defense:30,"magic damage":30,evasion:30}},this.rareCreatures=Object(g.a)(Object(g.a)({"Eldritch Lich":{hp:2500,strength:8,speed:6,defense:4,"magic damage":13,evasion:5},"Primordial Vampire":{hp:3800,strength:3,speed:10,defense:10,"holy defense":10,"magic defense":10,"magic damage":3,evasion:3,absorb:4},Leviathan:{hp:9999,strength:10,speed:10,defense:25,evasion:25,counter:25}},this.extraplanar),this.dragons),this.bestiary=Object(g.a)(Object(g.a)(Object(g.a)(Object(g.a)(Object(g.a)({},this.basicCreatures),this.uncommonCreatures),this.challengingCreatures),this.rareCreatures),this.bosses),this.basicSubtypes={Hostile:{strength:1},Intimidating:{strength:2},Nimble:{speed:1},Quick:{speed:2},Timid:{evasion:1},Spry:{evasion:2},Dancing:{evasion:3},Vigilant:{regen:1},Relentless:{regen:2},Armored:{defense:1},Hardened:{defense:2},Benevolent:{heal:1},Protective:{heal:2},Snarling:{counter:1},Emboldened:{"bonus damage":1},Floating:{evasion:1,speed:1},Crystalline:{reflect:1},Glinting:{reflect:2},Mobile:{speed:1},Coldsnap:{speed:1,regen:1},Blinding:{reflect:1,absorb:1},Noxious:{defense:1,counter:1,absorb:1}},this.rareSubtypes={Voracious:{hp:5,strength:1,speed:1},Vicious:{hp:10,strength:1,defense:1},Vexatious:{hp:15,counter:1,evasion:1},Arrogant:{hp:-5,evasion:1,counter:1,speed:1},Querulous:{hp:-10,strength:1,speed:1,regen:1,absorb:1,defense:1},Adventurous:{hp:5,"bonus damage":2},Questing:{hp:10,"bonus damage":3},Silvered:{reflect:2},Mirrored:{reflect:3},Aggressive:{strength:3},Dominating:{strength:4},Swift:{speed:3},Accelerated:{speed:4},Elusive:{evasion:4},Reluctant:{evasion:5},Hidden:{evasion:6},Invisible:{evasion:8},Imperceptible:{evasion:15},Regrowing:{regen:3},Hydra:{regen:4},Fortified:{defense:3},Angelic:{heal:3,"holy damage":2},Prismatic:{reflect:3,absorb:2,evasion:1},Pugnacious:{"bonus damage":1,evasion:1,counter:1},Augmented:{strength:1,"magic damage":1,"bonus damage":1},Skillful:{defense:1,strength:1,speed:1,evasion:1,counter:1},Skeletal:{hp:-1,evasion:2,absorb:1,regen:1},Undead:{hp:-1,strength:1,regen:1,absorb:1,speed:1,evasion:1},Zombie:{hp:-2,evasion:1,regen:2,strength:1},Favored:{hp:1,strength:2,speed:2,"magic damage":1,regen:1,evasion:1},Fiendish:{hp:2,strength:3,speed:3,defense:1,regen:1,evasion:2},Fierce:{hp:2,strength:4,speed:4,defense:2,absorb:2,evasion:3},Opalescent:{hp:2,reflect:4,absorb:2,evasion:2,counter:2,heal:2},Cruel:{hp:3,strength:5,speed:5,"magic damage":3,"bonus damage":2,absorb:3,regen:1,evasion:4},Vortex:{hp:1,reflect:10,absorb:10,evade:50,counter:50},Shadow:{hp:2,"magic damage":20,absorb:20,evade:20,counter:20},Luminous:{hp:3,"holy damage":20,absorb:20,evade:20,counter:20},Defiant:{hp:1,"bonus damage":20,absorb:20,evade:20,counter:20},Devious:{hp:2,evasion:2,counter:20,absorb:20},Draconic:{hp:3,"magic damage":1,counter:20,absorb:20}},this.subtypes=Object(g.a)(Object(g.a)({Common:{},Evasive:{evasion:3,counter:2},Retaliatory:{defense:1,counter:2},Inspired:{"bonus damage":1},Infused:{"bonus damage":2,"magic damage":1},Radiant:{"holy damage":1},Resplendent:{"holy damage":2,strength:1,speed:1},Heavy:{strength:2,defense:2},Titanic:{strength:4,defense:2},Unholy:{"magic damage":1,"holy defense":1},Blessed:{"holy damage":1,absorb:1},Adept:{evasion:1,counter:1,defense:1,strength:1}},this.basicSubtypes),this.rareSubtypes),this.perks={Piercing:{hp:15,strength:1,defense:1,evasion:1,"bonus damage":1},Blessed:{hp:15,absorb:1,defense:1,regen:1,"holy damage":1},Enchanted:{hp:15,defense:1,evasion:1},Clockwork:{hp:15,defense:1,speed:2,evasion:1},Phantasmal:{hp:25,defense:1,evasion:4},Cosmic:{hp:30,defense:3,evasion:3,strength:3},Imperious:{hp:40,defense:4,"magic damage":3,speed:3}},this.monsterIds=new F,this.difficulty=1}return Object(u.a)(e,[{key:"generateBasicMonster",value:function(e){var t=M(Object.keys(this.basicCreatures)),n=x(0,20)>16?M(Object.keys(this.basicSubtypes)):"Common",r="Common"===n?t:[n,t].join(" ");e.name=r;Object.entries(this.bestiary[t]).forEach((function(t){var n=Object(w.a)(t,2),r=n[0],a=n[1];return e.things.add(Math.floor(1*a),r)})),Object.entries(this.subtypes[n]).forEach((function(t){var n=Object(w.a)(t,2),r=n[0],a=n[1];return e.things.add(Math.floor(1*a),r)}))}},{key:"generate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(t<=6)this.generateBasicMonster(e);else{var n=M(Object.keys(this.challengingCreatures)),r=x(0,20)>16?M(Object.keys(this.basicSubtypes)):"Common";t>=20&&x(0,20)>19&&(r=M(Object.keys(this.subtypes))),t>=25&&x(0,20)>19&&(n=M(Object.keys(this.bestiary)));var a="Common"===r?n:[r,n].join(" ");e.name="".concat(a," (").concat(this.monsterIds.next,")");var i=.0015*t*t,o=this.difficulty+2*i;Object.entries(this.bestiary[n]).forEach((function(t){var n=Object(w.a)(t,2),r=n[0],a=n[1];return e.things.add(Math.floor(a*o),r)})),Object.entries(this.subtypes[r]).forEach((function(t){var n=Object(w.a)(t,2),r=n[0],a=n[1];return e.things.add(Math.floor(a*o),r)})),e.things.add(e.things.count("hp"),"max hp"),t>=15&&(e.things.add(x(1,t/2),"defense"),e.things.add(x(1,t/2),"strength")),t>=25&&(e.things.add(x(1,t/2),"evasion"),e.things.add(x(1,t/2),"counter")),t>=35&&(e.things.add(x(1,t/2),"magic damage"),e.things.add(x(1,t/2),"chain chance")),t>=45&&(e.things.add(x(1,t/2),"holy damage"),e.things.add(x(1,t/2),"reflect"))}}},{key:"generateBoss",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=M(Object.keys(this.bosses)),r=M(Object.keys(this.rareSubtypes)),a=M(Object.keys(this.perks)),i=[a,r,n].join(" ");e.name=i;var o=this.difficulty+.01*t;Object.entries(this.bestiary[n]).forEach((function(t){var n=Object(w.a)(t,2),r=n[0],a=n[1];return e.things.add(Math.floor(a*o),r)})),Object.entries(this.rareSubtypes[r]).forEach((function(t){var n=Object(w.a)(t,2),r=n[0],a=n[1];return e.things.add(Math.floor(a*o),r)})),Object.entries(this.perks[a]).forEach((function(t){var n=Object(w.a)(t,2),r=n[0],a=n[1];return e.things.add(Math.floor(a*o),r)})),e.things.add(e.things.count("hp"),"max hp")}}]),e}(),Re=function(){function e(){Object(l.a)(this,e)}return Object(u.a)(e,null,[{key:"levelCost",value:function(e){return Math.floor(Math.pow(2,5+e))}},{key:"generate",value:function(e,t){e.traits.add(1,t),e.things.add(10,"hp"),e.things.add(1,"strength"),e.things.add(1,"speed");var n=this.characterClasses[t];Object.keys(n.attributes).forEach((function(t){var r=n.attributes[t];e.things.add(r,t)})),n.traits.forEach((function(t){return e.traits.add(1,t)})),e.things.add(15,"xp per victory"),e.things.add(Math.floor(12),"max hp"),e.traits.add(4,"Potion of Life"),e.things.add(1,"level");for(var r=0;r<4;r++)this.levelUp(e);e.meters={health:function(){return{value:e.things.count("hp"),max:e.things.count("max hp")}}}}},{key:"levelUp",value:function(e){var t=this,n={common:8,uncommon:5,rare:3,epic:2,legendary:1};Object.keys(this.attributes).forEach((function(r){for(var a=0;a<n[r];a++){var i=M(t.attributes[r]);if(i){e.things.add(1,i)}}}));var r={common:5,uncommon:7,rare:9,epic:11,legendary:13};Object.keys(this.perks).forEach((function(n){if(e.things.count("level")%r[n]===0){var a=M(t.perks[n]);a&&(console.log("Gain a rank in ".concat(a," (").concat(n,")")),e.traits.add(1,a))}})),e.things.count("level")%3===0&&e.traits.list().forEach((function(n){Object.keys(t.characterClasses).includes(n.name)&&Object.entries(t.characterClasses[n.name].attributes).forEach((function(t){var r=Object(w.a)(t,2),a=r[0],i=r[1];if(i>=0&&x(0,12)>8){var o=i>0?x(1,Math.max(1,i)):1;console.log("".concat(a," improves by ").concat(o," (").concat(n.name,")")),e.things.add(o,a)}}))}))}}]),e}();Re.characterClasses={Fighter:{attributes:{hp:12,strength:1,defense:1,speed:0,"bonus damage":0,"chain chance":0,"max chain":0},traits:["Fitness","Combat Veteran"]}},Re.attributes={common:["max hp"],uncommon:["hp per victory"],rare:["hp per day"],epic:["hp per step"],legendary:["hp per kill"]},Re.perkBenefits={"Cloaking Robe of Elvenkind":{"magic damage":.05,"magic defense":.5,evasion:.25,"holy defense":.05},"Combat Veteran":{strength:.05,defense:.05,counter:.05,evasion:.05,"crit damage":.05,"bonus damage":.05},"Fine Raiment":{"magic damage":.1,"magic defense":.2,defense:.15,evasion:.1},"Holy Symbol":{"holy damage":.5,"holy defense":.15,heal:.1,regen:.1},"Royal Armorer":{defense:.5,"holy defense":.25,"magic defense":.25,evasion:.25},Brutality:{strength:.5,speed:.25,"bonus damage":.25,"max chain":.1},Counterweight:{counter:.5,evasion:.1,"crit damage":.05,"max chain":.1},Efferverscence:{regen:.25,counter:.25,"crit damage":.25,"holy defense":.25,"max chain":.25},Efficacious:{counter:.1,evasion:.1,"bonus damage":.1,strength:.1,defense:.1,"magic defense":.1,heal:.1},Opalescence:{reflect:.2,absorb:.2,evasion:.2,defense:.2,regen:.2,heal:.2},Ethereal:{"magic damage":.25,"magic defense":.25,evasion:.5,defense:.25},Faith:{"holy damage":.25,"holy defense":.5,heal:.25,regen:.1},Finesse:{"crit chance":.25,"crit damage":.15,"max chain":.05,"chain chance":.1},Fitness:{strength:.1,defense:.1,speed:.1,evasion:.1,counter:.1,regen:.1},Fluidity:{"crit chance":.1,"crit damage":.1,evasion:.1,counter:.1,speed:.1},Dexterity:{defense:.25,"magic defense":.1,speed:.1,evasion:.1,"chain chance":.1},Precision:{speed:.1,"crit damage":.25,evasion:.05,"max chain":.1},Swiftness:{speed:.2,counter:.15,"crit chance":.15,defense:.1},Rapidity:{speed:.5,counter:.1,"crit damage":.25,evasion:.1},Medic:{heal:.5,regen:.1,absorb:.1,defense:.1},Vitality:{strength:.1,speed:.25,regen:.5,heal:.1},Whirlwind:{"chain chance":.5,"max chain":.5,"damage to all":.5,"bonus damage":.1},Focus:{"magic damage":.5,"magic defense":.25,"holy damage":.1,"holy defense":.5},Iridescence:{"magic damage":.5,"holy damage":.5,"bonus damage":.5,"damage to all":.5},Concentration:{"magic defense":.25,"holy defense":.5,defense:.1,evasion:.1,counter:.1},Salvation:{"holy damage":.5,"holy defense":.2,defense:.1,reflect:.1,absorb:.1}},Re.perks={common:["Fitness","Finesse","Rapidity","Precision","Medic","Focus"],uncommon:["Concentration","Swiftness","Fluidity","Faith","Combat Veteran","Efficacious"],rare:["Dexterity","Brutality","Ethereal","Perspicuous","Vitality"],epic:["Iridescence","Fine Raiment","Royal Armorer","Whirlwind"],legendary:["Salvation","Eternal Victory","Perfectionist","Effervescence","Opalescence"]};var Ge=function e(){Object(l.a)(this,e)};Ge.durations={round:104,day:7e3};var Le,_e=(De=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(l.a)(this,n),(e=t.call(this,"The Arena")).events=new O,e.eventIds=new F,e.metrics={"challenge rating":function(){return e.challengeRating}},e.heroIds=new F,e.metricGrain=150,e.manual=new Be;return["day","step","li","gil","kill","victory","death","tpk"].forEach((function(t){return e.resources.create(t)})),e.people.create("Adventurers"),e.spawnHero("Fighter"),Object.keys(Re.characterClasses).forEach((function(t){e.actions.create({name:"Hire ".concat(t),act:function(){return e.spawnHero(t)}})})),e.actions.create({name:"Hire Party",act:function(){for(var t=0;t<3;t++)e.spawnHero(M(Object.keys(Re.characterClasses)))}}),e.people.create("Enemies"),e.spawnEnemyParty(),e.evolve(e.tick),e}return Object(u.a)(n,[{key:"enemyInjured",value:function(e,t){this.events.add({id:this.eventIds.next,kind:"enemy-injured",enemyName:e,amount:t,at:this.ticks})}},{key:"turnStarted",value:function(){this.events.add({id:this.eventIds.next,kind:"turn-started",at:this.ticks})}},{key:"spawnHero",value:function(e){var t="".concat(e," (").concat(this.heroIds.next,")"),n=this.party.create(t);Re.generate(n,e)}},{key:"challengeRating",get:function(){if(0===this.party.count)return-1;var e=this.party.list().map((function(e){return e.things.count("level")})).reduce((function(e,t){return e+t})),t=1+this.resources.count("step")/1250+this.resources.count("day")/14+this.party.count+e/this.party.count;return Math.floor(t)}},{key:"recent",value:function(e){return this.recentEvents.filter(b("kind",e))}},{key:"damagePerTick",get:function(){var e=this.recent("enemy-injured").map((function(e){return e.amount})).reduce((function(e,t){return e+t}),0);return Math.floor(e/this.metricGrain)}},{key:"recentEvents",get:function(){var e=this;return this.events.items.filter((function(t){return t.at>e.ticks-e.metricGrain}))}},{key:"spawnEnemyParty",value:function(){if(0!==this.party.count)for(var e=0;e<x(1,2+this.party.count);e++){var t=this.enemies.create("new enemy");this.manual.generate(t,this.challengeRating)}}},{key:"party",get:function(){return this.people.lookup("Adventurers")}},{key:"enemies",get:function(){return this.people.lookup("Enemies")}},{key:"injure",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=Math.floor(Math.min(e.things.count("hp"),t));if(!(a<=0)){e.things.remove(a,"hp"),this.enemies.list().includes(e)&&this.enemyInjured(e.name,a),console.log("".concat(n.name," hit ").concat(e.name," for ").concat(a,"!"));var i=Math.min(this.effective(n,"absorb"),a);if(i>0){var o=x(0,i);console.log("".concat(n.name," absorbed ").concat(o," hp!")),this.heal(n,o)}if(e.things.count("hp")>0){var s=Math.min(this.effective(e,"reflect"),a);s>0&&!r&&(console.log("".concat(e.name," reflected ").concat(s," damage!")),this.injure(n,s,e,!0));var c=this.effective(e,"counter");x(0,100)<c&&(console.log("".concat(e.name," counter-attacked against ").concat(n.name,"!")),this.strike(e,n))}}}},{key:"effective",value:function(e,t){var n=e.things.count(t);if(0===n)return 0;var r=1;return Object.keys(Re.perkBenefits).forEach((function(n){var a=Re.perkBenefits[n];if(Object.keys(a).includes(t)){var i=e.traits.count(n);if(i>0){var o=a[t]*i;r+=o}}})),Math.floor(n*r)}},{key:"strike",value:function(e,t){var n=this.effective(t,"holy defense"),r=Math.max(0,this.effective(e,"holy damage")-n),a=this.effective(t,"magic defense"),i=Math.max(0,this.effective(e,"magic damage")-a),o=0,s=!1,c=1+this.effective(t,"evasion");if(x(0,100)>Math.min(95,2*c)){var l=this.effective(t,"defense"),u=Math.max(1,this.effective(e,"strength")-l),h=this.effective(e,"bonus damage"),d=1+this.effective(e,"crit chance");(s=x(0,100)<Math.max(50,2*d))&&console.log("".concat(e.name," landed a critical strike on ").concat(t.name,"!")),o=s?u+h+x(1,this.effective(e,"crit damage")):x(1,u)+h}var f=i+o+r;f>0?this.injure(t,f,e):console.log("".concat(e.name," swung for ").concat(t.name," but missed!"))}},{key:"attack",value:function(e,t){var n=this;e.list().forEach((function(e){var r=Math.min(12,e.things.count("speed")),a=1+Math.floor(Math.max(12-r,0));if(n.ticks%a===0){var i=n.effective(e,"damage to all");i>0&&t.list().forEach((function(t){var r=x(1,i);n.injure(t,r,e)}));var o=M(t.list());if(o){var s=function(){return n.strike(e,o)};s();for(var c=n.effective(e,"chain chance"),l=1+n.effective(e,"max chain"),u=0;u++<l;){x(0,100)<c&&(console.log("...and swung again (".concat(u," times)!")),s())}}}}))}},{key:"heal",value:function(e,t){var n=e.things.count("hp"),r=e.things.count("max hp")-n,a=Math.min(r,t);e.things.add(Math.floor(a),"hp")}},{key:"per",value:function(e){var t=this;this.party.list().forEach((function(n){var r=t.effective(n,"xp per ".concat(e))*(1+.1*n.traits.count("Perspicuous"))*(1+.25*n.traits.count("Perfectionist"));n.things.add(Math.floor(r),"xp");var a=t.effective(n,"gold per ".concat(e))*(1+.25*n.traits.count("Perfectionist"));if(t.resources.add(Math.floor(a),"gil"),n.things.count("hp")<n.things.count("max hp")){var i=t.effective(n,"hp per ".concat(e))*(1+.25*n.traits.count("Perfectionist"));t.heal(n,i)}}))}},{key:"round",value:function(){var e=this;this.per("round"),this.party.list().forEach((function(t){var n=e.effective(t,"regen");if(e.heal(t,n),t.things.count("heal")&&e.party.list().forEach((function(n){var r=e.effective(t,"heal");e.heal(n,x(1,r))})),t.traits.count("Potion of Life")>0&&t.things.count("hp")<.35*t.things.count("max hp")){console.log("".concat(t.name," drank a potion of life!")),t.traits.remove(1,"Potion of Life");var r=30+x(1,12)+e.effective(t,"heal");e.heal(t,r)}})),this.enemies.list().forEach((function(t){e.heal(t,e.effective(t,"regen"))}))}},{key:"tick",value:function(e,t){var n=e.resources;if(this.party.list().forEach((function(e){var t=e.things.count("level"),n=Re.levelCost(t);e.things.count("xp")>n&&(e.things.remove(n,"xp"),e.things.add(1,"level"),console.log("".concat(e.name," level up!")),Re.levelUp(e))})),t%Ge.durations.round===0&&this.round(),t%Ge.durations.day===0&&(n.add(1,"day"),this.per("day")),0===this.enemies.count&&this.party.count>0){if(t%5===0){if(this.resources.add(1,"step"),this.per("step"),this.resources.count("step")%500===0){n.add(1,"li"),this.per("li");for(var r=x(0,20)>19?["Shell Matrix","Cloaking Robe of Elvenkind","Counterweight"]:["Potion of Life","Healing Salve"];this.resources.count("gil")>1e3;){M(this.party.list()).traits.add(1,M(r)),this.resources.remove(1e3,"gil")}}var a=60+this.resources.count("li")+this.party.count;x(0,100)>a&&(this.spawnEnemyParty(),this.per("encounter"))}}else this.turnStarted(),this.per("turn"),this.attack(this.party,this.enemies),this.attack(this.enemies,this.party),this.mortalityCheck(n)}},{key:"mortalityCheck",value:function(e){var t=this;this.party.list().forEach((function(n){n.things.count("hp")<=0&&(n.traits.count("Eternal Victory")>0?(t.heal(n,200),n.traits.remove(1,"Eternal Victory")):n.traits.count("Healing Salve")>0?(t.heal(n,100),n.traits.remove(1,"Healing Salve")):n.traits.count("Shell Matrix")>0?(t.heal(n,50),n.things.add(150,"magic hp"),n.traits.remove(1,"Shell Matrix")):(t.per("death"),t.party.destroy(n.name),e.add(1,"death"),console.log("".concat(n.name," was slain!")),0===t.party.count&&(t.per("tpk"),e.add(1,"tpk"),console.log("The party has fallen... The quest is lost."))))})),this.enemies.list().forEach((function(n){if(n.things.count("hp")<=0&&(t.per("kill"),t.enemies.destroy(n.name),e.add(1,"kill"),console.log("".concat(n.name," was slain!")),0===t.enemies.count))return t.per("victory"),e.add(1,"victory"),void console.log("The party was victorious! The quest continues...")}))}}]),n}(fe),Object(v.a)(De.prototype,"spawnHero",[y.a],Object.getOwnPropertyDescriptor(De.prototype,"spawnHero"),De.prototype),Object(v.a)(De.prototype,"spawnEnemyParty",[y.a],Object.getOwnPropertyDescriptor(De.prototype,"spawnEnemyParty"),De.prototype),Object(v.a)(De.prototype,"tick",[y.a],Object.getOwnPropertyDescriptor(De.prototype,"tick"),De.prototype),De),He=new _e,Te=n(13);var We=(Le=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,"".concat(e," Factory"))).events=new W,r.bills=new O,r.metrics={"Production Speed":function(){return r.deliveryRate},"Total Fulfillments":function(){return r.fulfillmentEvents.length},"Orders In Queue":function(){return r.bills.count}},r.metricGrain=100,r.produce=function(e,t){if(r.canProduce(t))r.workers.jobs.set(e,t);else if(t.consumes){var n=[];Object.entries(t.consumes).forEach((function(e){var t=Object(w.a)(e,2),a=t[0],i=t[1];r.resources.count(a)<i&&n.push(a)}));var a=n[x(0,n.length)],i=null;r.workers.recipes.each((function(e){e.produces[a]&&(i=e)})),i&&r.produce(e,i)}},r.missingRequirements=function(e){var t=[];return e.consumes&&Object.entries(e.consumes).forEach((function(e){var n=Object(w.a)(e,2),a=n[0],i=n[1];r.resources.count(a)<i&&t.push(a)})),t},r.canProduce=function(e){var t=!0;return e.consumes&&Object.entries(e.consumes).forEach((function(e){var n=Object(w.a)(e,2),a=n[0],i=n[1];r.resources.count(a)<i&&(t=!1)})),t},r.evolution=function(e){var t=e.resources;r.manage(t),r.bills.count>0&&r.workers.work({resources:t})},r.orderIds=new F,r}return Object(u.a)(n,[{key:"emit",value:function(e,t,n){this.events.create({name:t,description:n,kind:e,at:this.ticks})}},{key:"deliveryRate",get:function(){return this.recentEvents.filter(b("kind","order:fulfilled")).length/this.metricGrain}},{key:"recentEvents",get:function(){var e=this;return this.events.list().filter((function(t){return t.at>e.ticks-e.metricGrain}))}},{key:"fulfillmentEvents",get:function(){return this.events.list().filter(b("kind","order:fulfilled"))}},{key:"product",value:function(e,t){var n=this;this.actions.create({name:"Order ".concat(e),act:function(t){var r=t.count,a=t.deliverTo;n.order(r||20,e,a||{receive:function(){return 1}})}}),this.resources.create(e),this.workers.recipes.create({name:e,produces:Object(Te.a)({},e,1),consumes:t})}},{key:"reboot",value:function(){var e=this;this.reset(),this.people.create("Workers"),this.bills.clear(),this.evolve(this.evolution),this.policies.create({name:"FIFO",manage:function(){var t=e.unfulfilled(e.bills.first)[0],n=e.workers.recipes.lookup(t);n&&e.workers.list().forEach((function(t){return e.produce(t,n)}))}}),this.policies.create({name:"Round Robin",manage:function(){var t=function(e){for(var t={},n=[],r=0,a=e.length;r<a;++r)t.hasOwnProperty(e[r])||(n.push(e[r]),t[e[r]]=1);return n}(e.bills.items.flatMap((function(t){return e.unfulfilled(t)})));e.workers.list().forEach((function(n,r){var a=t[r%t.length],i=e.workers.recipes.lookup(a);i&&e.produce(n,i)}))}}),this.choose("FIFO")}},{key:"unfulfilled",value:function(e){var t=this;if(void 0===e)return[];var n=Object.keys(e.order),r=[];return n.forEach((function(n){var a=e.order[n];t.resources.count(n)<a&&r.push(n)})),r}},{key:"order",value:function(e,t,n){var r={id:this.orderIds.next,order:Object(Te.a)({},t,e),account:n,price:e};return this.bills.add(r),r}},{key:"workers",get:function(){return this.people.lookup("Workers")}},{key:"manage",value:function(e){var t=this;0!==this.bills.count&&(this.bills.each((function(e){var n=Object.keys(e.order);0===t.unfulfilled(e).length&&(e.account.receive([],e),n.forEach((function(n){t.resources.remove(e.order[n],n)})),t.bills.remove(e),t.emit("order:fulfilled","An order for ".concat(n.join(",")," has been fulfilled")))})),this.currentPolicy?this.currentPolicy.manage():console.warn("No labor policy selected!"))}}]),n}(fe),Object(v.a)(Le.prototype,"reboot",[y.a],Object.getOwnPropertyDescriptor(Le.prototype,"reboot"),Le.prototype),Le),Ve=new F,qe=new We("Zep");qe.reboot(),qe.product("Soles",{}),qe.product("Laces",{}),qe.product("Socks",{}),qe.product("Shoes",{Soles:2,Laces:2}),qe.product("Hat",{}),qe.product("Belt",{}),qe.product("Underwear",{}),qe.product("Pants",{}),qe.product("Outfit",{Pants:1,Belt:1,Hat:1,Socks:1,Shoes:1});var ze=qe.people.create("Management");ze.create("Operations Chief"),ze.create("Plant Manager"),qe.machines.create("Robot"),qe.actions.create({name:"Spawn Worker",act:function(){qe.workers.create("Employee #".concat(Ve.next))}});var Ue,Qe,Je,Ke=qe,Ze=n(11),Xe=function(e){return e.replace(/^\w/,(function(e){return e.toUpperCase()}))},Ye=function(e){return e.split(" ").map((function(e){return Xe(e)})).join(" ")},$e=["earth","sky","mountain","hill","valley","peak","mound","point","mountain-chain","isle","sea","lake","bay","pool","harbor","forest","river","glen","stream","land","place","realm","region","peoples","kingdom","road","path","haven","fortress","prison","citadel","stronghold","tower","garden","ever-","-less","at-","-person","-man","-son","-woman","-maid","-daughter","friend","foe","lord","slave","king","queen","prince","princess","light","shadow","shade","sun","moon","stars","day","night","spark","starlight","firmament","mist","snow","wind","rain","cloud","rainbow","dew","frost","tin","iron","silver","gold","white","black","gray","red","blue","green","orange","dragons","elephants","bears","birds","horses","snakes","wolves","hounds","swans","eagles","nightingales","ice","fire","earth","water","embers","steam","magma","radiance","soot","ash","salt","void","morning","evening","dusk","noon","afternoon","midnight","willow","pine","cherry","oak","spruce","birch","elm","holly","rose","daisy","poppy","dandelion","lily","autumn","winter","spring","summer","dread","horror","awe","joy","sorrow","gloom","apple","honey","bread","elderberry","wine","fish","wax","tall","deep","lofty","lonely","great","large","small","tiny","narrow","wide","sharp","giant","quick","pale","golden","holy","fortunate","dusty","beautiful","fell","cloudy","secret","sweet","bold","splendid","abundant","sparkling","horns","fangs","claws","love","dream","music","silence","divine","fate","thought","speech","skill","tomorrow","spirit","tyranny","freedom","magic","blood","tears","jewel","ship","needle","bell","candle","mantle","veil","journey","treasure","battle","smith"],et=function(){function e(t,n,r){var a=this;Object(l.a)(this,e),this.languageName=t,this.vocabulary=n,this.enhanceTranslation=r,this.name=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(){for(var e=Xe(t.join("-")),n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var o=Xe(r.join("-")),s="".concat(o," ").concat(e);o.endsWith("s")&&(s="".concat(o,"' ").concat(e));var c="".concat(a.translate.apply(a,t.concat(r)));return[s,c]}},this.nameInverse=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(){for(var e=Xe(t.join("-")),n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var o=Xe(r.join("-")),s="".concat(o," ").concat(e);o.endsWith("s")&&(s="".concat(o,"' ").concat(e));var c="".concat(a.translate.apply(a,r.concat(t)));return[s,c]}}}return Object(u.a)(e,[{key:"translate",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var a=n.reduce((function(t,n,r){var a=e.vocabulary[n],i=!0;((t=t.trim()).endsWith("-")||t.endsWith("*"))&&(i=!1,t=t.substring(0,t.length-1)),r>0&&(a.startsWith("-")||a.startsWith("*"))&&(i=!1,a=a.substring(1,a.length));var o=[t,a];return n.startsWith("-")&&(i=!1),o.join(i?" ":"")}),"");a=a.replaceAll("-","");var i=this.enhanceTranslation?this.enhanceTranslation(a):a;return Ye(i)}}]),e}(),tt=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object(l.a)(this,n),(r=t.call(this)).dictionary=e,r.invertOrder=a,r.notions=void 0;for(var i=arguments.length,o=new Array(i>2?i-2:0),s=2;s<i;s++)o[s-2]=arguments[s];return r.notions=o,r}return Object(u.a)(n,[{key:"generate",value:function(){console.log("Generate ".concat(this.notions.join("/")," using ").concat(this.dictionary.languageName," dictionary..."));var e=P(1,$e),t=(this.invertOrder?this.dictionary.nameInverse(M(this.notions)):this.dictionary.name(M(this.notions))).apply(void 0,Object(Ze.a)(e)),n=Object(w.a)(t,2),r=n[0],a=n[1];return"".concat(a," (").concat(r,")")}}]),n}(B),nt=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=t.man,i=t.woman,o=t.son,s=t.daughter,c=t.crown,l=t.place,u=t.tree,h=t.sleep,d=t.flower,f=t.beauty,p=t.great,m=t.small,v=t.water,y=t.cove,b=t.safe,j=t.light,w=t.shadow,k=t.one,O=t.many,x=t.joy,E=t.sorrow,M=t.sweet,P=t.bitter,S=t.point,C=t.heat,I=t.cold,A=t.tall,N=t.deep,F=t.bell,D=t.mound,B=t.run,R=t.sing,G=t.way,L=t.no,_=t.at,H=t.eat,T=t.drink,W=t.good,V=t.bad,q=t.quick,z=t.slow,U=t.time,Q=t.air,J=t.cut,K=t.all,Z=t.hard,X=t.soft,Y=t.color,$=t.ore,ee=t.wing,te=t.snake,ne=t.horse,re=t.bear,ae=t.elephant,ie=t.dog,oe=t.wild,se=t.fear,ce=t.death,le=t.sound,ue=t.tooth,he=t.heart,de=t.wood,fe=t.over,pe=t.high,ge=t.fight,me=t.face,ve=t.mere,ye=t.strong,be={"-person":a,"-man":a,"-woman":i,"-maid":m+i,"-son":o,"-daughter":s,veil:fe+me,star:X+j,daisy:F+d,poppy:h+d,dandelion:c+d,willow:E+u,cherry:W+u,spruce:M+u,pine:P+u,birch:m+u,elm:A+u,oak:Z+u,holly:x+u,king:c+a,queen:c+i,sea:p+v,lake:v+l,pool:v+ve,bay:y+l,harbor:b+y,haven:b+l,forest:O+u+l,people:O+a+i,ice:P+I,prison:P+E+l,jewel:m+f,needle:P+S,candle:C+S,hill:m+D+l,mountain:p+D+l,valley:m+N+l,peak:p+S+l,mound:D+l,land:O+a+l,lofty:p+pe,sky:p+pe+fe,low:m+k,river:v+B+G,isle:N+v+l,wine:x+T,honey:M+T,apple:m+H,bread:W+H,elderberry:b+H,fish:m+q,harvest:u+a+J,night:w+U,garden:d+l,vault:N+J+l,white:j+Y,black:w+Y,green:u+Y,red:C+Y,blue:I+Y,morning:j+U,evening:w+U,noon:pe+j,fire:C+j,tin:X+$,silver:f+$,gold:N+$,bird:q+ee,birds:W+ee,horses:ne,elephants:ae,bears:re,snakes:te,wolves:oe+ie,hounds:W+ie,large:A+p,tiny:m+m,thirst:L+T,wax:z+X,fortunate:p+W,beautiful:p+f,silence:L+le,music:a+i+R,abundant:O+O,teeth:O+ue,battle:O+a+ge},je=be.fire,we=be.red,ke=be.vault,Oe=be.star,xe=be.night,Ee=be.ice,Me=be.harvest,Pe=be.river,Se=be.mountain,Ce=be.valley,Ie=be.king,Ae=be.land,Ne=be.lofty,Fe=be.sky,De=be.low,Be=be.people,Re=be["-person"],Ge=be.white,Le=be.black,_e=be.morning,He=be.evening,Te=be.noon,We=be.bird,Ve=be.large,qe=be.thirst,ze=be.silence,Ue=be.music,Qe=be.teeth,Je=be.battle,Ke={dragons:ye+ee+te,swans:f+We,eagles:Ne+We,nightingales:He+We,iron:ye+$,dusk:_e+He,gray:Ge+Le,orange:Me+Y,afternoon:N+Te,midnight:N+He,lily:Oe+d,rose:we+d,divine:p+Ie,princess:Ie+s,prince:Ie+o,kingdom:Ie+Be+l,fortress:Ie+b+l,citadel:O+Be+l,stronghold:b+Be+N+l,tower:A+fe,"mountain-chain":O+Se+l,friend:M+Re,foe:P+Re,lord:Ne+Re,slave:De+Re,rain:Fe+v,earth:O+Ae,glen:Pe+Ce,stream:m+Pe,realm:k+Ce+l,region:O+Pe+Ae,peoples:Be+Be,road:K+Re+G,path:B+G,shade:N+w,sun:Fe+j,moon:xe+j,autumn:Me+U,winter:P+U,spring:d+U,summer:ye+C+U,cloud:Fe+v,cloudy:K+Fe+v,"ever-":K+U,"-less":L,"at-":_,stars:O+Oe,day:j+Fe+U,starlight:Oe+j,spark:ye+je,snow:Fe+I,mist:X+Fe,firmament:ye+ke,wind:ye+Q,rainbow:O+Y+Fe,frost:Z+Ee,dew:m+_e+v,dread:se+Ie,lonely:k+_+ve,giant:k+Ve+a,awe:p+se,ash:je+ce,steam:je+v,magma:je+Pe,dry:C+qe,food:H+Me,space:p+Ne,dark:N+w,broad:N+N,voice:Re+Ue,war:p+Je},Ze=Ke.dread,Xe=Ke.ash,Ye=Ke.rainbow,$e=Ke.dry,tt=Ke.food,nt=Ke.space,rt=Ke.dark,at=Ke.broad,it=Ke.orange,ot=Ke.divine,st=Ke.voice,ct=Ke.iron,lt=Ke.spark;console.log("assemble!",{roots:t,basics:be,intermediate:Ke});var ut=Object(g.a)(Object(g.a)(Object(g.a)(Object(g.a)({},t),be),Ke),{},{sparkling:O+lt,horror:Le+Ze,embers:je+Xe,soot:Le+Xe,radiance:Ye+Y,salt:$e+tt,void:L+nt,gloom:rt+Le,narrow:Pe+Ce+l,wide:at+Ae,sharp:Ze+S,pale:X+Ge,golden:Ge+it+f,holy:ot+x,dusty:$e+X,fell:I+se,secret:rt+ze,bold:ye+st,splendid:Ye+j,horns:O+Ze+S,claws:V+S,fangs:Ze+Qe,love:he+Re,dream:h+Ue,fate:ot+je,speech:O+st,tomorrow:U+U,spirit:j+ot,tyranny:V+Ie,magic:ot+lt,thought:j+U,skill:W+Re,freedom:ye+Be,blood:we+v,tears:E+v,ship:v+de,journey:l+U+Re,treasure:W+x,smith:ct+Re},n);return console.log("FULL VOCAB",{vocab:ut}),new et(e,ut,(function(e){return Object.keys(r).forEach((function(t){e.includes(t)&&(e=e.replaceAll(t,r[t]))})),e}))}("Khuzdul",{shadow:"um",tree:"an",woman:"llen",man:"nil",mound:"on",quick:"e",time:"enor",over:"on-",at:"e-",bitter:"d",beauty:"ari",high:"l",wing:"l",safe:"-ond",place:"-",great:"gh",hard:"ekh",strong:"l",heat:"ut",light:"ie",daughter:"en",deep:"t",water:"ul",many:"o",cold:"\xed",one:"er",mere:"s\xeba",all:"er",wood:"taf",cut:"k",crown:"l\xef",run:"r",sorrow:"uj",joy:"je",no:"u-",sing:"ina",fear:"ga",tooth:"tur",color:"o",fight:"klak",air:"ur",bad:"nu",bear:"gruw",bell:"du",cove:"cof",death:"lun",dog:"hu",drink:"le",eat:"zu",elephant:"elefant",flower:"ela",good:"lu",heart:"eru",horse:"raph",ore:"im",point:"-el",sleep:"ol",small:"i",snake:"lug",soft:"i",son:"on",sweet:"hl",tall:"mu-",way:"eh",wild:"pel",sound:"ada",face:"vih",mantle:"m\xf6tull",slow:"ikshu"},{prison:"fengsel",iron:"jern",holly:"kristtorn",land:"jord",mountain:"fjell","mountain-chain":"fjellkjede",bay:"vik",stars:"stjerne",silence:"stille",silver:"s\xf8lv",river:"elv",ice:"is",icy:"iskald",fangs:"hoggtann",dragons:"drager",giant:"kjempe",hill:"h\xf8yde",golden:"gyllen",music:"musikk",pine:"furu",eagles:"\xf8rn",gray:"gr\xe5-",fire:"brann-",stronghold:"fort",tyranny:"grusomhet",nightingales:"nattergal",vale:"dal",magic:"seith"},{llent:"lion","la\xfa":"l\xfb",eille:"ye",ielle:"we",oo:"\u0153",ieo:"a",ii:"\u012b",ilel:"iel",lel:"iliel",nillut:"nt",lll:"l",nina:"on",oul:"il",aa:"a",ilo:"e",ndon:"ine",eillio:"eo",iegh:"g\xffl",igh:"g",tie:"tion",onl:"l\xff","\xefni":"iel",milk:"mel",ee:"e",ilr:"ul",eghl:"elen"}),rt=nt,at={uwen:"uviel",db:"v",dc:"g",nc:"g",uie:"uvie",airt:"\xedrd",ir:"er",ln:"len",ean:"\xf3n\xeb",fn:"van",rngil:"rgil*",nn:"n",egdor:"egion",ororo:"oro"},it={ng:"a"},ot={ss:"\xeb",n:"iath",lt:"hen",ll:"l"},st={er:"ess\xeba",r:"iand",on:"ion",il:"ion",d:"\xeb"},ct=new et("Aelvic (Neo-Sindarin)",{"-less":"uv-","ever-":"ui-","at-":"ad-","-person":"-we","-man":"-on","-son":"-ion","-woman":"-ien","-maid":"-wen","-daughter":"-iell","mountain-chain":"-orodrim",abundant:"ovor",afternoon:"avnedhor",apple:"orf",autumn:"iarvas-",awe:"anwar",battle:"dagor",bay:"c\xf4f",bears:"graw",beautiful:"bain",bell:"nell",birch:"hwinn*",birds:"aewen",black:"morn",blood:"sereg",blue:"luin-",bold:"beren",bread:"-bas",candle:"l\xedgu",cherry:"aebin*",citadel:"ost-",claws:"gamp-",cloudy:"fanui",daisy:"eirien",dandelion:"orchen",day:"or-",deep:"n\xfbr-",dew:"m\xeedh-",divine:"ballean",dragons:"amlug",dread:"gost",dream:"\xf4l",dusk:"moth-",dusty:"astren*",eagles:"thoron",earth:"-amar",elderberry:"gwennod",elephants:"annabon",elm:"alaf",evening:"aduial",fangs:"carax\xeb",fate:"amarth",fell:"delu",fire:"nor-",firmament:"menel*",fish:"lhim",foe:"-coth",forest:"taur*",fortress:"garth-",fortunate:"alwed",freedom:"leinas",friend:"-mellon",frost:"nais",giant:"noroth",glen:"imlad",gloom:"dim-",gold:"malt-",golden:"gl\xf3riel",gray:"thind-",great:"beleg-",green:"calen-",harbor:"h\xfbb",haven:"-lond*",hill:"-amon",holy:"aer",honey:"gl\xee",horns:"rais",horror:"angoss-",horses:"roch",ice:"hel-",iron:"ang-",isle:"tol",jewel:"m\xeer",journey:"ledh-",joy:"glass-",king:"aran",kingdom:"arnad",lake:"ael",land:"-dor-",large:"daer",light:"ea",lily:"loth",lofty:"raud",lonely:"air*",lord:"-gon",love:"m\xeel",magic:"l\xfbth",mantle:"col-",midnight:"fuin",mist:"hith-",moon:"ithil",morning:"-aur",mound:"coro-",mountain:"ered",music:"-linnas",narrow:"agor-",needle:"aeglin",night:"d\xfb",nightingales:"d\xfalin*",noon:"nedhor",oak:"doron*",orange:"culuin",pale:"nim-",path:"lant",peak:"aegnas",peoples:"li-",pine:"thon*",place:"sa-",point:"til",pool:"l\xeen",poppy:"lurloss-",prison:"-band",quick:"lim",rain:"ross-",rainbow:"ninniach",realm:"-arthor",red:"caran-",region:"gardh",river:"-rant",road:"men",rose:"merin*",sea:"-geaer",secret:"dolen*",shade:"gwath",shadow:"-lum",sharp:"crisg-",ship:"cair*",silence:"dh\xedn-",silver:"celeb-",skill:"curu-",sky:"-ell",slave:"m\xfbl",small:"cidinn*",smith:"-tan",snakes:"l\u0177g",snow:"loss-",sorrow:"n\xeer",spark:"tinu-",sparkling:"m\xedriel",speech:"paeth*",spirit:"f\xeba-",splendid:"claur-",spring:"ethuil",spruce:"ecthelorn*",starlight:"gilith",stars:"-ngil",stream:"s\xeer",stronghold:"-gothrond",summer:"llair\xeb",sun:"anor*",swans:"alqua",sweet:"laich",tall:"ta-",tears:"nirnaeth",thought:"nauth*",tin:"-ladog",tiny:"tithen*",tomorrow:"abor",tower:"barad-",treasure:"maen*",tyranny:"thang",valley:"nan",veil:"f\xe2n",water:"nin",wax:"l\xeeg",white:"nique-",wide:"-land",willow:"tathar*",wind:"gwae",wine:"miru",winter:"rh\xeew",holly:"ereg*",garden:"sant",queen:"bereth",prince:"ernil",princess:"brethil",cloud:"fan",hounds:"h\xfb",wolves:"draug",embers:"i\xfbl",soot:"ast",ash:"lith",salt:"sing",void:"gaw",steam:"tuim",magma:"orodu",radiance:"aglar"},(function(e){return function(e){return e.split(" ").map((function(e){return e.startsWith("-")&&(e=e.substring(1,e.length),Object.keys(it).forEach((function(t){e.startsWith(t)&&(e=it[t]+e)}))),e.endsWith("-")&&(e=e.substring(0,e.length-1),Object.keys(ot).forEach((function(t){e.endsWith(t)&&(e+=ot[t])}))),Object.entries(at).forEach((function(t){var n=Object(w.a)(t,2),r=n[0],a=n[1];e=e.replaceAll(r,a)})),e.endsWith("*")&&(e=e.replaceAll("*",""),Object.keys(st).forEach((function(t){e.endsWith(t)&&(e+=st[t])}))),e.replaceAll("*",""),e})).join(" ")}(e)})),lt=new et("Common",{abundant:"over",afternoon:"afternoon",apple:"\xe6ppel",autumn:"h\xe6rfest",awe:"awe",battle:"feoht",bay:"berie",bears:"bear",beautiful:"beautiful",bell:"cnyll",birch:"birce",birds:"birds",black:"bl\xe6c",blood:"blood",blue:"blue",bold:"bold",bread:"bread",candle:"candle",cherry:"cirse",citadel:"city",claws:"claws",cloudy:"clouded",daisy:"woundwort",dandelion:"puffball",day:"day",deep:"deep",dew:"deaw",divine:"godbearn",dragons:"f\xfdrdraca",dread:"br\xf3ga",dream:"dr\xe9am",dusk:"eventide",dusty:"dirty",eagles:"earn",earth:"land",elderberry:"elder",elephants:"oliphaunt",elm:"wahu",evening:"evendim",fangs:"fon",fate:"fate",fell:"fell",fire:"b\xe6l",firmament:"heavens",fish:"fish",foe:"-feond",forest:"woods",fortress:"hold",fortunate:"lucky",freedom:"freedom",friend:"friend",frost:"rime",giant:"\u0113oten",glen:"dell",gloom:"murk",gold:"gold",golden:"gylden",gray:"gr\xe6",great:"great",green:"green",harbor:"hyth",haven:"-port",hill:"dun",holy:"hallowed",honey:"honey",horns:"horns",horror:"horror",horses:"horses",ice:"\u012bs",iron:"\xedsen",isle:"\u012begland",jewel:"jewel",journey:"quest",joy:"joy",king:"kenning",kingdom:"kenningdom",lake:"lac",land:"e\xe4th",large:"large",light:"light",lily:"tigerlily",lofty:"lofty",lonely:"syndrig",lord:"-lord",love:"love",magic:"r\xfan",mantle:"hacele",midnight:"midnyght",mist:"mistur",moon:"mone",morning:"-morn",mound:"tel-",mountain:"munt-",music:"dr\xe9amcr\xe6ft",narrow:"narrow-",needle:"needle",night:"nyght",nightingales:"st\xe6rlinc",noon:"noon",oak:"eik",orange:"orenge",pale:"wann-",path:"brimlad",peak:"peak",peoples:"-folk",pine:"pintreow",place:"-stead",point:"-gad",pool:"-cl\xe6ne",poppy:"celandine",prison:"gaol",quick:"fast",rain:"rainy",rainbow:"rainbow",realm:"-r\xedce",red:"reod-",region:"-guard",river:"-ex",road:"road",rose:"r\xf3se",sea:"estmere",secret:"secret",shade:"sceadu",shadow:"sceaduwe",sharp:"sharp",ship:"scip",silence:"stige",silver:"seolfor",skill:"skill",sky:"sky",slave:"thrall",small:"sm\xe6l",smith:"-wyrhta",snakes:"serpent",snow:"snow-",sorrow:"sorrow",spark:"ysl",sparkling:"sparkling",speech:"speech*",spirit:"arodnes-",splendid:"splendid-",spring:"spring",spruce:"s\xe6ppe",starlight:"starlight",stars:"-steorra",stream:"river",stronghold:"-f\xe6sten",summer:"sumor",sun:"sun*",swans:"swan",sweet:"sweet",tall:"brant-",tears:"tears",thought:"thought*",tin:"-tin",tiny:"littel*",tomorrow:"morrow",tower:"tower-",treasure:"prize*",tyranny:"m\xe1nbealu",valley:"d\xe6l",veil:"veil",water:"water",wax:"wax",white:"albe",wide:"wide",willow:"willow",wind:"wind",wine:"wine",winter:"winter",holly:"holen-",garden:"garden",queen:"queen",prince:"prince",princess:"princess",cloud:"cloud",hounds:"hund",wolves:"wulf",embers:"ysl",soot:"soot",ash:"ash",salt:"salt",void:"space",steam:"st\u0113am",magma:"lava",radiance:"gl\xe6m","-less":"no-","ever-":"even-","at-":"upon-","-person":"-person","-man":"-man","-son":"-ing","-woman":"-wiman","-maid":"-m\xe6den","-daughter":"-dohtor","mountain-chain":"beorgstede"}),ut=function(){var e,t=K("A Social Group"),n="male"===M(["male","female"])?["-person","-man","-son"]:["-woman","-maid","-daughter"],r=P(x(1,2),$e),a=[].concat(Object(Ze.a)(r),Object(Ze.a)(x(0,12)>9?[M(n)]:[])),i=(e=M([ct,rt,lt])).translate.apply(e,Object(Ze.a)(a)).trim(),o=r.map((function(e){return Xe(e)})).reverse().join("-").trim();return Y(i===o?i:i+" ("+o+")",t)},ht=new(Ue=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e;return Object(l.a)(this,n),(e=t.call(this,"Citizen")).subject=ut(),e.notes={"current date":function(){return e.date.description},name:function(){return e.subject.name},agility:function(){return e.subject.body.agility},beauty:function(){return e.subject.soul.beauty},charm:function(){return e.subject.soul.charm},cunning:function(){return e.subject.body.cunning},depth:function(){return e.subject.mind.depth},education:function(){return e.subject.mind.education},empathy:function(){return e.subject.soul.empathy},guile:function(){return e.subject.body.guile},insight:function(){return e.subject.mind.insight},integrity:function(){return e.subject.soul.integrity},knowledge:function(){return e.subject.kind.knowledge},power:function(){return e.subject.kind.power},personality:function(){return e.subject.mind.personality},resolve:function(){return e.subject.soul.resolve},sophistication:function(){return e.subject.kind.sophistication},spirit:function(){return e.subject.body.spirit},strength:function(){return e.subject.body.strength},tech:function(){return e.subject.kind.tech},valor:function(){return e.subject.mind.valor},wealth:function(){return e.subject.kind.wealth},wit:function(){return e.subject.soul.wit}},e.actions.create({name:"New",act:function(){e.subject=ut()}}),e.evolve(e.evolution),e}return Object(u.a)(n,[{key:"evolution",value:function(){}},{key:"describeMemory",value:function(e){return"I remember ".concat(e.description)}},{key:"date",get:function(){var e=this.ticks||0,t=Math.floor(e/.1),n=t%60,r=Math.floor(t/60)%60,a=Math.floor(t/3600)%24,i=["Sun","Moon","Mars","Mercury","Jupiter","Venus","Saturn"][Math.floor(t/86400)%7];return{dayOfWeek:i,description:"".concat(i," ").concat(String(a).padStart(2,"0"),":").concat(String(r).padStart(2,"0"),":").concat(String(n).padStart(2,"0"))}}}]),n}(fe),Object(v.a)(Ue.prototype,"evolution",[y.a],Object.getOwnPropertyDescriptor(Ue.prototype,"evolution"),Ue.prototype),Ue),dt=function(e,t){return e.filter(t)[0]},ft=function(){function e(t,n){var r=this;Object(l.a)(this,e),this.width=t,this.height=n,this.tiles=[],this.write=function(e,t,n){var a=t,i=n;r.tiles[i]=r.tiles[i]||[],r.tiles[i][a]=e},this.drawBox=function(e,t,n,a,i,o){for(var s=t+a,c=n+i,l=t;l<=s;l++)for(var u=n;u<=c;u++)(l===t||u===n||l===s||u===c||o)&&r.write(e,l,u)}}return Object(u.a)(e,[{key:"view",value:function(){for(var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{overlays:[]},n=t.overlays,r=[],a=function(t){for(var a=function(a){r[a]=r[a]||[];var i=n.length>0&&dt(n,(function(e){var n=e.at(t,a);return""!==n&&void 0!==n}));r[a][t]=i&&i.at(t,a)||e.at(t,a)||"_"},i=0;i<=e.height;i++)a(i)},i=0;i<=this.width;i++)a(i);return r}},{key:"erase",value:function(e,t){this.tiles[t]=this.tiles[t]||[],this.tiles[t][e]=""}},{key:"at",value:function(e,t){var n=e%this.width,r=t%this.height;if(this.tiles[r])return this.tiles[r][n]}},{key:"each",value:function(e){for(var t=0;t<=this.width;t++)for(var n=0;n<=this.height;n++)e(t,n,this.at(t,n)||"")}},{key:"neighbors",value:function(t,n){var r=this;return e.neighborPositions(t,n).map((function(e){var t=Object(w.a)(e,2),n=t[0],a=t[1];return r.at(n,a)||""}))}},{key:"step",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=[];this.tiles=this.tiles||[];for(var a=function(e,r){return t.at(e,r)||n},i=0;i<=this.width;i++)for(var o=0;o<=this.height;o++){var s=a(i,o);if(void 0!==s){var c=this.neighbors(i,o),l=e(s,c,[i,o]);r[o]=r[o]||[],r[o][i]=l}}return this.tiles=r,r}}],[{key:"neighborPositions",value:function(e,t){return[[e-1,t-1],[e,t-1],[e+1,t-1],[e-1,t],[e+1,t],[e-1,t+1],[e,t+1],[e+1,t+1]]}}]),e}(),pt=new(Qe=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e;return Object(l.a)(this,n),(e=t.call(this,"Perfect Blue Buildings")).width=80,e.height=36,e.board=new ft(e.width,e.height),e.evolve(e.evolution),e}return Object(u.a)(n,[{key:"tiles",get:function(){return this.board.view()}},{key:"building",value:function(){var e=x(2,8),t=x(2,3);this.board.drawBox("#",x(1,this.width-e-1),x(1,this.height-t-1),e,t)}},{key:"evolution",value:function(){this.building()}}]),n}(ae),Object(v.a)(Qe.prototype,"evolution",[y.a],Object.getOwnPropertyDescriptor(Qe.prototype,"evolution"),Qe.prototype),Qe),gt=n(15),mt=function(e,t,n){return Math.min(Math.max(e,t),n)},vt=function(e,t){var n=Math.abs(e[0]-t[0]),r=Math.abs(e[1]-t[1]);return Math.sqrt(n*n+r*r)},yt=function(){function e(t,n){var r=this;Object(l.a)(this,e),this.width=t,this.height=n,this.map=new ft(this.width,this.height),this.seaLevel=5,this.smooth=function(){r.apply((function(e,t,n){var a=t.filter((function(e){return e>=r.seaLevel})).length;return a>=5&&e<r.seaLevel?[e+1]:a<4&&e>=r.seaLevel?[e-1]:e<n-1?[e,e+1,Math.floor((e+n)/2)]:e>n+1?[e,e-1,Math.floor((e+n)/2)]:[e]}))},this.flow=function(){r.apply((function(e,t,n){if(e>=n)return[e];var a=[t[1],t[3],t[5],t[7]],i=Math.max.apply(Math,a),o=t.filter((function(e){return e>=r.seaLevel})).length;return o>=7&&e<r.seaLevel?[r.seaLevel,r.seaLevel+1]:0===o?[e,e+1,e+2]:[i,i-1]}))},this.erode=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;r.apply((function(e,t,n){return e<n?[e]:[e,Math.min.apply(Math,Object(Ze.a)(t))]}),e)},this.extrude=function(e){e.forEach((function(e){var t,n,a=parseInt((t=r.map).at.apply(t,Object(Ze.a)(e))||"0",10),i=mt(a+x(-1,7),0,9);e&&(n=r.map).write.apply(n,[String(i)].concat(Object(Ze.a)(e)))}))},this.intrude=function(e){e.forEach((function(e){var t,n,a=parseInt((t=r.map).at.apply(t,Object(Ze.a)(e))||"9",10),i=mt(a-x(-1,7),0,9);e&&(n=r.map).write.apply(n,[String(i)].concat(Object(Ze.a)(e)))}))},this.bombard=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=x(1,4+x(0,e)),n=[x(1,r.width-1),x(1,r.height-1)],a=function(e){return vt(e,n)},i=[],o=[],s=0;s<r.width;s++)for(var c=0;c<r.height;c++){var l=Math.round(a([s,c]));Math.abs(l-t)<1?o.push([s,c]):l<t&&i.push([s,c])}r.intrude(i),r.extrude(o)},this.orogeny=function(e){x(0,100)<16&&r.extrude(e),E(4,r.flow)},this.geoform=function(e,t){var n=x(0,100);e?(r.orogeny(t),r.erode(),n<32&&r.bombard(36)):(r.smooth(),n<16&&E(2,(function(){return r.bombard(7)})),r.flow())},this.componentNames=new D,this.regions=function(){return r.components((function(e){return e>=r.seaLevel}))},this.waterways=function(){return r.components((function(e){return e<r.seaLevel}))},this.ranges=function(){return r.components((function(e){return e>=8}))},this.valleys=function(){var e=r.seaLevel;return r.components((function(t,n){return(t===e||t===e+1||t===e+2)&&n.reduce((function(e,t){return e+t}),0)/n.length>=e}))},this.bays=function(){return r.components((function(e){return 4===e||3===e}))}}return Object(u.a)(e,[{key:"at",value:function(e,t){return parseInt(this.map.at(e,t)||"0",10)}},{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;this.map.step((function(n,r,a){if(x(0,1e3)<=t){var i=parseInt(n||"0",10),o=r.map((function(e){return parseInt(e||"0",10)})),s=o.reduce((function(e,t){return e+t}),0),c=Math.floor((s+i)/(r.length+1)),l=e(i,o,c,a),u=mt(M(l),0,9);return String(u)}return n}))}},{key:"components",value:function(e){var t=this,n={};return this.map.each((function(r,a,i){var o=t.map.neighbors(r,a).map((function(e){return parseInt(e,10)}));if(e(parseInt(i,10),o)){var s=Object.keys(n).filter((function(e){return function(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return!0;return!1}(n[e],(function(e){var t=Object(w.a)(e,2),n=t[0],i=t[1];return vt([r,a],[n,i])<=Math.sqrt(2)}))}));if(s.length>0){var c=s[0];n[c].push([r,a]),s.length>1&&s.forEach((function(e){e!==c&&(n[c]=[].concat(Object(Ze.a)(n[c]),Object(Ze.a)(n[e])),delete n[e])}))}else{var l=t.componentNames.next;n[l]=[[r,a]]}}})),n}}]),e}(),bt=function(){function e(){Object(l.a)(this,e),this.waterwayNames={},this.regionNames={},this.rangeNames={},this.valleyNames={},this.bayNames={}}return Object(u.a)(e,[{key:"nameWaterway",value:function(t,n){return void 0===this.waterwayNames[t]&&(this.waterwayNames[t]=e.names.waterways.next),this.waterwayNames[t]}},{key:"nameRegion",value:function(t,n){return void 0===this.regionNames[t]&&(this.regionNames[t]=M([e.names.regions,e.names.places]).next),this.regionNames[t]}},{key:"nameRange",value:function(t,n){return void 0===this.rangeNames[t]&&(this.rangeNames[t]=M([e.names.ranges,e.names.mountains]).next),this.rangeNames[t]}},{key:"nameValley",value:function(t,n){return void 0===this.valleyNames[t]&&(this.valleyNames[t]=e.names.valleys.next),this.valleyNames[t]}},{key:"nameBay",value:function(t,n){return void 0===this.bayNames[t]&&(this.bayNames[t]=e.names.bays.next),this.bayNames[t]}}]),e}();bt.names={places:new tt(ct,!0,"land"),regions:new tt(ct,!1,"isle"),waterways:new tt(ct,!1,"sea","lake","water","pool"),ranges:new tt(ct,!0,"mountain-chain"),mountains:new tt(ct,!1,"mountain"),valleys:new tt(ct,!1,"valley"),bays:new tt(ct,!1,"bay")};var jt=function(){function e(t){Object(l.a)(this,e),this.world=t,this.linguist=new bt,this._waterways={},this._regions={},this._ranges={},this._valleys={},this._bays={}}return Object(u.a)(e,[{key:"reset",value:function(){this._regions={},this._waterways={},this._ranges={},this._valleys={},this._bays={}}},{key:"regions",get:function(){return 0===Object.keys(this._regions).length&&(this._regions=this.world.elevation.regions()),this._regions}},{key:"identifyRegion",value:function(e,t){var n=this,r=Object.keys(this.regions).find((function(r){return n.regions[r].find((function(n){var r=Object(w.a)(n,2),a=r[0],i=r[1];return e===a&&t===i}))}))||null;if(r){var a=this.regions[r].length;return this.linguist.nameRegion(r,a)}}},{key:"waterways",get:function(){return 0===Object.keys(this._waterways).length&&(this._waterways=this.world.elevation.waterways()),this._waterways}},{key:"identifyWaterway",value:function(e,t){var n=this,r=Object.keys(this.waterways).find((function(r){return n.waterways[r].find((function(n){var r=Object(w.a)(n,2),a=r[0],i=r[1];return e===a&&t===i}))}))||null;if(r){var a=this.waterways[r].length;return this.linguist.nameWaterway(r,a)}}},{key:"identifyRegionOrWaterway",value:function(e,t){return this.identifyRegion(e,t)||this.identifyWaterway(e,t)||"(err: unknown region/waterway)"}},{key:"ranges",get:function(){return 0===Object.keys(this._ranges).length&&(this._ranges=this.world.elevation.ranges()),this._ranges}},{key:"identifyRange",value:function(e,t){var n=this,r=Object.keys(this.ranges).find((function(r){return n.ranges[r].find((function(n){var r=Object(w.a)(n,2),a=r[0],i=r[1];return e===a&&t===i}))}))||null;if(r){var a=this.ranges[r].length;return this.linguist.nameRange(r,a)}}},{key:"valleys",get:function(){return 0===Object.keys(this._valleys).length&&(this._valleys=this.world.elevation.valleys()),this._valleys}},{key:"identifyValley",value:function(e,t){var n=this,r=Object.keys(this.valleys).find((function(r){return n.valleys[r].find((function(n){var r=Object(w.a)(n,2),a=r[0],i=r[1];return e===a&&t===i}))}))||null;if(r){var a=this.valleys[r].length;return this.linguist.nameValley(r,a)}}},{key:"bays",get:function(){return 0===Object.keys(this._bays).length&&(this._bays=this.world.elevation.bays(),console.log("Found bays",this._bays)),this._bays}},{key:"identifyBay",value:function(e,t){var n=this,r=Object.keys(this.bays).find((function(r){return n.bays[r].find((function(n){var r=Object(w.a)(n,2),a=r[0],i=r[1];return e===a&&t===i}))}))||null;if(r){var a=this.bays[r].length;return this.linguist.nameBay(r,a)}}},{key:"identifyFeatures",value:function(e,t){return"Hadean"===this.world.aeon||"Archean"===this.world.aeon?"(Cartography requires calmer aeon...)":this.identifyRange(e,t)||this.identifyValley(e,t)||this.identifyBay(e,t)||""}}]),e}(),wt=(Je=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e;return Object(l.a)(this,n),(e=t.call(this,"Overworld")).notes={aeon:function(){return e.aeon}},e.width=90,e.height=25,e.mapgenTicks=40,e.elevation=new yt(e.width,e.height),e.terrain=new ft(e.width,e.height),e.mountainSpots=[],e.areaPercent=Math.floor(e.area/100),e.cartographer=new jt(Object(gt.a)(e)),e.tileColors={".":"lightgreen","~":"midnightblue",",":"navy","'":"darkgreen",0:"black",1:"black",2:"navy",3:"midnightblue",4:"deepskyblue",5:"moccasin",6:"forestgreen",7:"darkgreen",8:"darkslategray",9:"gray"},e.evolve(e.evolution),e.actions.create({name:"Geoform",act:function(){e.ticks=0,e.cartographer.reset()}}),e}return Object(u.a)(n,[{key:"aeon",get:function(){var e="Hadean";return this.ticks>=this.mapgenTicks/2&&(e="Archean"),this.ticks>this.mapgenTicks&&(e="Proterozoic"),e}},{key:"tiles",get:function(){return this.elevation.map.view({overlays:[]})}},{key:"tileInspect",value:function(e,t){var n=this.elevation.at(e,t)||0,r=Math.round(3600*(n-4)/5280),a=0===r?"At sea level":"".concat(Math.abs(r)," li ").concat(r>=0?"above":"below"," sea level");if("Hadean"===this.aeon||"Archean"===this.aeon)return a;var i=this.cartographer.identifyRegionOrWaterway(e,t);return[this.cartographer.identifyFeatures(e,t),i,a].filter(Boolean).join(" / ")}},{key:"randomPosition",value:function(){return[x(0,this.width),x(0,this.height)]}},{key:"randomPositionAlongLine",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,r=Object(w.a)(e,2),a=r[0],i=r[1],o=Object(w.a)(t,2),s=o[0],c=o[1],l=[Math.abs(a-s),Math.abs(i-c)],u=l[0],h=l[1];if(0===u){var d=x(0,this.height);return[a,d]}if(0===h){var f=x(0,this.width);return[f,i]}var p=h/u,g=-(p*a-i),m=Math.floor(x(0,this.width)),v=Math.floor(p*m+g),y=n||1;return[m+x(-y,y),v+x(-y,y)]}},{key:"genHeightmap",value:function(e){var t=this;if(0===this.mountainSpots.length){var n=Math.floor(10*this.areaPercent),r=[this.randomPosition(),this.randomPosition()],a=r[0],i=r[1],o=I((function(){return t.randomPositionAlongLine(a,i)}),n,!1);this.mountainSpots=o}this.elevation.geoform("Hadean"===this.aeon,this.mountainSpots)}},{key:"buildTerrain",value:function(){var e=this;this.terrain.each((function(t,n,r){var a=parseInt(e.elevation.map.at(t,n)||"0");a>=9?e.terrain.write("^",t,n):a<=4?e.terrain.write(M(["~",","]),t,n):e.terrain.write(".",t,n)}))}},{key:"area",get:function(){return this.width*this.height}},{key:"evolution",value:function(e,t){e.resources;t>0&&(t%100===0&&console.log("The world is "+t/100+" million years old"),t<=this.mapgenTicks&&this.genHeightmap(t))}}]),n}(ae),Object(v.a)(Je.prototype,"tileInspect",[y.a],Object.getOwnPropertyDescriptor(Je.prototype,"tileInspect"),Je.prototype),Object(v.a)(Je.prototype,"randomPosition",[y.a],Object.getOwnPropertyDescriptor(Je.prototype,"randomPosition"),Je.prototype),Object(v.a)(Je.prototype,"randomPositionAlongLine",[y.a],Object.getOwnPropertyDescriptor(Je.prototype,"randomPositionAlongLine"),Je.prototype),Object(v.a)(Je.prototype,"evolution",[y.a],Object.getOwnPropertyDescriptor(Je.prototype,"evolution"),Je.prototype),Je),kt=new wt,Ot=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,"Language Explorer")).dictionary=e,r.t=function(){var e;return(e=r.dictionary).translate.apply(e,arguments)},r.notes={'"Nightingale"':function(){return r.t("spark","-maid")},"Lonely Isle":function(){return r.t("isle","lonely")},"Haven of the Gods":function(){return r.t("at-","divine")},"Swan Haven":function(){return r.t("swans","haven")},"Star-Eagle":function(){return r.t("eagles","stars")},"Land of Pines":function(){return r.t("land","pine")},"Mound of Summer":function(){return r.t("mound","summer")},"Mountains of Tyranny":function(){return r.t("tyranny","mountain-chain")},"Magic Woman":function(){return r.t("magic","-woman")},"Fire Stronghold":function(){return r.t("fire","stronghold")},"Grey-Mantle":function(){return r.t("gray","mantle")},"Iron Prison":function(){return r.t("iron","prison")},"Icy Fangs":function(){return r.t("ice","fangs")},"Pale-horn Mountains":function(){return r.t("mountain","pale","horns")},"Silver River":function(){return r.t("silver","river")},"Ever-White":function(){return r.t("ever-","snow")},"Tall White Point":function(){return r.t("tall","white","point")},"Mist-Needle":function(){return r.t("mist","needle")},"Mist-Shadow":function(){return r.t("mist","shadow")},"Dark Foe":function(){return r.t("black","foe")},"Spirit of Fire":function(){return r.t("spirit","fire")},Shipmaker:function(){return r.t("ship","smith")},"Land of Holly":function(){return r.t("holly","land")},"--":function(){return"..."},"Pathless Sea":function(){return r.t("-less","path","sea")},"Star-Music":function(){return r.t("stars","music")},"Hills of Evendim":function(){return r.t("hill","evening")},"Mere of Shadows":function(){return r.t("pool","shadow")},"Vale of Nightingales":function(){return r.t("valley","nightingales")},"Dewy Region":function(){return r.t("dew","region")},"Star Hill":function(){return r.t("hill","stars")},"Golden Hill":function(){return r.t("hill","golden")},"Gold Mountain":function(){return r.t("mountain","gold")},"Elephant Hill":function(){return r.t("hill","elephants")},"Silent Land":function(){return r.t("land","silence")},"Star Bay":function(){return r.t("bay","stars")},"Bell-Star":function(){return r.t("bell","stars")},Saturday:function(){return r.t("day","stars")},Dragon:function(){return r.t("dragons")},Giant:function(){return r.t("giant")}},r.actions.create({name:"Westron",act:function(){return r.dictionary=lt}}),r.actions.create({name:"Sindarin",act:function(){return r.dictionary=ct}}),r.actions.create({name:"Khuzdul",act:function(){return r.dictionary=rt}}),r}return n}(ae),xt=[new Ot(rt),kt,pt,He,Ke,we,ht];var Et=function(e){var t=e.model;return Object(oe.jsx)("div",{className:"App",children:Object(oe.jsx)(be,{models:xt,initialModel:t})})};o.a.render(Object(oe.jsx)(a.a.StrictMode,{children:Object(oe.jsx)(Et,{model:xt[0]})}),document.getElementById("root"))}},[[36,1,2]]]);
//# sourceMappingURL=main.40bddcd2.chunk.js.map