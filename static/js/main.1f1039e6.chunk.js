(this.webpackJsonpeco=this.webpackJsonpeco||[]).push([[0],{48:function(e,t,n){},49:function(e,t,n){},60:function(e,t,n){},61:function(e,t,n){"use strict";n.r(t);var r=n(8),a=n.n(r),i=n(38),o=n.n(i),s=(n(48),n(49),n(39)),c=n.n(s),l=(n(51),n(0)),u=n(1),h=n(7),d=n(6),f=n(2),m=n(3),g=n(10),p=n(19),y=n(16),v=n(17);function b(e,t){return function(n){return n[e]===t}}function j(e){return"string"===typeof e||e instanceof String}var w=n(9),k=function(){function e(t,n,r){Object(l.a)(this,e),this.idFor=t,this.nameFor=n,this.lookup=r,this._data={}}return Object(u.a)(e,[{key:"set",value:function(e,t){this._data[this.idFor(e)]=t}},{key:"get",value:function(e){return this._data[this.idFor(e)]}},{key:"report",get:function(){var e=this,t=Object.entries(this._data).map((function(t){var n=Object(w.a)(t,2),r=n[0],a=n[1];return[e.nameFor(e.lookup(Number(r))),a]}));return Object.fromEntries(t)}}]),e}(),O=function(){function e(){Object(l.a)(this,e),this.items=[]}return Object(u.a)(e,[{key:"it",get:function(){return this.items}},{key:"first",get:function(){return this.items[0]}},{key:"last",get:function(){return this.items[this.count-1]}},{key:"count",get:function(){return this.items.length}},{key:"add",value:function(e){this.items.push(e)}},{key:"remove",value:function(e){this.items=this.items.filter((function(t){return t!==e}))}},{key:"each",value:function(e){this.items.forEach(e)}},{key:"clear",value:function(){this.items=[]}},{key:"map",value:function(e){return this.items.map(e)}},{key:"sample",get:function(){throw new Error("Method not implemented.")}}]),e}();function x(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function M(e){return e[x(0,e.length-1)]}function S(e,t){return function(e,t){for(var n=[],r=0;r<e;r++)n.push(t());return n}(e,(function(){return M(t)}))}var E,A=function(){function e(t,n){Object(l.a)(this,e),this.n=t,this.max=n,this.ngrams={},this.beginnings=[]}return Object(u.a)(e,[{key:"feed",value:function(e){if(e.length<this.n)return!1;var t=e.substring(0,this.n);this.beginnings.push(t);for(var n=0;n<e.length-this.n;n++){var r=e.substring(n,n+this.n),a=e.charAt(n+this.n);this.ngrams.hasOwnProperty(r)||(this.ngrams[r]=[]),this.ngrams[r].push(a)}}},{key:"generate",value:function(){for(var e=M(this.beginnings),t=e,n=0;n<this.max&&this.ngrams.hasOwnProperty(e);n++){e=(t+=M(this.ngrams[e])).substring(t.length-this.n,t.length)}return t.trim()}}]),e}();function P(e,t,n){var r=Array.apply(null,new Array(t));return r=r.map(e),n?[].concat.apply([],r):r}var I,N,C,F=function(){function e(){Object(l.a)(this,e),this.count=0}return Object(u.a)(e,[{key:"next",get:function(){return this.count++}}]),e}(),T=function(){function e(){Object(l.a)(this,e),this.nameRoots=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],this.nameCount=new F}return Object(u.a)(e,[{key:"next",get:function(){var e=this.nameCount.next;return this.nameRoots[e%this.nameRoots.length]+function(e,t){return P((function(){return e}),t)}(["'"],e).join("")}}]),e}(),D=function(){function e(){Object(l.a)(this,e),this.baseItems=[],this.generatedItems=[]}return Object(u.a)(e,[{key:"next",get:function(){for(var e=this.generate(),t=0;(this.baseItems.includes(e)||this.generatedItems.includes(e))&&t++<100;)e=this.generate();return this.generatedItems.push(e),e}}]),e}(),z=(E=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return Object(l.a)(this,n),(r=t.call(this)).items=e,r.generator=void 0,r.generator=new A(a,i),r.items.forEach(r.feed),r}return Object(u.a)(n,[{key:"feed",value:function(e){this.baseItems.push(e),this.generator.feed(e)}},{key:"generate",value:function(){return this.generator.generate()}}]),n}(D),Object(y.a)(E.prototype,"feed",[v.a],Object.getOwnPropertyDescriptor(E.prototype,"feed"),E.prototype),["name"]),q=function(){function e(t,n){Object(l.a)(this,e),this.stocks=t,this.stockId=n}return Object(u.a)(e,[{key:"add",value:function(e){return this.stocks.add(e,this.name)}},{key:"remove",value:function(e){return this.stocks.remove(e,this.name)}},{key:"list",get:function(){return this.stocks.list()}},{key:"count",get:function(){return this.stocks.count(this.name)}},{key:"name",get:function(){return this.item.name}},{key:"item",get:function(){return this.stocks.lookupById(this.stockId)}}]),e}(),B=(I=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Object(l.a)(this,e),this.name=t,this.elements=n,this.ids=new F,this.storage={}}return Object(u.a)(e,[{key:"list",value:function(){return this.elements}},{key:"_store",get:function(){return this.storage}},{key:"clear",value:function(){this.elements=[],this.storage={}}},{key:"create",value:function(e){var t=null,n={};if(j(e))t=e,n.name=t;else{var r=e;t=r.name,n=Object(p.a)(r,z)}if(j(t)&&this.has(t))return this.manage(t);if(!j(t))throw new Error("Name must be a string");var a=this.ids.next,i=Object(g.a)({id:a,name:t},n);return this.list().push(i),this.manage(t)}},{key:"add",value:function(e,t){this.setAmount(t,this.count(t)+e)}},{key:"remove",value:function(e,t){var n=this.count(t)-e;this.setAmount(t,n)}},{key:"zero",value:function(e){this.setAmount(e,0)}},{key:"delete",value:function(e){this.elements=this.elements.filter((function(t){return t.name!==e}))}},{key:"count",value:function(e){var t=this.lookup(e);return this.storage[t.id]||0}},{key:"has",value:function(e){return!!this.elements.find(b("name",e))}},{key:"lookupById",value:function(e){var t=this.elements.find(b("id",e));if(t)return t;throw new Error("No such ".concat(this.name," with id ").concat(e))}},{key:"lookup",value:function(e){var t=this.elements.find(b("name",e));return t||this.create(e).item}},{key:"report",get:function(){var e=this;return this.list().flatMap((function(t){var n=Number(t.id),r=e.storage[n]||0;return Object(g.a)(Object(g.a)({},t),{},{amount:r})}))}},{key:"manage",value:function(e){return new q(this,this.lookup(e).id)}},{key:"manageAll",value:function(){var e=this;return{add:this.add,remove:this.remove,count:this.count,list:function(){return e.elements}}}},{key:"manager",get:function(){return this.manageAll()}},{key:"setAmount",value:function(e,t){var n=this.lookup(e);this.storage[n.id]=t}}]),e}(),Object(y.a)(I.prototype,"list",[v.a],Object.getOwnPropertyDescriptor(I.prototype,"list"),I.prototype),Object(y.a)(I.prototype,"create",[v.a],Object.getOwnPropertyDescriptor(I.prototype,"create"),I.prototype),Object(y.a)(I.prototype,"add",[v.a],Object.getOwnPropertyDescriptor(I.prototype,"add"),I.prototype),Object(y.a)(I.prototype,"remove",[v.a],Object.getOwnPropertyDescriptor(I.prototype,"remove"),I.prototype),Object(y.a)(I.prototype,"zero",[v.a],Object.getOwnPropertyDescriptor(I.prototype,"zero"),I.prototype),Object(y.a)(I.prototype,"delete",[v.a],Object.getOwnPropertyDescriptor(I.prototype,"delete"),I.prototype),Object(y.a)(I.prototype,"count",[v.a],Object.getOwnPropertyDescriptor(I.prototype,"count"),I.prototype),Object(y.a)(I.prototype,"lookupById",[v.a],Object.getOwnPropertyDescriptor(I.prototype,"lookupById"),I.prototype),I),W=(N=function(){function e(t,n){Object(l.a)(this,e),this.name=t,this.popCtor=n,this.populations={},this.species={}}return Object(u.a)(e,[{key:"clear",value:function(){this.populations={}}},{key:"lookup",value:function(e){if(this.has(e))return this.populations[e];throw new Error("No such ".concat(this.name," '").concat(e,"'"))}},{key:"lookupById",value:function(e){var t=Object.values(this.species).find((function(t){return t.id===e}));if(t)return t;throw new Error("No such ".concat(this.name," '").concat(e,"'"))}},{key:"has",value:function(e){return this.populations.hasOwnProperty(e)}},{key:"count",value:function(e){return this.lookup(e).count}},{key:"list",value:function(){return Object.values(this.species)}},{key:"listByName",value:function(e){return this.lookup(e).list()}},{key:"create",value:function(e,t){if(this.has(e))return this.lookup(e);var n=Object(g.a)(Object(g.a)({},t),{},{name:e,id:this.list().length+1}),r=new this.popCtor(e,n);return this.populations[e]=r,this.species[e]=n,r}},{key:"populationList",get:function(){return Object.values(this.populations)}},{key:"report",get:function(){return this.populationList.flatMap((function(e){var t=e;return t.count>0?{name:t.name,amount:t.count}:[]}))}},{key:"add",value:function(e,t){this.lookup(t).add(e)}},{key:"remove",value:function(e,t){this.lookup(t).remove(e)}},{key:"manageAll",value:function(){return{add:this.add,remove:this.remove,count:this.count,list:this.list}}},{key:"manager",get:function(){return this.manageAll()}}]),e}(),Object(y.a)(N.prototype,"lookup",[v.a],Object.getOwnPropertyDescriptor(N.prototype,"lookup"),N.prototype),Object(y.a)(N.prototype,"lookupById",[v.a],Object.getOwnPropertyDescriptor(N.prototype,"lookupById"),N.prototype),Object(y.a)(N.prototype,"count",[v.a],Object.getOwnPropertyDescriptor(N.prototype,"count"),N.prototype),Object(y.a)(N.prototype,"list",[v.a],Object.getOwnPropertyDescriptor(N.prototype,"list"),N.prototype),Object(y.a)(N.prototype,"create",[v.a],Object.getOwnPropertyDescriptor(N.prototype,"create"),N.prototype),Object(y.a)(N.prototype,"add",[v.a],Object.getOwnPropertyDescriptor(N.prototype,"add"),N.prototype),Object(y.a)(N.prototype,"remove",[v.a],Object.getOwnPropertyDescriptor(N.prototype,"remove"),N.prototype),N),_=function(){function e(t,n){Object(l.a)(this,e),this.model=t,this.getStocks=n,this.changes=void 0;var r=this.getStocks(t);this.changes=new B("".concat(r.name," (delta)"),r.list())}return Object(u.a)(e,[{key:"storage",get:function(){return this.changes._store}}]),e}(),L=function(){function e(t){Object(l.a)(this,e),this.name=t,this.ticks=0,this.tracking=[],this.dynamics=new O}return Object(u.a)(e,[{key:"evolve",value:function(e){this.dynamics.add(e)}},{key:"step",value:function(){return this.flux(this.ticks++)}},{key:"report",get:function(){var e=this;return Object.fromEntries(this.tracking.map((function(t){return[t,e[t].report]})))}},{key:"flow",value:function(e){var t=this[e],n=new _(this,(function(t){return t[e]})),r=n.changes.manager,a=r.add,i=r.remove,o=t.list,s=t.count;return{lookupById:t.lookupById,_delta:n,add:a,remove:i,list:o,count:s}}},{key:"flows",value:function(){var e=this,t={};return this.tracking.forEach((function(n){return t[n]=e.flow(n)})),t}},{key:"flowsReport",value:function(e){var t={};return Object.entries(e).forEach((function(e){var n=Object(w.a)(e,2),r=n[0],a=n[1],i=a._delta;t[r]=Object.fromEntries(Object.entries(i.storage).map((function(e){var t=Object(w.a)(e,2),n=t[0],r=t[1];return[a.lookupById(Number(n)).name,r]})))})),t}},{key:"flux",value:function(e){var t=this,n=this.flows();return this.dynamics.each((function(t){return t(n,e)})),Object.entries(n).forEach((function(e){var n=Object(w.a)(e,2),r=n[0],a=n[1]._delta;t.apply(a,r)})),{changed:this.flowsReport(n)}}},{key:"apply",value:function(e,t){var n=this[t].manager,r=n.list(),a=e.storage,i={};return r.forEach((function(e){if(a[e.id]){var t=a[e.id];n.add(t,e.name),i[e.name]=t}})),{changed:i}}}]),e}(),H=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(l.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).ids=new F,e}return Object(u.a)(n,[{key:"list",value:function(){return this.items}},{key:"names",get:function(){return this.items.map((function(e){return e.name}))}},{key:"create",value:function(e){var t=this.ids.next,n=Object(g.a)({id:t},e);return this.items.push(n),n}},{key:"lookup",value:function(e){return this.items.find((function(t){return t.name===e}))}}]),n}(O),J=["name"],R=function(){function e(){Object(l.a)(this,e)}return Object(u.a)(e,null,[{key:"first",value:function(e){return e.values().next().value}}]),e}(),U=new F,G=(C=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;Object(l.a)(this,e),this.name=t,this.species=n,this.individuals=r,this.id=U.next,this.ids=new F}return Object(u.a)(e,[{key:"list",value:function(){var e=[];return this.individuals.forEach((function(t){return e.push(t)})),e}},{key:"count",get:function(){return this.individuals.size}},{key:"first",get:function(){return R.first(this.individuals)}},{key:"lookup",value:function(e){var t=null;if(this.individuals.forEach((function(n){n.name===e&&(t=n)})),t)return t;throw new Error("Could not find individual with name '".concat(e,"' in the population of ").concat(this.name))}},{key:"lookupById",value:function(e){var t=null;if(this.individuals.forEach((function(n){n.id===e&&(t=n)})),t)return t;throw new Error("Could not find individual with id ".concat(e," in the population of ").concat(this.name))}},{key:"birth",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"".concat(this.name," ").concat(this.count),t=this.create(e);return t}},{key:"death",value:function(e){if(e){var t=this.destroy(e);if(t)return t}else{var n=this.first;if(n)return this.destroy(n.name),n}throw new Error("Population already empty!")}},{key:"add",value:function(e){for(var t=[],n=0;n<e;n++)t.push(this.birth());return t}},{key:"remove",value:function(e){for(var t=[],n=0;n<Math.min(this.count,e);n++)t.push(this.death(this.first.name));return t}},{key:"build",value:function(e){var t=null,n={};if(j(e))t=e,n.name=t;else{var r=e;t=r.name,n=Object(p.a)(r,J)}var a=this.ids.next;return Object(g.a)({id:a,name:t},n)}},{key:"create",value:function(e){var t=this.build(e);return this.individuals.add(t),t}},{key:"destroy",value:function(e){var t=this.lookup(e);return this.individuals.delete(t),t}},{key:"report",get:function(){return Object.fromEntries(this.list().map((function(e){return[e.id,e.name]})))}}]),e}(),Object(y.a)(C.prototype,"lookupById",[v.a],Object.getOwnPropertyDescriptor(C.prototype,"lookupById"),C.prototype),Object(y.a)(C.prototype,"death",[v.a],Object.getOwnPropertyDescriptor(C.prototype,"death"),C.prototype),Object(y.a)(C.prototype,"create",[v.a],Object.getOwnPropertyDescriptor(C.prototype,"create"),C.prototype),Object(y.a)(C.prototype,"destroy",[v.a],Object.getOwnPropertyDescriptor(C.prototype,"destroy"),C.prototype),C);function V(e){var t=x(0,100);return t>98?e[3]:t<2?e[0]:M([e[1],e[2]])}var K,X=new F,Y=function(e,t){return{id:X.next,name:e,kind:t,age:0,guile:V(["transparent","convincing","beguiling","insidious"]),health:V(["dying","unwell","flourishing","triumphant"]),spirit:V(["languorous","vigorous","impetuous","ferocious"]),cunning:V(["foolish","sly","crafty","manipulative"]),agility:V(["clumsy","nimble","spry","balletic"]),strength:V(["weak","robust","mighty","indomitable"])}},Q=new F,Z=function(e){var t=V(["impoverished","well-off","luxuriant","decadent"]),n=V(["unpretentious","savvy","urbane","sleek"]),r=V(["inconsequential","marginal","influential","sovereign"]),a=V(["clueless","well-informed","wise","prescient"]);return{id:Q.next,name:e,wealth:t,sophistication:n,power:r,knowledge:a}},$=function(){return{insight:V(["dense","intuitive","incisive","brilliant"]),depth:V(["superficial","substantial","profound","inscrutable"]),education:V(["unlettered","literate","tutored","well-read"]),disposition:V(["dismal","hopeful","propitious","roseate"]),valor:V(["timid","bold","courageous","fearless"]),presence:V(["bland","magnetic","charismatic","captivating"])}},ee=function(e){var t=V(["grim","droll","sardonic","acerbic"]),n=V(["sadistic","generous","benevolent","selfless"]),r=V(["uncertain","sound","solid","incorruptible"]),a=V(["ugly","fair","radiant","resplendent"]),i=V(["repulsive","inoffensive","affable","likeable"]),o=V(["vacillating","steadfast","intrepid","relentless"]),s=V(["guardian","artisan","rational","idealist"]);e=e||V(["neuter","feminine","masculine","androgynous"]);var c=V(["naive","narrow","contemplative","enlightened"]);return{wit:t,empathy:n,integrity:r,beauty:a,charm:i,resolve:o,temperament:s,gender:e,faith:V(["materialistic","spiritual","devout","militant"]),philosophy:c,demeanor:V(["arrogant","proud","humble","serene"]),justice:V(["arbitrary","severe","harsh","firm"])}},te={physical:{spirit:["languorous","vigorous","impetuous","ferocious"],strength:["weak","robust","mighty","indomitable"],cunning:["foolish","sly","crafty","manipulative"],agility:["clumsy","nimble","spry","balletic"],guile:["transparent","convincing","beguiling","insidious"]},social:{wealth:["impoverished","well-off","luxuriant","decadent"],sophistication:["unpretentious","savvy","urbane","sleek"],power:["inconsequential","marginal","influential","sovereign"],knowledge:["clueless","well-informed","wise","prescient"]},mental:{insight:["dense","intuitive","incisive","brilliant"],depth:["superficial","substantial","profound","inscrutable"],education:["unlettered","literate","tutored","well-read"],disposition:["dismal","hopeful","propitious","roseate"],valor:["timid","bold","courageous","fearless"],presence:["bland","charismatic","captivating","magnetic"]},spiritual:{wit:["grim","droll","sardonic","acerbic"],empathy:["sadistic","generous","benevolent","selfless"],integrity:["uncertain","sound","solid","incorruptible"],beauty:["ugly","fair","radiant","resplendent"],charm:["repulsive","inoffensive","affable","likeable"],resolve:["vacillating","steadfast","intrepid","relentless"],temperament:["guardian","artisan","rational","idealist"],gender:["neuter","feminine","masculine","androgynous"],philosophy:["naive","narrow","contemplative","enlightened"],faith:["materialistic","spiritual","devout","militant"],demeanor:["arrogant","proud","humble","serene"],justice:["arbitrary","severe","harsh","firm"]}},ne=function(e){var t=["terrible","adequate","good","excellent"],n=te,r=null;if(Object.entries(n).forEach((function(n){var a=Object(w.a)(n,2),i=(a[0],a[1]);Object.entries(i).forEach((function(n){var a=Object(w.a)(n,2),i=(a[0],a[1]);i.forEach((function(n){n===e&&(r=t[i.indexOf(n)])}))}))})),null===r)throw new Error("Cannot judge unknown quality "+e);return r},re={idealist:["champion","healer","teacher","counselor"],rational:["inventor","architect","fieldmarshal","mastermind"],artisan:["performer","composer","persuader","crafter"],guardian:["provider","protector","supervisor","inspector"]},ae=new F,ie={id:-1,name:"Human Being",size:"medium"},oe=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new B("".concat(e,"'s Things")),a=new B("".concat(e,"'s Traits")),i=new B("".concat(e,"'s Items")),o=new B("".concat(e,"'s Pets")),s=ee(),c=re[s.temperament];return Object(g.a)({id:ae.next,kind:t,role:M(c),nameConcepts:[],name:e,age:0,body:Y(e,ie),mind:$(),soul:s,currency:0,items:i,things:r.manageAll(),traits:a.manageAll(),pets:o,meters:function(){return{}}},n)},se=(K=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(l.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).moieties=new O,e.obscured=!1,e.recipes=new H,e.jobs=new k((function(e){return e.id}),(function(e){return e.name}),e.lookupById),e.inventories=new k((function(e){return e.id}),(function(e){return e.name}),e.lookupById),e}return Object(u.a)(n,[{key:"report",get:function(){var e=this,t=this.list().map((function(t){var n=e.jobs.get(t);return[t.id,void 0!==n&&void 0!==n.recipe?n.recipe.name:"?"]}));return Object.fromEntries(t)}},{key:"create",value:function(e){var t=Object(h.a)(Object(d.a)(n.prototype),"build",this).call(this,e),r=t.name,a=t.age,i=oe(r,Z("".concat(r,"'s Gens")),e);return i.age=a,this.individuals.add(i),i}},{key:"work",value:function(e){var t=this,n=e.resources,r=this.jobs.report;Object.entries(r).forEach((function(e){var r=Object(w.a)(e,2),a=(r[0],r[1]);a&&a.recipe&&t.produce(a.recipe,n)}))}},{key:"produce",value:function(e,t){this.mayProduce(e,t)&&(e.consumes&&Object.entries(e.consumes).forEach((function(e){var n=Object(w.a)(e,2),r=n[0],a=n[1];t.remove(a,r)})),Object.entries(e.produces||{}).forEach((function(e){var n=Object(w.a)(e,2),r=n[0],a=n[1];t.add(a,r)})))}},{key:"mayProduce",value:function(e,t){var n=!0;return e.consumes&&Object.entries(e.consumes).forEach((function(e){var r=Object(w.a)(e,2),a=r[0],i=r[1];t.count(a)<i&&(n=!1)})),n}}]),n}(G),Object(y.a)(K.prototype,"create",[v.a],Object.getOwnPropertyDescriptor(K.prototype,"create"),K.prototype),K),ce=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(l.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).tracking=["animals","resources"],e.people=new W("people",se),e.resources=new B("resources"),e.machines=new B("machines"),e.animals=new W("wildlife",G),e.metrics={},e.notes={},e.actions=new H,e.policies=new H,e.currentPolicy=void 0,e}return Object(u.a)(n,[{key:"tiles",get:function(){return[]}},{key:"tokens",get:function(){return{}}},{key:"reset",value:function(){this.resources.clear(),this.machines.clear(),this.animals.clear(),this.people.clear(),this.dynamics.clear()}},{key:"send",value:function(e,t){var n=this.actions.lookup(e);if(!n)throw new Error("No such action ".concat(e));n.act(t)}},{key:"choose",value:function(e){var t=this.policies.lookup(e);if(!t)throw new Error("No such policy ".concat(e));this.currentPolicy=t}},{key:"step",value:function(){return this.currentPolicy&&this.currentPolicy.manage(),Object(h.a)(Object(d.a)(n.prototype),"step",this).call(this)}}]),n}(L);function le(e){return Math.floor(e)}var ue=n(4);function he(e){return function(t){var n=t.name,r=t.amount,a=e&&e[n];return Object(ue.jsxs)("li",{title:n,className:"Item",children:[Object(ue.jsx)("span",{className:"Title","data-testid":"Name",children:n}),Object(ue.jsx)("span",{"data-testid":"Count",children:le(r)}),Object(ue.jsx)("span",{"data-testid":"Delta",children:Object(ue.jsx)("small",{children:a||"-----"})})]},n)}}function de(e){var t=e.children,n=e.title;return Object(ue.jsx)("div",{className:"Tile",title:n,children:t})}var fe=function(e){return e.replace(/^\w/,(function(e){return e.toUpperCase()}))},me=function(e){return e.split(" ").map((function(e){return fe(e)})).join(" ")};function ge(e){return Object(ue.jsx)(de,{title:e.name,children:Object(ue.jsx)("ul",{"aria-label":"People",children:e.obscured?e.list().map((function(e){return Object(ue.jsx)("li",{children:e.name},e.id)})):e.list().map((t=e.report,function(e){var n=e.id,r=e.name,a=e.things,i=e.traits,o=e.items,s=(e.pets,e.nameConcepts),c=e.meters,l=a.list().map((function(e){return e.name})),u=o.list().map((function(e){return e.name})),h=s.map((function(e){return fe(e)})).reverse().reduce((function(e,t){return t.startsWith("-")?e+t:e.startsWith("-")||t.endsWith("-")?t+e:e+" "+t}),"");return Object(ue.jsxs)("li",{title:r,className:"Item",style:{display:"flex",flexDirection:"column",width:"500px"},children:[Object(ue.jsxs)("div",{className:"Title","data-testid":"Name",children:["\ud83e\uddcd",r]}),h&&Object(ue.jsx)("div",{className:"Subtitle","data-testid":"Significance of Name",style:{fontStyle:"italic",fontSize:" 10pt"},children:h}),Object(ue.jsx)("div",{className:"Meters",style:{padding:"1px",display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center"},children:Object.entries(c()).map((function(e){var t=Object(w.a)(e,2),n=t[0],r=(0,t[1])(),a=r.value,i=r.max;return Object(ue.jsxs)("div",{className:"Meter","data-testid":n,style:{display:"flex",width:"100px",flexDirection:"row",flexWrap:"wrap",padding:"2px"},children:[Object(ue.jsx)("label",{htmlFor:n,style:{fontSize:"8.5pt",fontWeight:"lighter",textTransform:"uppercase",paddingRight:"8px"},children:n}),Object(ue.jsxs)("meter",{id:n,style:{width:100,height:14},min:"0",max:i,low:.33*i,high:.66*i,optimum:.8*i,value:a,children:["at ",a,"/",i]})]})}))}),t[n]&&Object(ue.jsx)("span",{"data-testid":"Status",style:{display:"none"},children:t[n]}),i.list().length>0&&Object(ue.jsx)("div",{className:"Traits","data-testid":"Trait Ranks",style:{display:"block"},children:Object(ue.jsx)("ul",{children:i.list().map((function(e){return Object(ue.jsxs)("li",{style:Object(g.a)({},0===i.count(e.name)?{display:"none"}:{}),children:[Object(ue.jsx)("b",{children:e.name}),Object(ue.jsx)("span",{"data-testid":e.name,children:i.count(e.name)})]},e.id)}))})}),u.length>0&&Object(ue.jsx)("div",{className:"Items","data-testid":"Possessions",children:Object(ue.jsx)("ul",{children:u.sort((function(e,t){return e>t?1:-1})).map((function(e){return Object(ue.jsxs)("li",{style:{fontSize:"9pt",display:"flex",flexDirection:"column"},children:[Object(ue.jsxs)("div",{children:[Object(ue.jsxs)("span",{title:o.lookup(e).description,children:["- ",e]}),"\xa0",Object(ue.jsxs)("span",{style:{fontSize:"6.5pt"},children:[o.lookup(e).description,"\xa0",Object(ue.jsxs)("span",{children:["(",o.lookup(e).quality&&o.lookup(e).quality,")"]})]})]}),o.lookup(e).longDescription&&Object(ue.jsx)("div",{style:{fontSize:"6pt",padding:"4px",marginBottom:"8px",width:"180px",textAlign:"justify",alignSelf:"center"},children:o.lookup(e).longDescription})]},e)}))})}),l.length>0&&Object(ue.jsx)("div",{className:"Things","data-testid":"Inventory",style:{display:"block"},children:Object(ue.jsx)("ul",{children:l.sort((function(e,t){return e>t?1:-1})).map((function(e){return Object(ue.jsxs)("li",{style:Object(g.a)({},0===a.count(e)?{display:"none"}:{}),children:[e," ",Object(ue.jsx)("span",{"data-testid":e,className:"Count",children:Math.floor(a.count(e))})]},e)}))})})]},n)}))})},e.id);var t}n(40);var pe=n(18);function ye(){return Object(ue.jsx)("group",{children:Object(ue.jsx)("ambientLight",{position:[0,0,100],intensity:4.9})})}var ve=n(66),be=n(67),je=function(){var e=Object(r.useState)(window.innerWidth),t=Object(w.a)(e,2),n=t[0],a=t[1];function i(){a(window.innerWidth)}return Object(r.useEffect)((function(){return window.addEventListener("resize",i),function(){window.removeEventListener("resize",i)}}),[]),n<=768?Object(ue.jsx)(ve.a,{}):Object(ue.jsx)(be.a,{movementSpeed:100,rollSpeed:.5,dragToLook:!0})},we=n(5),ke=n(65);function Oe(e){var t=e.title,n=(e.position,t.startsWith("*")),r=t.substring(0,t.indexOf("(")),a=t.substring(t.indexOf("(")+1,t.indexOf(")")),i=n?8:3,o="white";return Object(ue.jsxs)(ue.Fragment,{children:[Object(ue.jsx)(ke.a,{font:"Fira Code",fontSize:i,color:o,anchorX:"center",anchorY:"middle",children:r.replaceAll("*","")},t+"-"+r),a&&Object(ue.jsx)(ke.a,{position:[0,-5,0],font:"Fira Code",color:o,fontSize:i/2,anchorX:"center",anchorY:"middle",children:a},t+"-"+a)]})}var xe={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};var Me=function(e){return function(t,n){var r=Math.floor(t),a=Math.ceil(t),i=Math.floor(n),o=Math.ceil(n);return r===a&&i===o?e(r,i):r===a?(e(r,i)*(o-n)+e(r,o)*(n-i))/(o-i):i===o?(e(r,i)*(a-t)+e(a,i)*(t-r))/(a-r):(e(r,i)*(a-t)*(o-n)+e(a,i)*(t-r)*(o-n)+e(r,o)*(a-t)*(n-i)+e(a,o)*(t-r)*(n-i))/((a-r)*(o-i))}},Se=n(64);function Ee(e){var t=e.position,n=e.map,r=Object(w.a)(t,3),a=r[0],i=r[1],o=r[2];return Object(ue.jsx)(Se.a,{position:[a,i,o+1.05],children:Object(ue.jsxs)("mesh",{scale:1.2,children:[Object(ue.jsx)("planeGeometry",{args:[2,2]}),Object(ue.jsx)("meshStandardMaterial",{attach:"material",transparent:!0,map:n})]})})}Object(pe.b)({Billboard:Se.a});var Ae=function(e,t,n){for(var r=e[0].length+1,a=e.length+1,i=n,o=n,s=new Uint8Array(i*o),c=new Uint8Array(i*o*4),l=function(t,n){return void 0!==e[n]?parseInt(e[n][t],10):0},u=Me(l),h=function(e,n){var r,a=(r=function(e,n){var r=l(e,n);return t[Math.round(r)]}(e,n),void 0===r?"#000000":"undefined"!=typeof xe[r.toLowerCase()]?xe[r.toLowerCase()]:"#000000");return a},d=Me((function(e,t){var n=h(e,t);return parseInt(n[1]+n[2],16)})),f=Me((function(e,t){var n=h(e,t);return parseInt(n[3]+n[4],16)})),m=Me((function(e,t){var n=h(e,t);return parseInt(n[5]+n[6],16)})),g=0;g<=o+2;g++)for(var p=0;p<=i+2;p++){var y=g*i+p,v=r-p/i*r,b=g/o*a,j=u(v,b);s[y]=25*j;var w=4*(g*i+p);c[w]=d(v,b),c[w+1]=f(v,b),c[w+2]=m(v,b),c[w+3]=255}return{rgb:c,grayscale:s}},Pe=null,Ie=function(e){var t=e.tokens,n=e.tileColors,r=e.evolving,a=e.tiles,i=e.pointsOfInterest,o=(a=a||[]).length,s=o,c="".concat(".","/tree.png"),l=null;try{l=Object(pe.d)(we.TextureLoader,c)}catch(k){}var u=o*(r?1:8),h=u,d=u,f=Pe||Ae(a,n,u),m=f.grayscale,g=f.rgb;Pe=r?null:{grayscale:m,rgb:g};var p=new we.DataTexture(m,h,d,we.LuminanceFormat,we.UnsignedByteType),y=new we.DataTexture(g,h,d,we.RGBAFormat,we.UnsignedByteType),v=Object(ue.jsx)("planeBufferGeometry",{attach:"geometry",args:[s,s,256,256]}),b=Me((function(e,t){return void 0!==a[t]?parseInt(a[t][e]||"0",10):0})),j=function(e){var t=Object(w.a)(e,2),n=t[0],r=t[1],a=s/2,i=o/a/2;return[a-n*i,r*i-a,b(n,r)/10*16]};return Object(ue.jsxs)(ue.Fragment,{children:[Object(ue.jsxs)("mesh",{position:[0,0,0],children:[v,Object(ue.jsx)("meshPhongMaterial",{attach:"material",color:"navajowhite",map:y,displacementMap:p,displacementScale:16,shininess:2,flatShading:!0}),Object.entries(i).map((function(e,t){var n=Object(w.a)(e,2),r=n[0],a=Object(w.a)(n[1],2),i=a[0],o=a[1];return Object(ue.jsx)(Oe,{position:j([i,o]),title:r})})),t.trees.map((function(e){return l&&Object(ue.jsx)(Ee,{map:l,position:j(e)})}))]}),Object(ue.jsxs)("mesh",{position:[0,0,4.75],children:[v,Object(ue.jsx)("meshPhongMaterial",{attach:"material",color:"darkblue",transparent:!0,opacity:.95,displacementScale:64,shininess:1,flatShading:!0})]})]})};var Ne=function(e){var t=e.tiles,n=e.tokens,r=e.tileColors,a=e.evolving,i=e.pointsOfInterest,o=Object(pe.e)().scene;return null===o.background&&(o.background=(new we.CubeTextureLoader).load(["".concat(".","/1.jpg"),"".concat(".","/2.jpg"),"".concat(".","/3.jpg"),"".concat(".","/4.jpg"),"".concat(".","/5.jpg"),"".concat(".","/6.jpg")])),Object(ue.jsxs)(ue.Fragment,{children:[Object(ue.jsx)(ye,{}),Object(ue.jsx)(je,{}),Object(ue.jsx)(Ie,{tiles:t,tokens:n,evolving:a,tileColors:r,pointsOfInterest:i})]})},Ce=function(e){var t=e.tileColors,n=e.isBoardEvolving,a=e.tiles,i=e.pointsOfInterest,o={tiles:a,tokens:e.tokens,tileColors:t,pointsOfInterest:i,evolving:n};return Object(ue.jsx)(ue.Fragment,{children:Object(ue.jsx)(pe.a,{frameloop:"demand",camera:{zoom:4,position:[0,0,24],near:.1,far:15e3},onCreated:function(e){e.camera.rotateX(Math.PI/2)},children:Object(ue.jsx)(r.Suspense,{fallback:Object(ue.jsx)("div",{className:"loading",children:"Loading"}),children:Object(ue.jsx)(Ne,Object(g.a)({},o))})})})},Fe=function(e){var t=e.tiles,n=e.tileColors,r=(e.tileInspect,e.evolving),a=e.pointsOfInterest,i=e.tokens;return Object(ue.jsxs)("div",{style:{width:"100vw",height:"70vh"},children:[Object(ue.jsx)(Ce,{isBoardEvolving:r,tiles:t,tokens:i,tileColors:n,pointsOfInterest:a}),false]})};n(60);function Te(e){var t=e.modelName,n=e.resources,r=e.communities,a=e.machines,i=e.animals,o=e.lastChanges,s=e.metrics,c=e.notes,l=e.board,u=r.map(ge);return Object(ue.jsxs)("div",{className:"Model",style:{display:l.tiles.length?"block":"flex"},children:[Object(ue.jsx)("h4",{"aria-label":"Model Title",style:{display:"none"},children:t}),l.tiles.length>0&&Object(ue.jsx)(Fe,Object(g.a)({},l)),n.length>0&&Object(ue.jsx)(de,{title:"Store",children:Object(ue.jsx)("ul",{"aria-label":"Resources",children:n.map(he(o.resources))})}),i.length>0&&Object(ue.jsx)(de,{title:"Animals",children:Object(ue.jsx)("ul",{"aria-label":"Animals",children:i.map(he(o.animals))})}),r.length>0&&Object(ue.jsx)("div",{title:"Individuals",style:{display:"flex"},children:u}),a.length>0&&Object(ue.jsx)(de,{title:"Machines",children:Object(ue.jsx)("ul",{children:a.map((function(e){var t=e.name;return Object(ue.jsx)("li",{children:t},t)}))})}),Object.keys(s).length>0&&Object(ue.jsx)(de,{title:"Metrics",children:Object(ue.jsx)("ul",{children:Object.entries(s).map((function(e){var t=Object(w.a)(e,2),n=t[0],r=t[1];return Object(ue.jsxs)("li",{title:n,children:[n,Object(ue.jsx)("span",{"data-testid":"Count",children:Math.floor(r)})]},n)}))})}),Object.keys(c).length>0&&Object(ue.jsx)(de,{title:"Notes",children:Object(ue.jsx)("table",{children:Object(ue.jsx)("tbody",{children:Object.entries(c).map((function(e){var t=Object(w.a)(e,2),n=t[0],r=t[1];return n.startsWith("*")?Object(ue.jsx)("tr",{style:{textAlign:"center"},title:fe(n.replaceAll("*","")),children:Object(ue.jsx)("td",{colSpan:3,children:Object(ue.jsx)("b",{children:r})})},n):Object(ue.jsxs)("tr",{title:n,children:[Object(ue.jsx)("td",{style:{textAlign:"right",color:"gray"},children:n},n),Object(ue.jsx)("td",{style:{width:"4px"}}),Object(ue.jsx)("td",{style:{minWidth:"180px",textAlign:"left",fontSize:"15pt"},children:Object(ue.jsx)("span",{"data-testid":"Description",style:Object(g.a)(Object(g.a)(Object(g.a)({},r.startsWith("*")&&{color:"lightgreen"}),r.startsWith("%")&&{color:"goldenrod"}),r.startsWith("~")&&{color:"darkgray"}),children:r.replaceAll("*","").replaceAll("%","").replaceAll("~","")})})]},n)}))})})})]})}var De=ce,ze=function(e,t){var n=e.resources,r=e.people,a=e.machines,i=e.animals,o=e.metrics,s=e.notes,c=e.tiles,l=e.tileColors;return{modelName:e.name,resources:n.report,communities:r.populationList,machines:a.list(),animals:i.report,metrics:Object.fromEntries(Object.entries(o).map((function(e){var t=Object(w.a)(e,2);return[t[0],(0,t[1])()]}))),notes:Object.fromEntries(Object.entries(s).map((function(e){var t=Object(w.a)(e,2);return[t[0],(0,t[1])()]}))),lastChanges:t,board:{tiles:c||[],tileColors:l||{},tileInspect:e.tileInspect||function(){return"--"},evolving:e.tilesEvolving||!1,pointsOfInterest:e.pointsOfInterest||{},tokens:e.tokens||{}}}};function qe(e){var t=e.model,n=e.send,r=e.choose,a=e.step,i=e.lastChanges;return Object(ue.jsxs)(ue.Fragment,{children:[Object(ue.jsx)("div",{"aria-label":"View",children:Object(ue.jsx)(Te,Object(g.a)({},ze(t,i)))}),Object(ue.jsxs)("div",{"aria-label":"Controls",children:[Object(ue.jsx)("span",{title:"Run",style:{display:"none"},children:Object(ue.jsx)("button",{onClick:function(){return a(!0)},children:"Step"})}),Object(ue.jsx)("span",{title:"Actions",children:t.actions.list().map((function(e){var t=e.name;return Object(ue.jsx)("button",{title:t,onClick:function(){return n(t)},children:t},t)}))}),t.policies.count>0&&Object(ue.jsx)("div",{className:"Policy",title:"Policies",children:t.policies.list().map((function(e){var n,a=e.name;return Object(ue.jsxs)("label",{children:[Object(ue.jsx)("input",{type:"radio",checked:(null===(n=t.currentPolicy)||void 0===n?void 0:n.name)===a,title:a,onChange:function(){return r(a)}},a),a]},a)}))})]})]})}function Be(e){var t=Object(r.useState)(e),n=Object(w.a)(t,2),a=n[0],i=n[1],o=Object(r.useState)({}),s=Object(w.a)(o,2),c=s[0],l=s[1],u=Object(r.useState)(2),h=Object(w.a)(u,2),d=h[0],f=h[1],m=Object(r.useState)(!1),g=Object(w.a)(m,2),p=g[0],y=g[1],v=Object(r.useState)(!1),b=Object(w.a)(v,2),j=b[0],k=b[1],O=Object(r.useState)(!1),x=Object(w.a)(O,2),M=x[0],S=x[1],E=Object(r.useState)(""),A=Object(w.a)(E,2),P=A[0],I=A[1],N=Object(r.useState)(""),C=Object(w.a)(N,2),F=C[0],T=C[1];Object(r.useEffect)((function(){j&&(P&&We(a)&&a.send(P,{}),k(!1))}),[P,a,j]),Object(r.useEffect)((function(){M&&(F&&We(a)&&a.choose(F,{}),S(!1))}),[F,a,M]);return Object(r.useEffect)((function(){if(p&&We(a)){var e=a.step().changed;y(!1),l(e)}}),[p,a]),function(e,t){var n=Object(r.useRef)();Object(r.useEffect)((function(){n.current=e}),[e]),Object(r.useEffect)((function(){function e(){n.current()}if(null!==t){var r=setInterval(e,t);return function(){return clearInterval(r)}}}),[t])}((function(){return y(!0)}),d),{model:a,step:function(){y(!0)},lastChanges:c,send:function(e,t){return function(e,t){I(e),k(!0)}(e)},choose:function(e,t){return function(e,t){T(e),S(!0)}(e)},setDelay:f,setModel:i}}var We=function(e){return e instanceof De},_e=function(e){var t=e.assembly;return Object(ue.jsx)(ue.Fragment,{children:t.models.items.map((function(e){var t=Be(e),n=t.step,r=t.send,a=t.choose,i=t.lastChanges,o=t.model;return Object(ue.jsxs)(ue.Fragment,{children:[Object(ue.jsx)("h4",{children:e.name}),Object(ue.jsx)(qe,{step:n,send:r,model:o,choose:a,lastChanges:i},o.name)]})}))})};function Le(e){var t=e.initialModel,n=e.models,r=Be(t),a=r.step,i=r.send,o=r.choose,s=r.lastChanges,l=r.model,u=r.setModel;return Object(ue.jsxs)(ue.Fragment,{children:[Object(ue.jsx)(c.a,{options:n.map((function(e){return e.name})),onChange:function(e){var t=e.value,r=n.find((function(e){return e.name===t}));r&&u(r)},value:l.name,placeholder:"Select a model"}),We(l)?Object(ue.jsx)(qe,{step:a,send:i,model:l,choose:o,lastChanges:s}):Object(ue.jsx)(_e,{assembly:l})]})}var He=n(15),Je=function(e,t){return e.filter(t)[0]},Re=function(){function e(t,n){var r=this;Object(l.a)(this,e),this.width=t,this.height=n,this.tiles=[],this.write=function(e,t,n){var a=t,i=n;r.tiles[i]=r.tiles[i]||[],r.tiles[i][a]=e},this.drawBox=function(e,t,n,a,i,o){for(var s=t+a,c=n+i,l=t;l<=s;l++)for(var u=n;u<=c;u++)(l===t||u===n||l===s||u===c||o)&&r.write(e,l,u)}}return Object(u.a)(e,[{key:"view",value:function(){for(var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{overlays:[]},n=t.overlays,r=[],a=function(t){for(var a=function(a){r[a]=r[a]||[];var i=n.length>0&&Je(n,(function(e){var n=e.at(t,a);return""!==n&&void 0!==n}));r[a][t]=i&&i.at(t,a)||e.at(t,a)||"_"},i=-1;i<=e.height;i++)a(i)},i=-1;i<=this.width;i++)a(i);return r}},{key:"erase",value:function(e,t){this.tiles[t]=this.tiles[t]||[],this.tiles[t][e]=""}},{key:"at",value:function(e,t){var n=e%this.width,r=t%this.height;if(this.tiles[r])return this.tiles[r][n]}},{key:"each",value:function(e){for(var t=0;t<=this.width;t++)for(var n=0;n<=this.height;n++)e(t,n,this.at(t,n)||"")}},{key:"neighbors",value:function(t,n){var r=this;return e.neighborPositions(t,n).map((function(e){var t=Object(w.a)(e,2),n=t[0],a=t[1];return r.at(n,a)||""}))}},{key:"step",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=[];this.tiles=this.tiles||[];for(var a=function(e,r){return t.at(e,r)||n},i=0;i<=this.width;i++)for(var o=0;o<=this.height;o++){var s=a(i,o);if(void 0!==s){var c=this.neighbors(i,o),l=e(s,c,[i,o]);r[o]=r[o]||[],r[o][i]=l}}return this.tiles=r,r}}],[{key:"neighborPositions",value:function(e,t){return[[e-1,t-1],[e,t-1],[e+1,t-1],[e-1,t],[e+1,t],[e-1,t+1],[e,t+1],[e+1,t+1]]}}]),e}(),Ue=function(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return!0;return!1},Ge=function(e,t,n){return Math.min(Math.max(e,t),n)},Ve=function(e,t){var n=Math.abs(e[0]-t[0]),r=Math.abs(e[1]-t[1]);return Math.sqrt(n*n+r*r)};function Ke(e,t){return e.filter(t)[0]}var Xe,Ye=function(){function e(t,n){var r=this;Object(l.a)(this,e),this.width=t,this.height=n,this.matrix=[],this.maxHeight=256,this.heightUnit=this.maxHeight/10,this.seaLevel=.3*this.maxHeight,this.viewHeightAtPos=function(e){var t=Object(w.a)(e,2),n=t[0],a=t[1];return Math.round(Ge(r.valueAtPosition([n,a])*(1/r.heightUnit),0,9))},this.valueAtPosition=function(e){var t=Object(w.a)(e,2),n=t[0],a=t[1],i=n%r.width,o=a%r.height;return r.matrix[o]=r.matrix[o]||[],void 0!==r.matrix[o][i]?r.matrix[o][i]:0},this.write=function(e,t){var n=Object(w.a)(t,2),a=n[0],i=n[1];r.matrix[i]=r.matrix[i]||[],r.matrix[i][a]=Math.round(Ge(e,0,r.maxHeight))},this.each=function(e){for(var t=0;t<r.width;t++)for(var n=0;n<r.height;n++){var a=[t,n];e(r.valueAtPosition(a),a)}},this.neighbors=function(e){var t=Object(w.a)(e,2);return function(e){var t=Object(w.a)(e,2),n=t[0],r=t[1];return[[n-1,r-1],[n,r-1],[n+1,r-1],[n-1,r],[n+1,r],[n-1,r+1],[n,r+1],[n+1,r+1]]}([t[0],t[1]]).map(r.valueAtPosition)},this.step=function(e){for(var t=[],n=0;n<=r.height;n++){t[n]=[];for(var a=0;a<=r.width;a++){var i;i=e(r.valueAtPosition([a,n]),r.neighbors([a,n]),[a,n]),t[n][a]=i}}return r.matrix=t,t},this.at=function(e,t){return r.valueAtPosition([e,t])},this.smooth=function(e){var t=e.value;e.neighbors,e.localAverage;return t},this.mu=this.heightUnit,this.flow=function(e){var t=e.value,n=e.neighbors;e.localAverage;if(t>0)return t;var a=Math.max.apply(Math,Object(He.a)(n)),i=r.evolution.viscosity,o=r.mu*Math.pow(2,x(-4,2+i));return o>2*r.mu&&(o=2*r.mu),t>r.seaLevel&&x(0,1e3)<5&&(o=-o),Math.max(t,a-o)},this.erode=function(e){var t=e.value;e.neighbors,e.localAverage;return t},this.adjuster=function(e){return function(t){var n=r.valueAtPosition(t);r.write(n+e,t)}},this.extrude=function(e){if(0!==e.length){var t=r.adjuster(r.heightUnit*r.evolution.extrudeIntensity);S(3,e).forEach(t)}},this.intrude=function(e){var t=r.adjuster(-r.heightUnit*r.evolution.extrudeIntensity/2);e.forEach(t)},this.bombard=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=x(1,4+x(0,e)),n=[x(1,r.width-1),x(1,r.height-1)],a=function(e){return Ve(e,n)},i=[],o=[],s=n[0],c=n[1],l=s-t;l<s+t;l++)for(var u=c-t;u<c+t;u++){var h=Math.round(a([l,u]));Math.abs(h-t)<1?o.push([l,u]):h<t&&i.push([l,u])}r.intrude(i),r.extrude(o)},this.geoform=function(e,t){x(0,100);r.evolution.bombardmentRate,e&&r.extrude(t),r.evolve(r.flow,r.erode,r.smooth)},this.componentNames=new T,this._regions={},this.regions=function(){return 0===Object.entries(r._regions).length&&(r._regions=r.components((function(e){return e>=r.seaLevel}))),r._regions},this.waterways=function(){return r.components((function(e){return e<r.seaLevel}))},this.ranges=function(){return r.components((function(e){return e>=.8*r.maxHeight}))},this.valleys=function(){var e=r.seaLevel;return r.components((function(t,n){return t>=e&&Math.abs(t-e)<r.heightUnit&&n.reduce((function(e,t){return e+t}),0)/n.length>=e}))},this.bays=function(){var e=r.seaLevel;return r.components((function(t,n){return t<=e&&Math.abs(t-e)<r.heightUnit&&n.reduce((function(e,t){return e+t}),0)/n.length<=e}))}}return Object(u.a)(e,[{key:"evolution",get:function(){return{erosionSpeed:512,smoothSpeed:256,extrudeIntensity:10,viscosity:0,bombardmentRate:50}}},{key:"view",value:function(){for(var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{overlays:[]},n=t.overlays,r=[],a=function(t){for(var a=function(a){r[a]=r[a]||[];var i=n.length>0&&Ke(n,(function(e){var n=e.at(t,a);return""!==n&&void 0!==n}));r[a][t]=i&&i.at(t,a)||String(e.viewHeightAtPos([t,a])||0)},i=0;i<e.height-1;i++)a(i)},i=0;i<this.width-1;i++)a(i);return r}},{key:"evolve",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var a=function(){return e.step((function(t,r,a){var i=(r.reduce((function(e,t){return e+t}),0)+t)/(r.length+1);return n.forEach((function(e){t=e({value:t,position:a,neighbors:r,localAverage:i})})),Ge(t,0,e.maxHeight)}))};a()}},{key:"components",value:function(e){var t=this,n={};return this.each((function(r,a){var i=t.neighbors(a),o=Math.round(r/t.mu)*t.mu;if(e(o,i)){var s=Object.keys(n).filter((function(e){return Ue(n[e],(function(e){var t=Object(w.a)(e,2),n=t[0],r=t[1];return Ve(a,[n,r])<=Math.sqrt(2)}))}));if(s.length>0){var c=s[0];n[c].push(a),s.length>1&&s.forEach((function(e){e!==c&&(n[c]=[].concat(Object(He.a)(n[c]),Object(He.a)(n[e])),delete n[e])}))}else{var l=t.componentNames.next;n[l]=[a]}}})),n}}]),e}(),Qe=["earth","sky","mountain","hill","valley","peak","mound","point","mountain-chain","island","isle","sea","lake","bay","pool","harbor","forest","river","glen","stream","land","place","realm","region","peoples","kingdom","road","path","haven","fortress","prison","citadel","stronghold","tower","garden","ever-","-less","at-","-person","-man","-son","-woman","-maid","-daughter","friend","foe","lord","slave","king","queen","prince","princess","light","dark","shadow","shade","sun","moon","stars","day","night","spark","starlight","firmament","heat","cold","mist","snow","wind","rain","cloud","rainbow","dew","frost","tin","iron","silver","gold","white","black","gray","red","blue","green","orange","dragons","elephants","bears","birds","horses","snakes","wolves","hounds","swans","eagles","nightingales","ice","fire","earth","water","embers","steam","magma","radiance","soot","ash","salt","void","morning","evening","dusk","noon","afternoon","midnight","willow","pine","cherry","oak","spruce","birch","elm","holly","rose","daisy","poppy","dandelion","lily","autumn","winter","spring","summer","dread","horror","awe","joy","sorrow","gloom","apple","honey","bread","elderberry","wine","fish","wax","tall","deep","lofty","lonely","great","large","small","tiny","narrow","wide","sharp","giant","quick","pale","bitter","golden","holy","fortunate","dusty","beautiful","fell","cloudy","secret","sweet","bold","splendid","abundant","sparkling","horns","fangs","claws","love","dream","music","silence","divine","fate","thought","speech","skill","tomorrow","spirit","tyranny","freedom","magic","blood","tears","laughter","jewel","ship","needle","bell","candle","mantle","veil","journey","treasure","battle","smith"],Ze=function(){function e(t,n,r){var a=this;Object(l.a)(this,e),this.languageName=t,this.vocabulary=n,this.enhanceTranslation=r,this.name=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(){for(var e=fe(t.join("-")),n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var o=fe(r.join("-")),s="".concat(o," ").concat(e);o.endsWith("s")&&(s="".concat(o,"' ").concat(e));var c="".concat(a.translate.apply(a,t.concat(r)));return[s,c]}},this.nameInverse=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(){for(var e=fe(t.join("-")),n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var o=fe(r.join("-")),s="".concat(o," ").concat(e);o.endsWith("s")&&(s="".concat(o,"' ").concat(e));var c="".concat(a.translate.apply(a,r.concat(t)));return[s,c]}}}return Object(u.a)(e,[{key:"translate",value:function(){for(var e=this,t="",n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var i=r.reduce((function(n,r,a){var i=e.vocabulary[r],o=!0;((n=n.trim()).endsWith("-")||n.endsWith("*"))&&(o=!1,n=n.substring(0,n.length-1)),a>0&&(i.startsWith("-")||i.startsWith("*"))&&(o=!1,i=i.substring(1,i.length));var s=[n,i];return t.startsWith("-")&&(o=!1,s=[i,n]),t=i,s.join(o?" ":"")}),"");i=i.replaceAll("-","");var o=this.enhanceTranslation?this.enhanceTranslation(i):i;return me(o)}}]),e}(),$e=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object(l.a)(this,n),(r=t.call(this)).dictionary=e,r.invertOrder=a,r.notions=void 0;for(var i=arguments.length,o=new Array(i>2?i-2:0),s=2;s<i;s++)o[s-2]=arguments[s];return r.notions=o,r}return Object(u.a)(n,[{key:"generate",value:function(){console.log("Generate ".concat(this.notions.join("/")," using ").concat(this.dictionary.languageName," dictionary..."));var e=S(1,Qe),t=(this.invertOrder?this.dictionary.nameInverse(M(this.notions)):this.dictionary.name(M(this.notions))).apply(void 0,Object(He.a)(e)),n=Object(w.a)(t,2),r=n[0],a=n[1];return"".concat(a," (").concat(r,")")}}]),n}(D),et={"iand\xeb":"ess\xeba",dc:"g",nc:"g",db:"v",uwen:"uviel",ean:"\xf3n\xeb",nng:"ng",airt:"\xedrd",gdor:"gion","\xf4lm":"l\xf3r",rineth:"rien"},tt={ss:"\xeb"},nt={r:"iand",on:"ion",il:"ion",nd:"\xeb"},rt=new Ze("Sindarin",{heat:"ast",cold:"ring","-less":"uv-","ever-":"oio-","at-":"ad-","-person":"-we","-man":"-on","-son":"-ion","-woman":"-ien","-maid":"-wen","-daughter":"-iell","mountain-chain":"-orodrim",abundant:"ovor",afternoon:"avnedhor",apple:"orf",autumn:"iarvas-",awe:"anwar",battle:"dagor",bay:"c\xf4f",bears:"graw",beautiful:"bain",bell:"nell",bitter:"saer",birch:"hwinn*",birds:"aewen",black:"morn",blood:"sereg",blue:"luin-",bold:"beren",bread:"-bas",candle:"l\xedgu",cherry:"aebin*",citadel:"ost-",claws:"gamp-",cloudy:"fanui",daisy:"eirien",dandelion:"orchen",day:"or-",deep:"n\xfbr-",dew:"m\xeedh-",divine:"ball\xf3n\xeb",dragons:"amlug",dread:"gost",dream:"\xf4l-",dusk:"moth-",dusty:"astren*",eagles:"thoron",earth:"amar",elderberry:"gwennod",elephants:"annabon",elm:"alaf",evening:"aduial",fangs:"carax\xeb",fate:"amarth",fell:"delu",fire:"nor-",firmament:"menel*",fish:"lhim",foe:"-coth",forest:"taur*",fortress:"garth-",fortunate:"alwed",freedom:"leinas",friend:"-mellon",frost:"nais",giant:"noroth",glen:"imlad",gloom:"dim-",gold:"malt-",golden:"gl\xf3riel",gray:"thind-",great:"beleg-",green:"calen-",harbor:"h\xfbb",haven:"-lond*",hill:"amon",holy:"aer",honey:"gl\xee",horns:"rais",horror:"angoss-",horses:"roch",ice:"hel-",iron:"ang-",isle:"tol",jewel:"m\xeer",journey:"ledh-",joy:"glass-",king:"aran",kingdom:"arnad",laughter:"lalaith",lake:"ael",land:"dor-",large:"daer",light:"ea",dark:"d\xfbr",lily:"loth-",lofty:"raud",lonely:"er*",lord:"-gon",love:"m\xeel",magic:"l\xfbth",mantle:"col-",midnight:"fuin",mist:"hith-",moon:"ithil",morning:"-aur",mound:"coro-",mountain:"ered",music:"-linnas",narrow:"agor-",needle:"aeglin",night:"d\xfb",nightingales:"d\xfalin*",noon:"nedhor",oak:"doron*",orange:"culuin",pale:"nim-",path:"lant",peak:"aegnas",peoples:"li-",pine:"thon*",place:"sa-",point:"til",pool:"l\xeen",poppy:"lurloss-",prison:"-band",quick:"lim",rain:"ross-",rainbow:"ninniach",realm:"-arthor",red:"caran-",region:"gardh",river:"-rant",road:"men",rose:"merin*",sea:"-geaer",secret:"dolen*",shade:"gwath",shadow:"-lum",sharp:"crisg-",ship:"cair*",silence:"dh\xedn-",silver:"celeb-",skill:"curu-",sky:"-ell",slave:"m\xfbl",small:"cidinn*",smith:"-tan",snakes:"l\u0177g",snow:"loss-",sorrow:"n\xeer",spark:"tinu-",sparkling:"m\xedriel",speech:"paeth*",spirit:"f\xeba-",splendid:"claur-",spring:"ethuil",spruce:"ecthelorn*",starlight:"gilith",stars:"-ngil",stream:"s\xeer",stronghold:"-gothrond",summer:"llair\xeb",sun:"anor",swans:"alqua",sweet:"laich",tall:"ta-",tears:"nirnaeth",thought:"nauth*",tin:"-ladog",tiny:"tithen*",tomorrow:"abor",tower:"barad-",treasure:"maen*",tyranny:"thang",valley:"nan",veil:"f\xe2n",water:"nin",wax:"l\xeeg",white:"nique-",wide:"-land",willow:"tathar*",wind:"gwae",wine:"miru",winter:"rh\xeew",holly:"ereg*",garden:"sant",queen:"bereth",prince:"ernil",princess:"brethil",cloud:"fan",hounds:"h\xfb",wolves:"draug",embers:"i\xfbl",soot:"ast",ash:"lith",salt:"sing",void:"gaw",steam:"tuim",magma:"orodu",radiance:"aglar",island:"mineth"},(function(e){return function(e){return e.split(" ").map((function(e){return Object.keys(tt).forEach((function(t){e.endsWith(t)&&(e+=tt[t])})),e.endsWith("*")&&(e=e.replaceAll("*",""),Object.keys(nt).forEach((function(t){e.endsWith(t)&&(e+=nt[t])}))),Object.entries(et).forEach((function(t){var n=Object(w.a)(t,2),r=n[0],a=n[1];e=e.replaceAll(r,a)})),e})).join(" ")}(e)})),at=function(){function e(t){Object(l.a)(this,e),this.dictionary=t,this.names={places:new $e(this.dictionary,!0,"land","place"),regions:new $e(this.dictionary,!1,"isle","place"),waterways:new $e(this.dictionary,!1,"sea","lake","water","pool"),ranges:new $e(this.dictionary,!0,"mountain-chain"),mountains:new $e(this.dictionary,!1,"mountain"),valleys:new $e(this.dictionary,!1,"valley"),bays:new $e(this.dictionary,!1,"bay")},this.waterwayNames={},this.regionNames={},this.rangeNames={},this.valleyNames={},this.bayNames={}}return Object(u.a)(e,[{key:"nameWaterway",value:function(e,t){return void 0===this.waterwayNames[e]&&(this.waterwayNames[e]=this.names.waterways.next),this.waterwayNames[e]}},{key:"nameRegion",value:function(e,t){return void 0===this.regionNames[e]&&(this.regionNames[e]=M([this.names.regions,this.names.places]).next),this.regionNames[e]}},{key:"nameRange",value:function(e,t){return void 0===this.rangeNames[e]&&(this.rangeNames[e]=M([this.names.ranges,this.names.mountains]).next),this.rangeNames[e]}},{key:"nameValley",value:function(e,t){return void 0===this.valleyNames[e]&&(this.valleyNames[e]=this.names.valleys.next),this.valleyNames[e]}},{key:"nameBay",value:function(e,t){return void 0===this.bayNames[e]&&(this.bayNames[e]=this.names.bays.next),this.bayNames[e]}}]),e}(),it=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:rt;Object(l.a)(this,e),this.elevation=t,this.dictionary=n,this.linguist=new at(this.dictionary),this._waterways={},this._regions={},this._ranges={},this._valleys={},this._bays={}}return Object(u.a)(e,[{key:"reset",value:function(){this._regions={},this._waterways={},this._ranges={},this._valleys={},this._bays={}}},{key:"regions",get:function(){return 0===Object.keys(this._regions).length&&(this._regions=this.elevation.regions()),this._regions}},{key:"identifyRegion",value:function(e,t){var n=this,r=Object.keys(this.regions).find((function(r){return n.regions[r].find((function(n){var r=Object(w.a)(n,2),a=r[0],i=r[1];return e===a&&t===i}))}))||null;if(r){var a=this.regions[r].length;return this.linguist.nameRegion(r,a)}}},{key:"waterways",get:function(){return 0===Object.keys(this._waterways).length&&(this._waterways=this.elevation.waterways()),this._waterways}},{key:"identifyWaterway",value:function(e,t){var n=this,r=Object.keys(this.waterways).find((function(r){return n.waterways[r].find((function(n){var r=Object(w.a)(n,2),a=r[0],i=r[1];return e===a&&t===i}))}))||null;if(r){var a=this.waterways[r].length;return this.linguist.nameWaterway(r,a)}}},{key:"identifyRegionOrWaterway",value:function(e,t){return this.identifyRegion(e,t)||this.identifyWaterway(e,t)||"(err: unknown region/waterway)"}},{key:"ranges",get:function(){return 0===Object.keys(this._ranges).length&&(this._ranges=this.elevation.ranges()),this._ranges}},{key:"identifyRange",value:function(e,t){var n=this,r=Object.keys(this.ranges).find((function(r){return n.ranges[r].find((function(n){var r=Object(w.a)(n,2),a=r[0],i=r[1];return e===a&&t===i}))}))||null;if(r){var a=this.ranges[r].length;return this.linguist.nameRange(r,a)}}},{key:"valleys",get:function(){return 0===Object.keys(this._valleys).length&&(this._valleys=this.elevation.valleys()),this._valleys}},{key:"identifyValley",value:function(e,t){var n=this,r=Object.keys(this.valleys).find((function(r){return n.valleys[r].find((function(n){var r=Object(w.a)(n,2),a=r[0],i=r[1];return e===a&&t===i}))}))||null;if(r){var a=this.valleys[r].length;return this.linguist.nameValley(r,a)}}},{key:"bays",get:function(){return 0===Object.keys(this._bays).length&&(this._bays=this.elevation.bays()),this._bays}},{key:"identifyBay",value:function(e,t){var n=this,r=Object.keys(this.bays).find((function(r){return n.bays[r].find((function(n){var r=Object(w.a)(n,2),a=r[0],i=r[1];return e===a&&t===i}))}))||null;if(r){var a=this.bays[r].length;return this.linguist.nameBay(r,a)}}},{key:"identifyFeatures",value:function(e,t,n){return"Hadean"===e||"Archean"===e?"(Cartography requires calmer aeon...)":this.identifyRange(t,n)||this.identifyValley(t,n)||this.identifyBay(t,n)||""}}]),e}(),ot=(Xe=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(){var e;return Object(l.a)(this,n),(e=t.call(this,"Overworld")).notes={aeon:function(){return e.aeon}},e.size=128,e.width=e.size,e.height=e.size,e.mapgenTicks=128,e.elevation=new Ye(e.width,e.height),e.terrain=new Re(e.width,e.height),e.vegetation=new Re(e.width,e.height),e.mountainSpots=[],e.areaPercent=Math.floor(e.area/100),e.cartographer=new it(e.elevation),e.tileColors={"~":"midnightblue",",":"navy","'":"darkgreen",'"':"green",".":"lightgreen",0:"navy",1:"royalblue",2:"gold",3:"silver",4:"silver",5:"darkgray",6:"gray",7:"darkslategray",8:"slategray",9:"white"},e.evolve(e.evolution),e.actions.create({name:"Geoform",act:function(){e.ticks=0,e.cartographer.reset()}}),e}return Object(u.a)(n,[{key:"aeon",get:function(){var e="Hadean";return this.ticks>=this.mapgenTicks/2&&(e="Archean"),this.ticks>this.mapgenTicks&&(e="Proterozoic"),e}},{key:"tiles",get:function(){return this.elevation.view({overlays:[]})}},{key:"tokens",get:function(){return{trees:this.trees}}},{key:"tilesEvolving",get:function(){return"Hadean"===this.aeon||"Archean"===this.aeon}},{key:"pointsOfInterest",get:function(){var e=this;if("Hadean"===this.aeon||"Archean"===this.aeon)return{"*Please wait...":[50,50]};var t=(0,this.elevation.regions)();return Object.fromEntries(Object.entries(t).map((function(t){var n,r=Object(w.a)(t,2),a=(r[0],r[1]),i=(n=e.cartographer).identifyRegion.apply(n,Object(He.a)(a[0])),o=0,s=0;a.forEach((function(e){var t=Object(w.a)(e,2),n=t[0],r=t[1];o+=n,s+=r}));var c=a.length,l=o/c,u=s/c;return[(c>80?"*":"")+i,[Math.round(l),Math.round(u)]]})))}},{key:"tileInspect",value:function(e,t){var n=this.elevation.at(e,t)||0,r=Math.round(3600*(n-4)/5280),a=0===r?"At sea level":"".concat(Math.abs(r)," li ").concat(r>=0?"above":"below"," sea level");if("Hadean"===this.aeon||"Archean"===this.aeon)return a;var i=this.cartographer.identifyRegionOrWaterway(e,t);return[this.cartographer.identifyFeatures(this.aeon,e,t),i].filter(Boolean).join("\n")}},{key:"randomPosition",value:function(){return[x(0,this.width),x(0,this.height)]}},{key:"randomPositionAlongLine",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,r=Object(w.a)(e,2),a=r[0],i=r[1],o=Object(w.a)(t,2),s=o[0],c=o[1],l=[Math.abs(a-s),Math.abs(i-c)],u=l[0],h=l[1];if(0===u){var d=x(0,this.height);return[a,d]}if(0===h){var f=x(0,this.width);return[f,i]}var m=h/u,g=-(m*a-i),p=Math.floor(x(0,this.width)),y=Math.floor(m*p+g),v=n||1;return[p+x(-v,v),y+x(-v,v)]}},{key:"volcanoes",get:function(){var e=this;if(0===this.mountainSpots.length){var t=Math.floor(1.6*this.areaPercent),n=[this.randomPosition(),this.randomPosition()],r=n[0],a=n[1],i=P((function(){return e.randomPositionAlongLine(r,a)}),t,!1),o=P((function(){return e.randomPosition()}),t,!1);this.mountainSpots=[].concat(Object(He.a)(i),Object(He.a)(o))}return this.mountainSpots}},{key:"genHeightmap",value:function(){var e="Hadean"===this.aeon;this.elevation.geoform(e,this.ticks<3?this.volcanoes:[])}},{key:"buildTerrain",value:function(){var e=this;this.terrain.each((function(t,n,r){var a=e.elevation.at(t,n);a>=9?e.terrain.write("^",t,n):a<=4?e.terrain.write(M(["~",","]),t,n):e.terrain.write(".",t,n)}))}},{key:"growVegetation",value:function(){var e=this,t="'",n=".",r=[t,'"',n],a=this.elevation.seaLevel,i=this.elevation.maxHeight/2;this.vegetation.step((function(o,s,c){var l;if(t===o)return t;var u=r.includes(o),h=(l=e.elevation).at.apply(l,Object(He.a)(c));if(h>i||h<a)return"";var d=s.filter((function(e){return r.includes(e)})).length;if(u){if(d>0&&'"'===o)return o;if(2===d||3===d)return n;if(6===d)return t;if(7===d)return'"'}else{if(2===d)return n;if(x(0,1e3)<32)return n}return""}))}},{key:"trees",get:function(){var e=["'",'"'],t=[];return this.vegetation.each((function(n,r,a){e.includes(a)&&t.push([n,r])})),t}},{key:"area",get:function(){return this.width*this.height}},{key:"evolution",value:function(e,t){e.resources;t>0&&t<=this.mapgenTicks&&(this.genHeightmap(),this.growVegetation())}}]),n}(ce),Object(y.a)(Xe.prototype,"tileInspect",[v.a],Object.getOwnPropertyDescriptor(Xe.prototype,"tileInspect"),Xe.prototype),Object(y.a)(Xe.prototype,"randomPosition",[v.a],Object.getOwnPropertyDescriptor(Xe.prototype,"randomPosition"),Xe.prototype),Object(y.a)(Xe.prototype,"randomPositionAlongLine",[v.a],Object.getOwnPropertyDescriptor(Xe.prototype,"randomPositionAlongLine"),Xe.prototype),Object(y.a)(Xe.prototype,"evolution",[v.a],Object.getOwnPropertyDescriptor(Xe.prototype,"evolution"),Xe.prototype),Xe),st=new ot,ct=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=t.man,i=t.woman,o=t.son,s=t.daughter,c=t.crown,l=t.place,u=t.tree,h=t.sleep,d=t.flower,f=t.beauty,m=t.great,p=t.small,y=t.water,v=t.safe,b=t.light,j=t.shadow,w=t.one,k=t.many,O=t.joy,x=t.sorrow,M=t.sweet,S=t.bitter,E=t.point,A=t.heat,P=t.cold,I=t.tall,N=t.deep,C=t.bell,F=t.mound,T=t.run,D=t.sing,z=t.way,q=t.no,B=t.at,W=t.eat,_=t.drink,L=t.good,H=t.bad,J=t.quick,R=t.time,U=t.air,G=t.cut,V=t.all,K=t.hard,X=t.soft,Y=t.color,Q=t.ore,Z=t.wing,$=t.snake,ee=t.horse,te=t.bear,ne=t.dog,re=t.fear,ae=t.death,ie=t.tooth,oe=t.heart,se=t.over,ce=t.high,le=t.fight,ue=t.mere,he=t.strong,de={"-person":a,"-man":a,"-woman":i,"-maid":p+i,"-son":o,"-daughter":s,cove:G+y,star:X+b,daisy:C+d,poppy:h+d,dandelion:c+d,willow:x+u,cherry:L+u,spruce:M+u,pine:S+u,birch:p+u,elm:I+u,oak:K+u,holly:O+u,king:c+a,queen:c+i,sea:m+y,lake:y+l,pool:y+ue,haven:v+l,forest:u+l,people:a+i,ice:S+P,prison:S+x,jewel:p+f,needle:S+E,candle:A+E,hill:p+F,mountain:F+l,valley:z+l,peak:E+l,mound:F+l,land:a+l,lofty:m+ce,sky:ce+se,low:p+w,river:y+z,isle:y+l,island:N+y,wine:O+_,honey:M+_,apple:p+W,bread:L+W,elderberry:v+W,fish:p+J,harvest:u+G,night:j+R,garden:d+l,vault:G+l,white:b+Y,black:j+Y,green:u+Y,red:A+Y,blue:P+Y,morning:b+R,evening:j+R,noon:ce+b,fire:A+b,tin:X+Q,silver:f+Q,gold:N+Q,bird:J+Z,birds:L+Z,horses:ee,elephants:m+ee,bears:te,snakes:$,wolves:H+ne,hounds:L+ne,large:I+m,tiny:p+p,thirst:q+_,wax:X+J,veil:p+X,fortunate:m+L,beautiful:m+f,music:a+D,abundant:k+k,teeth:k+ie,battle:k+a+le,dark:q+b,wood:u+Q},fe=de.fire,me=de.red,ge=de.cove,pe=de.vault,ye=de.star,ve=de.night,be=de.ice,je=de.harvest,we=de.river,ke=de.mountain,Oe=de.king,xe=de.land,Me=de.lofty,Se=de.sky,Ee=de.low,Ae=de.people,Pe=de["-person"],Ie=de.white,Ne=de.black,Ce=de.morning,Fe=de.evening,Te=de.noon,De=de.bird,ze=de.large,qe=de.thirst,Be=de.music,We=de.teeth,_e=de.battle,Le=de.wood,He={bay:ge+l,harbor:v+ge,dragons:he+Z+$,swans:f+De,eagles:Me+De,nightingales:Fe+De,iron:he+Q,dusk:Ce+Fe,gray:Ie+Ne,orange:je+Y,afternoon:N+Te,midnight:N+Fe,lily:ye+d,rose:me+d,divine:m+Oe,princess:Oe+s,prince:Oe+o,kingdom:Oe+l,fortress:Oe+v,citadel:k+Ae,stronghold:v+Ae+N,tower:I+se,"mountain-chain":k+ke,friend:M+Pe,foe:S+Pe,lord:Me+Pe,slave:Ee+Pe,rain:Se+y,earth:k+xe,glen:we+xe,stream:p+we,realm:w+l,region:k+we,peoples:k+Ae,road:V+Pe,path:T+z,shade:N+j,sun:Se+b,moon:ve+b,autumn:je+R,winter:S+R,spring:d+R,summer:A+R,cloud:Se+y,cloudy:Se+y,"ever-":V+R,"-less":q,"at-":B,stars:k+ye,day:b+R,starlight:ye+b,spark:he+fe,snow:Se+P,mist:X+Se,firmament:he+pe,wind:he+U,rainbow:Y+Se,frost:K+be,dew:Ce+y,dread:re+Oe,lonely:w+B+ue,giant:ze+a,awe:m+re,ash:fe+ae,steam:fe+y,magma:fe+we,dry:A+qe,food:W+je,space:m+Me,dark:N+j,broad:N,voice:Pe+Be,war:m+_e,laughter:O+Be,silence:X+Be},Je=He.dread,Re=He.ash,Ue=He.rainbow,Ge=He.dry,Ve=He.food,Ke=He.space,Xe=He.dark,Ye=He.broad,Qe=He.orange,$e=He.divine,et=He.voice,tt=He.iron,nt=He.spark,rt=He.silence,at=Object(g.a)(Object(g.a)(Object(g.a)(Object(g.a)({},t),de),He),{},{sparkling:k+nt,horror:Ne+Je,embers:Re,soot:Ne+Re,radiance:Ue+Y,salt:Ge+Ve,void:q+Ke,gloom:Xe+Ne,narrow:q+Ye,wide:Ye,sharp:Je+E,pale:X+Ie,golden:Ie+Qe+f,holy:$e+O,dusty:Ge+X,fell:P+re,secret:Xe+rt,bold:he+et,splendid:Ue+b,horns:k+Je+E,claws:H+E,fangs:Je+We,love:oe+Pe,dream:h+Be,fate:$e+fe,speech:k+et,tomorrow:R+R,spirit:b+$e,tyranny:H+Oe,magic:$e+nt,thought:b+R,skill:L+Pe,freedom:he+Ae,blood:me+y,tears:x+y,ship:y+Le,journey:l+R,treasure:L+O,smith:tt+Pe},n);return new Ze(e,at,(function(e){return Object.keys(r).forEach((function(t){e.includes(t)&&(e=e.replaceAll(t,r[t]))})),e}))}("Khuzdul",{beauty:"kib",ore:"il",water:"-na",way:"la",air:"aer",all:"ere",at:"es-",bad:"nu",bear:"gruw",bell:"bjel",bitter:"m\xe9",cold:"\xed",color:"o",crown:"ar",cut:"kh",daughter:"al",death:"lun",deep:"yse",dog:"hu",drink:"ik",eat:"zu",fear:"ga",fight:"kla",flower:"ela",good:"lu",great:"agh",hard:"ekh",heart:"eru",heat:"-hrond",high:"tl",horse:"raph",joy:"-hyt",light:"ia-",man:"-rhd",mantle:"-mant\xe9",many:"ah",mere:"sea",mound:"haeth",no:"u-",one:"eru",over:"ya-",place:"n-",point:"-zirak",quick:"ea-",run:"r",safe:"-c\xfaa",shadow:"uz",sing:"ina",sleep:"-dre",small:"eai",snake:"lug",soft:"i",son:"on",sorrow:"srg",strong:"elu",sweet:"hlor",tall:"mu-",time:"an",tooth:"tur",tree:"an",wing:"hla",woman:"an"},Object(g.a)(Object(g.a)({},{mist:"nevel"}),{speech:"agl\xe2b",lord:"uzbad",path:"n\xe2la",river:"n\xe2la",water:"n\xe2la",black:"nar\xe2g",cloud:"shath\xfbr",lake:"z\xe2ram",pool:"z\xe2ram",silver:"kibil-",stream:"\xfbl",horn:"inbar",fortress:"gathol",dark:"azan",red:"baraz",valley:"duban",great:"gabil",delve:"d\xfbm",autumn:"sal\xf4n"}),{kibeah:"ea",ia:"e",hrond:"th",ee:"i",ae:"e",elu:"lu",esa:"as",gh:"g",hd:"d",ag:"s",anan:"a",he:"e",rdn:"t",ly:"i",ah:"r",tl:"r",yse:"is",ss:"z",srg:"zh",sre:"se","a r":"ah","l m":"n","g m":"k",aa:"u",thn:"t",eo:"u",rdr:"l",sna:"se","a s":"sh","th s":"st","th u":"w",eai:"a",kho:"cu",sr:"sur",iti:"ut",rg:"u",thz:"thus",ise:"se",dre:"li",rdi:"no",na:"r",rr:"r",tth:"shi",serl:"ar",ahie:"agorn",uu:"w",wz:"yrs",st:"m",cuk:"kh",rdz:"ts",rl:"l",wts:"uz",tiu:"reg",lt:"nd"}),lt=ct,ut={lenlond:"llin"},ht=new Ze("Westron",{heat:"h\u01e3te",cold:"cheald",abundant:"ofer",afternoon:"ofern\xf3n",apple:"\xe6ppel",autumn:"h\xe6rfest",awe:"ondrysnu",battle:"gefeoht",bay:"berie",bears:"bruin",beautiful:"cyrten",bell:"cnyll",birch:"beorc",bitter:"\u0101for",birds:"bord",black:"murk",blood:"blod",blue:"bl\xe1r",bold:"baldor",bread:"hl\xe1f",candle:"condell",cherry:"cirse",citadel:"burhf\xe6sten",claws:"clif",cloudy:"genipfull",daisy:"d\xe6ges",dandelion:"\xe6g-wyrt",day:"d\xe6g",dark:"dearc",deep:"deop",dew:"deaw",divine:"t\xfdr",dragons:"f\xfdrdraca",dread:"br\xf3ga",dream:"dr\u0113am",dusk:"dosk",dusty:"dystig",eagles:"earn",earth:"aarde",elderberry:"elder",elephants:"elpend",elm:"wych",evening:"\u01e3fnung",fangs:"-fon",fate:"d\xe9a\xfewyrd",fell:"fiellan",fire:"f\xfdr",firmament:"heofon",fish:"fisc",foe:"-\u0121ef\u0101h",forest:"forwest",fortress:"healden",fortunate:"e\xe1deg",freedom:"freodom",friend:"fr\u0113ond",frost:"hr\u012bm",giant:"\u0113oten",glen:"glyn",gloom:"gl\u014dm",gold:"guld",golden:"gylden",gray:"gr\xe6g-",great:"\xe6rgod",green:"grene",harbor:"hyth",haven:"-haff",hill:"-holm",holy:"h\u0101li\u0121",honey:"huni\u0121",horns:"kern",horror:"fyrhtu",horses:"eoh",ice:"\u012bs",iron:"\xedsen",isle:"yle",island:"\u012begland",jewel:"si\u0121el",journey:"faru",joy:"wynn",king:"kenning",kingdom:"kenningdom",laughter:"hleahtor",lake:"lac",land:"lond",large:"rum",light:"leoht",lily:"lilie",lofty:"hoch",lonely:"-syndrig",lord:"fr\u0113a",love:"leof",magic:"r\xfan",mantle:"mantel",midnight:"midnyght",mist:"-hase",moon:"m\u0113n\xf4",morning:"-morn",mound:"tel-",mountain:"munt-",music:"dr\xe9am",narrow:"nearunes",needle:"n\xe6dl",night:"nyght",nightingales:"st\xe6rlinc",noon:"noon",oak:"eik",orange:"orenge",pale:"wann-",path:"pade-",peak:"piic",peoples:"-folk",pine:"pintreow",place:"-stead",point:"-gad",pool:"-cl\xe6ne",poppy:"popi\u0121",prison:"-cweartern",quick:"cwic",rain:"re\u0121n",rainbow:"re\u0121nboga",realm:"-r\xedce",red:"reod-",region:"-guard",river:"-ex",road:"r\u0101d",rose:"ros",sea:"s\u01e3",secret:"d\u0113agol",shade:"sceadu",shadow:"sceaduwe",sharp:"sharp",ship:"scip",silence:"sw\u012b\u0121e",silver:"seolfor",skill:"cr\xe6ft",sky:"heofon",slave:"tr\xe4l",small:"sm\xe6l",smith:"-wyrhta",snakes:"natra",snow:"sn\xe1w",sorrow:"sorh",spark:"ysl",sparkling:"bladesung",speech:"spr\u01fdc",spirit:"arodnes-",splendid:"from",spring:"lencten",spruce:"s\xe6ppe",starlight:"tunglenleoht",stars:"-tunglen",stream:"str\u0113am",stronghold:"-f\xe6sten",summer:"haf",sun:"sunu",swans:"ilfetu",sweet:"sw\xe9te",tall:"brant-",tears:"hr\xf3p",thought:"th\xf3ht",tin:"-zin",tiny:"tyne*",tomorrow:"t\u014dmorgen",tower:"stipel-",treasure:"sinc",tyranny:"m\xe1nbealu",valley:"d\xe6l",veil:"oferbr\xe6",water:"w\xe6ter",wax:"weax",white:"albe",wide:"w\u012bd",willow:"welig",wind:"gwynt",wine:"-win",winter:"yver",holly:"holen-",garden:"gewyrt\xfan",queen:"cw\xe6n",prince:"fyrste",princess:"in\xedon",cloud:"genip",hounds:"hund",wolves:"wulf",embers:"\u01e3myr\u0121e",soot:"hrum",ash:"asce",salt:"sealt",void:"r\u016bm",steam:"st\xf4m",magma:"hraun",radiance:"gl\xe6m","-less":"no-","ever-":"\u01e3fre-","at-":"\xe6t-","-person":"-wight","-man":"-man","-son":"-ing","-woman":"-fro","-maid":"-maga\xf0","-daughter":"-dohtor","mountain-chain":"beorgstede"},(function(e){return Object.keys(ut).forEach((function(t){e.includes(t)&&(e=e.replaceAll(t,ut[t]))})),e})),dt=new Ze("Common",{heat:"hete",cold:"cold",cloud:"cloud",cloudy:"cloudy",daisy:"woundwort",dandelion:"puffball",dragons:"drake",dark:"derk",island:"ylond",abundant:"abounding",afternoon:"overnoon",apple:"pome",autumn:"fall",awe:"wonder",battle:"batell",bay:"bay",bears:"bera",beautiful:"lovesome",bell:"belle",birch:"birce",birds:"bord",bitter:"bittre",black:"merk-",blood:"blood",blue:"blew",bold:"bolt",bread:"bred",candle:"candel",cherry:"cherie",citadel:"city-hold",claws:"clawe",day:"daye",deep:"deepe",dew:"deaw",divine:"gode",dread:"drede",dream:"dreame",dusk:"eventide",dusty:"dusti",eagles:"egle",earth:"erthe",elderberry:"elder",elephants:"olifant",elm:"elme",evening:"evenyng",fangs:"fangtooth",fate:"doom",fell:"fellen",fire:"fier",firmament:"heven",fish:"fisch",foe:"faman",forest:"foreste",fortress:"holden",fortunate:"lukky",freedom:"freodom",friend:"fr\u0113ond",frost:"ryme",giant:"giaunt",glen:"gleann",gloom:"gloam",gold:"gold",golden:"gulden",gray:"grey",great:"great",green:"gre",harbor:"hyth",haven:"-havene",hill:"-hyll",holy:"h\u0101li\u0121",honey:"huni\u0121",horns:"horne",horror:"fyrhtu",horses:"eoh",ice:"is-",iron:"iren-",isle:"yl-",jewel:"jeuel",journey:"journe",joy:"joye",king:"kenning",kingdom:"kenningdom",laughter:"laughtre",lake:"lac",land:"-land",large:"larc",light:"lighte",lily:"lilly",lofty:"lofte",lonely:"lone",lord:"lord",love:"love",magic:"magyk",mantle:"-cloke",midnight:"midnyght",mist:"-fog",moon:"mone",morning:"-morn",mound:"-hyll",mountain:"mount",music:"musika",narrow:"narrowe",needle:"nedle",night:"nyght",nightingales:"thrush",noon:"noon",oak:"oak",orange:"orenge",pale:"bleek-",path:"peth",peak:"peek",peoples:"-folk",pine:"pyne",place:"-stead",point:"-point",pool:"-pole",poppy:"celandine",prison:"gaole",quick:"quic",rain:"rain",rainbow:"rainbow",realm:"ward",red:"reod-",region:"-regioun",river:"ryver",road:"rode",rose:"rose",sea:"see",secret:"secrette",shade:"shade",shadow:"schadowe",sharp:"sharp",ship:"shippe",silence:"stilnes",silver:"argent",skill:"skille",sky:"skie",slave:"thralle",small:"smal",smith:"-wright",snakes:"addere",snow:"snow",sorrow:"sorwe",spark:"sparke",sparkling:"glitre",speech:"speche",spirit:"g\u0101st-",splendid:"splendur",spring:"springen",spruce:"spruse",starlight:"sterrelighte",stars:"-sterre",stream:"str\u0113am",stronghold:"-stranghalde",summer:"-sumer",sun:"sun",swans:"swan",sweet:"sweete",tall:"-talle",tears:"cryinge",thought:"thoughte",tin:"tin",tiny:"tyny",tomorrow:"tomorwe",tower:"torr-",treasure:"tresour",tyranny:"tirranye",valley:"valeye",veil:"veyl",water:"watir",wax:"waxe",white:"hwit",wide:"wyd",willow:"willow",wind:"wynd-",wine:"-wyn",winter:"wintre",holly:"holi-",garden:"gardyn",queen:"cwen",prince:"prince",princess:"princess",hounds:"hound",wolves:"wolf",embers:"embre",soot:"soote",ash:"ash",salt:"salt",void:"voide",steam:"steem",magma:"lava",radiance:"gleam","-less":"no-","ever-":"even-","at-":"by--","-person":"-persoun","-man":"-man","-son":"-sonn","-woman":"-weoman","-maid":"-mayden","-daughter":"-doughter","mountain-chain":" mountayne"}),ft=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,"Language Explorer")).dictionary=e,r.t=function(){var e;return(e=r.dictionary).translate.apply(e,arguments)},r.check=function(e){for(var t,n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];var o=(t=r).t.apply(t,a);return e.forEach((function(e){o===e&&(o="*".concat(o))})),o},r.notes=Object(g.a)({"*lang":function(){return"".concat(r.dictionary.languageName," Phrasebook")},'"Nightingale"':function(){return r.check(["Tinuviel","Luthien"],"spark","-maid")},"Silver River":function(){return r.check(["Celebrant","Kibiln\xe2la"],"silver","river")},"Haven of the Gods":function(){return r.check(["Avall\xf3n\xeb","Asgard"],"at-","divine")},"Swan Haven":function(){return r.check(["Alqualond\xeb","Ealac\xfaan"],"swans","haven")},"Star-Eagle":function(){return r.check(["Thorongil","Aragorn"],"eagles","stars")},"Dream Island":function(){return r.check(["L\xf3rien"],"dream","island")},"Lonely Isle":function(){return r.check(["Tol Eress\xeba"],"isle","lonely")},"Land of Pines":function(){return r.check(["Dorthonion"],"land","pine")},"Mound of Summer":function(){return r.check(["Corollair\xeb"],"mound","summer")},"Tall White Point":function(){return r.check(["Taniquetil"],"tall","white","point")},"Spirit of Fire":function(){return r.check(["F\xebanor"],"spirit","fire")},"Magic Woman":function(){return r.check(["L\xfbthien"],"magic","-woman")},"Mountains of Tyranny":function(){return r.check(["Thangorodrim"],"tyranny","mountain-chain")},"Fire Stronghold":function(){return r.check(["Norgothrond"],"fire","stronghold")},"Grey-Mantle":function(){return r.check(["Thingol"],"gray","mantle")},"Iron Prison":function(){return r.check(["Angband"],"iron","prison")},"Black Foe":function(){return r.check(["Morgoth"],"black","foe")},"Icy Fangs":function(){return r.check(["Helcarax\xeb"],"ice","fangs")},"Ever-White":function(){return r.check(["Oioloss\xeb"],"ever-","snow")},"Mist-Needle":function(){return r.check(["Hithaeglin"],"mist","needle")},"Mist-Shadow":function(){return r.check(["Hithlum"],"mist","shadow")},"Pale-horn Mountains":function(){return r.check(["Ered Nimrais"],"mountain","pale","horns")},Shipmaker:function(){return r.check(["C\xedrdan"],"ship","smith")},"Land of Holly":function(){return r.check(["Eregion"],"holly","land")},"Fate Hill":function(){return r.check(["Amon Amarth"],"hill","fate")},"Golden Hill":function(){return r.t("hill","golden")},"Pathless Sea":function(){return r.t("-less","path","sea")},"Star-Music":function(){return r.t("stars","music")},"Bell-Star":function(){return r.t("bell","stars")},"*dictionary":function(){return"".concat(r.dictionary.languageName," Dictionary")}},Object.fromEntries(Qe.sort().map((function(e){return[e,function(){var t=r.t(e);return t.length>9?"%".concat(t):t}]})))),r.actions.create({name:"Common",act:function(){return r.dictionary=dt}}),r.actions.create({name:"Westron",act:function(){return r.dictionary=ht}}),r.actions.create({name:"Sindarin",act:function(){return r.dictionary=rt}}),r.actions.create({name:"Khuzdul",act:function(){return r.dictionary=lt}}),r}return n}(ce),mt=new ft(lt),gt=n(13);function pt(e){var t="";switch(e.toString().slice(-1)){case"1":t="st";break;case"2":t="nd";break;case"3":t="rd";break;case"4":case"5":case"6":case"7":case"8":case"9":case"0":t="th"}return e.toString()+t}var yt=["dragon","elephant","bear","horse","snake","hound","swan","eagle","nightingale","wolf","cherry","lily","rose","apple","fish","moon","birch","deer","elk","bear","lizard","mouse","pig","owl","tiger","goat","monkey","rooster","rabbit","lion","falcon","cloud","fireball","bell","thimble","cup","boat","dial","bead","cube","sphere","pyramid","spiral","robot","alien"],vt=new(function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(l.a)(this,n),(e=t.call(this,"Citadel")).folks=void 0,e.recipes=void 0,e.notes={date:function(){return e.date.description},time:function(){return e.date.time}},e.ticksPerMinute=5,e.createCitizen=function(t){var n=M(["masculine","feminine"]),r=function(e){var t,n="masculine"===e?["-person","-man","-son"]:["-woman","-maid","-daughter"],r=S(x(1,3),Qe),a=[].concat(Object(He.a)(r),Object(He.a)(x(0,12)>9?[M(n)]:[]));return{name:(t=M([ht])).translate.apply(t,Object(He.a)(a)).trim(),concepts:r}}(n),a=r.name,i=r.concepts,o=a.split(" ")[0],s=e.folks.create({name:a,soul:ee(n),nameConcepts:i});"Artisan"===t?(s.traits.add(1,"Sculpting"),s.traits.add(1,"Mining")):"Hunter"===t?s.traits.add(1,"Hunting"):"Fisherman"===t?s.traits.add(1,"Fishing"):"Merchant"===t&&s.traits.add(1,"Trading"),s.things.add(40,"Energy"),s.things.add(100,"Max Energy"),s.things.add(80,"Satiety"),s.things.add(100,"Max Satiety"),s.things.add(80,"Joy"),s.things.add(100,"Max Joy"),s.things.add(100,"Shells");var c={dragon:"dragons",elephant:"elephants",bear:"bears",horse:"horses",snake:"snakes",hound:"hounds",wolf:"wolves",swan:"swans",eagle:"eagles",nightingale:"nightingales",rooster:"morning",toad:"evening",owl:"night",lion:"bold",falcon:"quick"},l=M(yt);if(Ue(i,(function(e){return yt.includes(e)||Object.values(c).includes(e)}))){var u=yt.find((function(e){return i.includes(e)||i.includes(c[e])}));u&&(l=u)}s.items.create({name:"".concat(M(["Little","Tiny"])," Stone ").concat(fe(l)),description:"".concat(o,"'s Personal Totem"),kind:"sculpture",quality:M(["excellent","good"]),size:"fine",material:"stone"}),s.meters=function(){var t=e.folks.jobs.get(s);return Object(g.a)({Energy:function(){return{value:s.things.count("Energy"),max:s.things.count("Max Energy")}},Satiety:function(){return{value:s.things.count("Satiety"),max:s.things.count("Max Satiety")}},Joy:function(){return{value:s.things.count("Joy"),max:s.things.count("Max Joy")}}},void 0!==t?Object(gt.a)({},t.recipe.name,(function(){var n=t.recipe,r=t.startedAt,a=n.time;return{value:r?e.ticks-r:-1,max:a}})):{Idle:function(){return{value:0,max:0}}})}},e.evolution=function(t,n){t.resources;e.folks.list().forEach((function(t){return e.evolveIndividual(t,t.things)}))},e.evolveIndividual=function(t,n){var r=.01,a=.012,i=.001,o=n.count("Energy"),s=n.count("Max Energy"),c=n.count("Satiety"),l=n.count("Max Satiety"),u=n.count("Joy"),h=n.count("Max Joy");o>s&&n.remove(o-s,"Energy"),o>0&&n.remove(r,"Energy"),c>l&&n.remove(c-l,"Satiety"),c>0&&n.remove(a,"Satiety"),u>h&&n.remove(u-h,"Joy"),u>0&&n.remove(i,"Joy");var d=e.folks,f=e.recipes,m=f.eat,g=f.rest,p=f.idle,y=f.vibe,v=f.hunt,b=f.fish,j=f.trade,w=f.create,k=f.mine,O=function(n){d.jobs.set(t,{recipe:n,startedAt:e.ticks})},S=d.jobs.get(t),E=n.count("Meat"),A=n.count("Fish"),P=A+E+n.count("Berry"),I=!1;if(S){var N=S.recipe,C=S.startedAt,F=!1,T=C?e.ticks-C:-1,D=N.time,z=N.probability;void 0===D?(I=!0,F=!0):T>D&&(I=!0,F=void 0===z||x(0,100)<=100*z),F&&e.produceTaskOutcome(N,t)}if(void 0===S)if(P<5)console.log("food less than five, trade?!"),O(j);else if(E>10||A>10)O(j);else if("night"===e.date.timeOfDay&&o<70)O(g);else if(o<40)O(g);else if(c<65&&P>0)O(m);else if(u<40)O(y);else if("morning"===e.date.timeOfDay||"afternoon"===e.date.timeOfDay){var q=[w];t.traits.count("Hunting")>0?q.push(v):t.traits.count("Fishing")>0?q.push(b):t.traits.count("Mining")>0&&q.push(k),O(M(q))}else O(c<70&&P>0?m:u<90?y:p);I&&e.folks.jobs.set(t,void 0)},e.evolve(e.evolution),e.folks=e.people.create("Folks");var r=e.folks.recipes.create({name:"Fish",time:500,probability:.45,produces:{Meat:2}}),a=e.folks.recipes.create({name:"Hunt",time:240,probability:.52,produces:{Fish:1}}),i=e.folks.recipes.create({name:"Rest",time:1900}),o=e.folks.recipes.create({name:"Eat",time:200}),s=e.folks.recipes.create({name:"Vibe",time:777}),c=e.folks.recipes.create({name:"Ready",time:180}),u=e.folks.recipes.create({name:"Gather",time:1234}),h=e.folks.recipes.create({name:"Trade",time:300,onSuccess:e.trade}),d=e.folks.recipes.create({name:"Trade",time:300,produces:{Stone:10}}),f=e.folks.recipes.create({name:"Sculpt",time:1700,consumes:{Stone:5}});e.recipes={fish:r,hunt:a,rest:i,eat:o,vibe:s,idle:c,gather:u,trade:h,create:f,mine:d};return["Hunter","Fisherman","Artisan"].forEach((function(t){return e.actions.create({name:"New ".concat(t),act:function(){return e.createCitizen(t)}})})),e.resources.add(100,"Meat"),e.resources.add(100,"Fish"),e}return Object(u.a)(n,[{key:"produceTaskOutcome",value:function(e,t){var n=t.things,r=n.count("Energy"),a=n.count("Max Energy"),i=n.count("Satiety"),o=n.count("Max Satiety"),s=n.count("Joy"),c=n.count("Max Joy"),l=n.count("Meat"),u=n.count("Fish"),h=u+l+n.count("Berry"),d=this.recipes,f=d.eat,m=d.rest,g=d.vibe,p=d.fish,y=d.gather,v=d.trade,b=d.create,j=2,w=3,k=12,O=10,S=4,E=25;if("Hunt"===e.name)n.add(1+x(0,w),"Meat");else if(e===p)n.add(1+x(0,j),"Fish");else if(e===y)n.add(3+x(0,k),"Berry");else if(e===m)r<a&&n.add(75,"Energy");else if(e===g)s<c&&n.add(35,"Joy");else if(e===b){var A=t.traits.count("Sculpting"),P=M(yt),I=A>0?M(["fine","small","medium","large"]):"small",N=x(0,25)+25*x(0,A),C="adequate";N<10&&(C="terrible"),N>10&&(C="good"),N>25&&(C="excellent");var F="A ".concat([{fine:"tiny",small:"little",medium:"big",large:"huge",huge:"gigantic"}[I],"stone",P].join(" ")," by ").concat(t.name.split(" ")[0]),T="This ".concat(P," was carved from stone by ").concat(t.name,".\n                             Its ").concat(M(["aspect","expression","countenance"])," is ").concat(M(["worried","profound","angered","aroused","elephantine","persecuted","annoyed","striving","seeking","cautious","terrible","sullen","dismal","joyous","surprised","happy","content","confused","terrified","gentle","stern","distant","suspicious","firm","stark","bewildered","chaotic","generous","benevolent","poetic","sublime","shocked","appalled","amused","determined","devoted","meandering","suspect","ferocious","feral","hungry"]));T+="excellent"===C?"".concat(M([" yet"," but"," and","; however, it",". It"]),"\n                            ").concat(M(["conveys","suggests","intimates","exudes","presents"]),"\n                            ").concat(M(["a strong","a subtle","a quiet","an understated","an unmistakable","a lasting","a remarkable"]),"\n                            ").concat(M(["feeling","sense","impression"])," of ").concat(M(["menace","daring","outrage","resonance","rapidity","wealth","poverty","righteousness","loss","victory","foundation","beauty","holiness","covetousness","anxiety","productivity","holism","concern","care","generosity","faith","temporality","illusoriness","elusiveness","chaos","purity","space","time","worldliness","ugliness","hatred","appreciation","coldness","cruelty","grace","facility","spareness","lack","plenitude","indulgence","innocence","parsimony"]),"."):".",t.items.create({name:"Stone ".concat(fe(P)),kind:"sculpture",size:I,quality:C,description:F,longDescription:T})}else if(e===f){if(i<.8*o){var D=n.count("Fish"),z=n.count("Meat"),q=n.count("Berry");D>0?(n.remove(1,"Fish"),n.add(25,"Satiety")):z>0?(n.remove(1,"Meat"),n.add(25,"Satiety")):q>0?(n.remove(1,"Berry"),n.add(15,"Satiety")):console.warn("hungry but no food!")}}else if(e===v){var B=n.count("Shells");if(console.log("i have "+B+"shell"),h<5){var W=this.resources.count("Meat"),_=this.resources.count("Fish");if(console.log("low on food...",{shells:B,storeMeat:W,storeFish:_}),B>10&&W>0){var L=Math.min(W,Math.floor(B/O));console.log("Trade shells for ".concat(L," meat!")),this.resources.remove(L,"Meat"),n.add(L,"Meat"),n.remove(L*O,"Shells")}else if(B>6&&_>0){var H=Math.min(_,Math.floor(B/S));console.log("Trade shells for ".concat(H," fish!")),this.resources.remove(H,"Fish"),n.add(H,"Fish"),n.remove(S*H,"Shells")}}if(u>10){var J=u-10;this.resources.add(J,"Fish"),n.remove(J,"Fish"),n.add(J*S,"Shells")}if(l>10){var R=l-10;this.resources.add(R,"Meat"),n.remove(R,"Meat"),n.add(R*O,"Shells")}if(n.count("Clay Pot")>0){var U=n.count("Clay Pot");this.resources.add(U,"Clay Pot"),n.remove(U,"Clay Pot"),n.add(U*E,"Clay Pot")}var G=t.items.list().find((function(e){return!e.description.includes("Personal")}));if(G){console.log("SELL ITEM "+G.name+"!!"),t.items.delete(G.name);var V=1e3*(G.material?{wood:.8,clay:.95,stone:1.3,iron:2.5}[G.material]:.1)*(G.quality?{terrible:.5,adequate:1.2,good:1.5,excellent:2}[G.quality]:.1);console.log("---\x3e Sold "+G.description+" for "+V),n.add(V,"Shells")}}}},{key:"date",get:function(){var e=Math.floor(this.ticks/this.ticksPerMinute),t=Math.floor(e/60),n=Math.floor(t/24),r=Math.floor(n/7),a=Math.floor(r/12),i=Math.floor(e)%60,o=Math.floor(t%24),s=Math.floor(n%7),c=["winter","spring","summer","autumn"][Math.floor(a%4)],l=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][Math.floor(r/4)%12],u=["Mon","Tues","Wed","Thu","Fri","Sat","Sun"][s],h=(n+1)%30,d=["night","morning","afternoon","evening"][Math.floor(o/6)%4],f=o>=12?"pm":"am",m=o%12===0?12:o%12;return{dayOfWeek:u,timeOfDay:d,description:"".concat({winter:"\u2744\ufe0f",summer:"\ud83c\udf34",spring:"\ud83c\udf31",autumn:"\ud83c\udf42"}[c]," ").concat(u,", ").concat(l," ").concat(pt(h)),time:"".concat({morning:"\ud83c\udf05",afternoon:"\ud83c\udfd9\ufe0f",evening:"\ud83c\udf06",night:"\ud83c\udf03"}[d]," ").concat(String(m),":").concat(String(i).padStart(2,"0")," ").concat(f.toUpperCase())}}},{key:"trade",value:function(e){console.log("hit trade job complete callback!!!")}}]),n}(De)),bt=[vt,st,new(function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(l.a)(this,n),(e=t.call(this,"Citizen")).subject=void 0,e.nameMeaning=void 0,e.recipes=void 0,e.newPerson=function(){var t=function(){var e,t=Z("A Social Group"),n="male"===M(["male","female"])?["-person","-man","-son"]:["-woman","-maid","-daughter"],r=S(x(1,2),Qe),a=[].concat(Object(He.a)(r),Object(He.a)(x(0,12)>9?[M(n)]:[])),i=(e=M([rt,lt,ht,dt])).translate.apply(e,Object(He.a)(a)).trim(),o=r.map((function(e){return fe(e)})).reverse().join("-").trim();return{person:oe(i===o?i:i+" ("+o+")",t),nameMeaning:o}}(),n=t.person,r=t.nameMeaning,a=e.people.lookup("Self");a.remove(a.count);var i=a.create(n);return i.meters=function(){return{Energy:function(){return{value:e.resources.count("Energy"),max:e.resources.count("Max Energy")}},Satiety:function(){return{value:e.resources.count("Satiety"),max:e.resources.count("Max Satiety")}},Joy:function(){return{value:e.resources.count("Joy"),max:e.resources.count("Max Joy")}}}},{person:i,nameMeaning:r,recipes:{fish:a.recipes.create({name:"Fish"}),hunt:a.recipes.create({name:"Hunt"}),rest:a.recipes.create({name:"Rest"}),eat:a.recipes.create({name:"Eat"}),idle:a.recipes.create({name:"Vibe"})}}},e.evolution=function(t,n){var r=t.resources;n%25===0&&e.evolveIndividual(r,n%250===0)},e.evolveIndividual=function(t,n){var r=t.count("Energy"),a=t.count("Max Energy");r>a&&t.remove(r-a,"Energy"),r>0&&t.remove(.03,"Energy");var i=t.count("Satiety"),o=t.count("Max Satiety");i>o&&t.remove(i-o,"Satiety"),i>0&&t.remove(.02,"Satiety");var s=t.count("Joy"),c=t.count("Max Joy");s>c&&t.remove(s-c,"Joy"),s>0&&t.remove(.001,"Joy");var l=e.people.lookup("Self"),u=e.recipes,h=u.eat,d=u.rest,f=u.idle,m=u.hunt,g=u.fish,p=function(t){return l.jobs.set(e.subject,{recipe:t,startedAt:e.ticks})},y=l.jobs.get(e.subject);if(y){var v=y.recipe;if(v===m||v===g)x(0,100)<=24&&(v===m?t.add(1+x(2,5),"Meat"):v===g&&t.add(x(0,2)+x(0,2),"Fish"));else if(v===d)r<a?t.add(Ge(x(4,18),0,a-r),"Energy"):p(f);else if(v===f)s<c&&t.add(Ge(2+x(2,7),0,a-r),"Joy");else if(v===h){var b=e.resources.count("Fish"),j=e.resources.count("Meat");i<o&&b>0&&b>j?(t.remove(1,"Fish"),t.add(25,"Satiety")):i<o&&j>0?(t.remove(1,"Meat"),t.add(x(5,20),"Satiety")):p(f)}if(n||v===f){var w=t.count("Fish")+t.count("Meat");p(r>0&&i>0&&w<2?M([m,g]):r<10?d:i<10?h:s<10?f:r<68?d:i<75?h:f)}}},e.displayAttribute=function(e){var t=fe(e);return"excellent"===ne(e)?"*".concat(t):"adequate"===ne(e)?"~".concat(t):"terrible"===ne(e)?"%".concat(t):t},e.notes=Object(g.a)(Object(g.a)(Object(g.a)(Object(g.a)({"*name":function(){return e.subject.name},role:function(){return fe(e.subject.role)}},Object.fromEntries(Object.keys(te.spiritual).sort().map((function(t){return[t,function(){var n=e.subject&&e.subject.soul[t];return e.displayAttribute(n)}]})))),Object.fromEntries(Object.keys(te.social).sort().map((function(t){return[t,function(){var n=e.subject&&e.subject.kind[t];return e.displayAttribute(n)}]})))),Object.fromEntries(Object.keys(te.mental).sort().map((function(t){return[t,function(){var n=e.subject&&e.subject.mind[t];return e.displayAttribute(n)}]})))),Object.fromEntries(Object.keys(te.physical).map((function(t){return[t,function(){var n=e.subject&&e.subject.body[t];return e.displayAttribute(n)}]})))),e.evolve(e.evolution),e.people.create("Self"),e.resources.create("Energy"),e.resources.add(40,"Energy"),e.resources.create("Max Energy"),e.resources.add(100,"Max Energy"),e.resources.create("Satiety"),e.resources.add(80,"Satiety"),e.resources.create("Max Satiety"),e.resources.add(100,"Max Satiety"),e.resources.create("Joy"),e.resources.add(80,"Joy"),e.resources.create("Max Joy"),e.resources.add(100,"Max Joy");var r=e.newPerson(),a=r.person,i=r.nameMeaning,o=r.recipes;return e.nameMeaning=i,e.subject=a,e.recipes=o,e.actions.create({name:"New",act:function(){var t=e.newPerson(),n=t.person,r=t.nameMeaning,a=t.recipes;e.subject=n,e.nameMeaning=r,e.recipes=a}}),e}return Object(u.a)(n,[{key:"attributeNames",get:function(){return[te.spiritual,te.social,te.physical,te.mental].map(Object.keys)}},{key:"date",get:function(){var e=this.ticks||0,t=Math.floor(e/.1),n=t%60,r=Math.floor(t/60)%60,a=Math.floor(t/3600)%24,i=["Sun","Moon","Mars","Mercury","Jupiter","Venus","Saturn"][Math.floor(t/86400)%7];return{dayOfWeek:i,description:"".concat(i," ").concat(String(a).padStart(2,"0"),":").concat(String(r).padStart(2,"0"),":").concat(String(n).padStart(2,"0"))}}}]),n}(De)),mt];var jt=function(e){var t=e.model;return Object(ue.jsx)("div",{className:"App",children:Object(ue.jsx)(Le,{models:bt,initialModel:t})})};o.a.render(Object(ue.jsx)(a.a.StrictMode,{children:Object(ue.jsx)(jt,{model:bt[0]})}),document.getElementById("root"))}},[[61,1,2]]]);
//# sourceMappingURL=main.1f1039e6.chunk.js.map